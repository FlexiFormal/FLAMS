import{g as e,a as t,c as n,r as i,E as o}from"./index-4afb3401.js";var r={};const s=e(t);var a,c={},u={},l={},d={},g={},h={};function p(e){return"string"==typeof e||e instanceof String}function m(e){return Array.isArray(e)}function f(){return a||(a=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Message=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType=e.RequestType0=e.AbstractMessageSignature=e.ParameterStructures=e.ResponseError=e.ErrorCodes=void 0;const t=h;var n,i;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3}(n=e.ErrorCodes||(e.ErrorCodes={}));class o extends Error{constructor(e,i,r){super(i),this.code=t.number(e)?e:n.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,o.prototype)}toJson(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),e}}e.ResponseError=o;class r{constructor(e){this.kind=e}static is(e){return e===r.auto||e===r.byName||e===r.byPosition}toString(){return this.kind}}e.ParameterStructures=r,r.auto=new r("auto"),r.byPosition=new r("byPosition"),r.byName=new r("byName");class s{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return r.auto}}e.AbstractMessageSignature=s;e.RequestType0=class extends s{constructor(e){super(e,0)}};e.RequestType=class extends s{constructor(e,t=r.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};e.RequestType1=class extends s{constructor(e,t=r.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};e.RequestType2=class extends s{constructor(e){super(e,2)}};e.RequestType3=class extends s{constructor(e){super(e,3)}};e.RequestType4=class extends s{constructor(e){super(e,4)}};e.RequestType5=class extends s{constructor(e){super(e,5)}};e.RequestType6=class extends s{constructor(e){super(e,6)}};e.RequestType7=class extends s{constructor(e){super(e,7)}};e.RequestType8=class extends s{constructor(e){super(e,8)}};e.RequestType9=class extends s{constructor(e){super(e,9)}};e.NotificationType=class extends s{constructor(e,t=r.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};e.NotificationType0=class extends s{constructor(e){super(e,0)}};e.NotificationType1=class extends s{constructor(e,t=r.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};e.NotificationType2=class extends s{constructor(e){super(e,2)}};e.NotificationType3=class extends s{constructor(e){super(e,3)}};e.NotificationType4=class extends s{constructor(e){super(e,4)}};e.NotificationType5=class extends s{constructor(e){super(e,5)}};e.NotificationType6=class extends s{constructor(e){super(e,6)}};e.NotificationType7=class extends s{constructor(e){super(e,7)}};e.NotificationType8=class extends s{constructor(e){super(e,8)}};e.NotificationType9=class extends s{constructor(e){super(e,9)}},(i=e.Message||(e.Message={})).isRequest=function(e){const n=e;return n&&t.string(n.method)&&(t.string(n.id)||t.number(n.id))},i.isNotification=function(e){const n=e;return n&&t.string(n.method)&&void 0===e.id},i.isResponse=function(e){const n=e;return n&&(void 0!==n.result||!!n.error)&&(t.string(n.id)||t.number(n.id)||null===n.id)}}(g)),g}Object.defineProperty(h,"__esModule",{value:!0}),h.stringArray=h.array=h.func=h.error=h.number=h.string=h.boolean=void 0,h.boolean=function(e){return!0===e||!1===e},h.string=p,h.number=function(e){return"number"==typeof e||e instanceof Number},h.error=function(e){return e instanceof Error},h.func=function(e){return"function"==typeof e},h.array=m,h.stringArray=function(e){return m(e)&&e.every((e=>p(e)))};var v,y={};function C(){return v||(v=1,function(e){var t,n;Object.defineProperty(e,"__esModule",{value:!0}),e.LRUCache=e.LinkedMap=e.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(n=e.Touch||(e.Touch={}));class i{constructor(){this[t]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=n.None){const i=this._map.get(e);if(i)return t!==n.None&&this.touch(i,t),i.value}set(e,t,i=n.None){let o=this._map.get(e);if(o)o.value=t,i!==n.None&&this.touch(o,i);else{switch(o={key:e,value:t,next:void 0,previous:void 0},i){case n.None:this.addItemLast(o);break;case n.First:this.addItemFirst(o);break;case n.Last:default:this.addItemLast(o)}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.key,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.value,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:[t.key,t.value],done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}[(t=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===n.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}e.LinkedMap=i;e.LRUCache=class extends i{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){return super.set(e,t,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}}(y)),y}var D,R={};var b={},S={};let T;function w(){if(void 0===T)throw new Error("No runtime abstraction layer installed");return T}Object.defineProperty(S,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");T=e}}(w||(w={})),S.default=w,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Emitter=e.Event=void 0;const t=S;!function(e){const t={dispose(){}};e.None=function(){return t}}(e.Event||(e.Event={}));class n{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e){if(this._contexts[i]===t)return this._callbacks.splice(i,1),void this._contexts.splice(i,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const n=[],i=this._callbacks.slice(0),o=this._contexts.slice(0);for(let s=0,a=i.length;s<a;s++)try{n.push(i[s].apply(o[s],e))}catch(r){(0,t.default)().console.error(r)}return n}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class i{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,o)=>{this._callbacks||(this._callbacks=new n),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const r={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),r.dispose=i._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(o)&&o.push(r),r}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}e.Emitter=i,i._noop=function(){}}(b);var _,k={};function P(){return _||(_=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationTokenSource=e.CancellationToken=void 0;const t=S,n=h,i=b;var o;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:i.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:i.Event.None}),e.is=function(t){const i=t;return i&&(i===e.None||i===e.Cancelled||n.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}}(o=e.CancellationToken||(e.CancellationToken={}));const r=Object.freeze((function(e,n){const i=(0,t.default)().timer.setTimeout(e.bind(n),0);return{dispose(){i.dispose()}}}));class s{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?r:(this._emitter||(this._emitter=new i.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}e.CancellationTokenSource=class{get token(){return this._token||(this._token=new s),this._token}cancel(){this._token?this._token.cancel():this._token=o.Cancelled}dispose(){this._token?this._token instanceof s&&this._token.dispose():this._token=o.None}}}(k)),k}var x,q={};var F={},O={};Object.defineProperty(O,"__esModule",{value:!0}),O.Semaphore=void 0;const E=S;O.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,E.default)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=void 0;const t=S,n=h,i=b,o=O;var r;(e.MessageReader||(e.MessageReader={})).is=function(e){let t=e;return t&&n.func(t.listen)&&n.func(t.dispose)&&n.func(t.onError)&&n.func(t.onClose)&&n.func(t.onPartialMessage)};class s{constructor(){this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.partialMessageEmitter=new i.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${n.string(e.message)?e.message:"unknown"}`)}}e.AbstractMessageReader=s,function(e){e.fromOptions=function(e){let n,i;const o=new Map;let r;const s=new Map;if(void 0===e||"string"==typeof e)n=e??"utf-8";else{if(n=e.charset??"utf-8",void 0!==e.contentDecoder&&(i=e.contentDecoder,o.set(i.name,i)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)o.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(r=e.contentTypeDecoder,s.set(r.name,r)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)s.set(t.name,t)}return void 0===r&&(r=(0,t.default)().applicationJson.decoder,s.set(r.name,r)),{charset:n,contentDecoder:i,contentDecoders:o,contentTypeDecoder:r,contentTypeDecoders:s}}}(r||(r={}));e.ReadableStreamMessageReader=class extends s{constructor(e,n){super(),this.readable=e,this.options=r.fromOptions(n),this.buffer=(0,t.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new o.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders(!0);if(!e)return;const t=e.get("content-length");if(!t)return void this.fireError(new Error("Header must provide a Content-Length property."));const n=parseInt(t);if(isNaN(n))return void this.fireError(new Error("Content-Length value must be a number."));this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock((async()=>{const t=void 0!==this.options.contentDecoder?await this.options.contentDecoder.decode(e):e,n=await this.options.contentTypeDecoder.decode(t,this.options);this.callback(n)})).catch((e=>{this.fireError(e)}))}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=(0,t.default)().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}}(F);var M={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=void 0;const t=S,n=h,i=O,o=b;var r;(e.MessageWriter||(e.MessageWriter={})).is=function(e){let t=e;return t&&n.func(t.dispose)&&n.func(t.onClose)&&n.func(t.onError)&&n.func(t.write)};class s{constructor(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${n.string(e.message)?e.message:"unknown"}`)}}e.AbstractMessageWriter=s,function(e){e.fromOptions=function(e){return void 0===e||"string"==typeof e?{charset:e??"utf-8",contentTypeEncoder:(0,t.default)().applicationJson.encoder}:{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,t.default)().applicationJson.encoder}}}(r||(r={}));e.WriteableStreamMessageWriter=class extends s{constructor(e,t){super(),this.writable=e,this.options=r.fromOptions(t),this.errorCount=0,this.writeSemaphore=new i.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}}(M);var N,I={};var L,j,A={};function H(){return L||(L=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const t=S,n=h,i=f(),o=C(),r=b,s=P();var a,c,u,l,d,g,p,m,v,y,D,R,T,w,_,k,x,q;!function(e){e.type=new i.NotificationType("$/cancelRequest")}(a||(a={})),function(e){e.is=function(e){return"string"==typeof e||"number"==typeof e}}(c=e.ProgressToken||(e.ProgressToken={})),function(e){e.type=new i.NotificationType("$/progress")}(u||(u={}));e.ProgressType=class{constructor(){}},function(e){e.is=function(e){return n.func(e)}}(l||(l={})),e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"}(d=e.Trace||(e.Trace={})),(g=e.TraceValues||(e.TraceValues={})).Off="off",g.Messages="messages",g.Compact="compact",g.Verbose="verbose",function(e){e.fromString=function(t){if(!n.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}}(d=e.Trace||(e.Trace={})),function(e){e.Text="text",e.JSON="json"}(e.TraceFormat||(e.TraceFormat={})),function(e){e.fromString=function(t){return n.string(t)&&"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p=e.TraceFormat||(e.TraceFormat={})),function(e){e.type=new i.NotificationType("$/setTrace")}(m=e.SetTraceNotification||(e.SetTraceNotification={})),function(e){e.type=new i.NotificationType("$/logTrace")}(v=e.LogTraceNotification||(e.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(y=e.ConnectionErrors||(e.ConnectionErrors={}));class F extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,F.prototype)}}e.ConnectionError=F,function(e){e.is=function(e){const t=e;return t&&n.func(t.cancelUndispatched)}}(D=e.ConnectionStrategy||(e.ConnectionStrategy={})),function(e){e.is=function(e){const t=e;return t&&(void 0===t.kind||"id"===t.kind)&&n.func(t.createCancellationTokenSource)&&(void 0===t.dispose||n.func(t.dispose))}}(R=e.IdCancellationReceiverStrategy||(e.IdCancellationReceiverStrategy={})),function(e){e.is=function(e){const t=e;return t&&"request"===t.kind&&n.func(t.createCancellationTokenSource)&&(void 0===t.dispose||n.func(t.dispose))}}(T=e.RequestCancellationReceiverStrategy||(e.RequestCancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new s.CancellationTokenSource}),e.is=function(e){return R.is(e)||T.is(e)}}(w=e.CancellationReceiverStrategy||(e.CancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({sendCancellation:(e,t)=>e.sendNotification(a.type,{id:t}),cleanup(e){}}),e.is=function(e){const t=e;return t&&n.func(t.sendCancellation)&&n.func(t.cleanup)}}(_=e.CancellationSenderStrategy||(e.CancellationSenderStrategy={})),function(e){e.Message=Object.freeze({receiver:w.Message,sender:_.Message}),e.is=function(e){const t=e;return t&&w.is(t.receiver)&&_.is(t.sender)}}(k=e.CancellationStrategy||(e.CancellationStrategy={})),function(e){e.is=function(e){const t=e;return t&&n.func(t.handleMessage)}}(x=e.MessageStrategy||(e.MessageStrategy={})),(e.ConnectionOptions||(e.ConnectionOptions={})).is=function(e){const t=e;return t&&(k.is(t.cancellationStrategy)||D.is(t.connectionStrategy)||x.is(t.messageStrategy))},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(q||(q={})),e.createMessageConnection=function(g,h,f,C){const D=void 0!==f?f:e.NullLogger;let b=0,S=0,T=0;const w="2.0";let _;const P=new Map;let O;const E=new Map,M=new Map;let N,I,L=new o.LinkedMap,j=new Map,A=new Set,H=new Map,K=d.Off,W=p.Text,U=q.New;const z=new r.Emitter,$=new r.Emitter,V=new r.Emitter,B=new r.Emitter,J=new r.Emitter,X=C&&C.cancellationStrategy?C.cancellationStrategy:k.Message;function Q(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function G(e,t){var n;i.Message.isRequest(t)?e.set(Q(t.id),t):i.Message.isResponse(t)?e.set(null===(n=t.id)?"res-unknown-"+(++T).toString():"res-"+n.toString(),t):e.set("not-"+(++S).toString(),t)}function Y(e){}function Z(){return U===q.Listening}function ee(){return U===q.Closed}function te(){return U===q.Disposed}function ne(){U!==q.New&&U!==q.Listening||(U=q.Closed,$.fire(void 0))}function ie(){N||0===L.size||(N=(0,t.default)().timer.setImmediate((()=>{N=void 0,function(){if(0===L.size)return;const e=L.shift();try{const t=C?.messageStrategy;x.is(t)?t.handleMessage(e,oe):oe(e)}finally{ie()}}()})))}function oe(e){i.Message.isRequest(e)?function(e){if(te())return;function t(t,n,o){const r={jsonrpc:w,id:e.id};t instanceof i.ResponseError?r.error=t.toJson():r.result=void 0===t?null:t,ae(r,n,o),h.write(r).catch((()=>D.error("Sending response failed.")))}function o(t,n,i){const o={jsonrpc:w,id:e.id,error:t.toJson()};ae(o,n,i),h.write(o).catch((()=>D.error("Sending response failed.")))}function r(t,n,i){void 0===t&&(t=null);const o={jsonrpc:w,id:e.id,result:t};ae(o,n,i),h.write(o).catch((()=>D.error("Sending response failed.")))}!function(e){if(K===d.Off||!I)return;if(W===p.Text){let t;K!==d.Verbose&&K!==d.Compact||!e.params||(t=`Params: ${se(e.params)}\n\n`),I.log(`Received request '${e.method} - (${e.id})'.`,t)}else ue("receive-request",e)}(e);const s=P.get(e.method);let a,c;s&&(a=s.type,c=s.handler);const u=Date.now();if(c||_){const s=e.id??String(Date.now()),d=R.is(X.receiver)?X.receiver.createCancellationTokenSource(s):X.receiver.createCancellationTokenSource(e);null!==e.id&&A.has(e.id)&&d.cancel(),null!==e.id&&H.set(s,d);try{let l;if(c)if(void 0===e.params){if(void 0!==a&&0!==a.numberOfParams)return void o(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${e.method} defines ${a.numberOfParams} params but received none.`),e.method,u);l=c(d.token)}else if(Array.isArray(e.params)){if(void 0!==a&&a.parameterStructures===i.ParameterStructures.byName)return void o(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,u);l=c(...e.params,d.token)}else{if(void 0!==a&&a.parameterStructures===i.ParameterStructures.byPosition)return void o(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,u);l=c(e.params,d.token)}else _&&(l=_(e.method,e.params,d.token));const g=l;l?g.then?g.then((n=>{H.delete(s),t(n,e.method,u)}),(t=>{H.delete(s),t instanceof i.ResponseError?o(t,e.method,u):t&&n.string(t.message)?o(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):o(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)})):(H.delete(s),t(l,e.method,u)):(H.delete(s),r(l,e.method,u))}catch(l){H.delete(s),l instanceof i.ResponseError?t(l,e.method,u):l&&n.string(l.message)?o(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${l.message}`),e.method,u):o(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else o(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):i.Message.isNotification(e)?function(e){if(te())return;let t,n;if(e.method===a.type.method){const t=e.params.id;return A.delete(t),void ce(e)}{const i=E.get(e.method);i&&(n=i.handler,t=i.type)}if(n||O)try{if(ce(e),n)if(void 0===e.params)void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==i.ParameterStructures.byName&&D.error(`Notification ${e.method} defines ${t.numberOfParams} params but received none.`),n();else if(Array.isArray(e.params)){const o=e.params;e.method===u.type.method&&2===o.length&&c.is(o[0])?n({token:o[0],value:o[1]}):(void 0!==t&&(t.parameterStructures===i.ParameterStructures.byName&&D.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&D.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${o.length} arguments`)),n(...o))}else void 0!==t&&t.parameterStructures===i.ParameterStructures.byPosition&&D.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params);else O&&O(e.method,e.params)}catch(o){o.message?D.error(`Notification handler '${e.method}' failed with message: ${o.message}`):D.error(`Notification handler '${e.method}' failed unexpectedly.`)}else V.fire(e)}(e):i.Message.isResponse(e)?function(e){if(te())return;if(null===e.id)e.error?D.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):D.error("Received response message without id. No further error information provided.");else{const n=e.id,o=j.get(n);if(function(e,t){if(K===d.Off||!I)return;if(W===p.Text){let n;if(K!==d.Verbose&&K!==d.Compact||(e.error&&e.error.data?n=`Error data: ${se(e.error.data)}\n\n`:e.result?n=`Result: ${se(e.result)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const i=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";I.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${i}`,n)}else I.log(`Received response ${e.id} without active response promise.`,n)}else ue("receive-response",e)}(e,o),void 0!==o){j.delete(n);try{if(e.error){const t=e.error;o.reject(new i.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");o.resolve(e.result)}}catch(t){t.message?D.error(`Response handler '${o.method}' failed with message: ${t.message}`):D.error(`Response handler '${o.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void D.error("Received empty message.");D.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(n.string(t.id)||n.number(t.id)){const e=t.id,n=j.get(e);n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}g.onClose(ne),g.onError((function(e){z.fire([e,void 0,void 0])})),h.onClose(ne),h.onError((function(e){z.fire(e)}));const re=e=>{try{if(i.Message.isNotification(e)&&e.method===a.type.method){const t=e.params.id,n=Q(t),o=L.get(n);if(i.Message.isRequest(o)){const i=C?.connectionStrategy,r=i&&i.cancelUndispatched?i.cancelUndispatched(o,Y):void 0;if(r&&(void 0!==r.error||void 0!==r.result))return L.delete(n),H.delete(t),r.id=o.id,ae(r,e.method,Date.now()),void h.write(r).catch((()=>D.error("Sending response for canceled message failed.")))}const r=H.get(t);if(void 0!==r)return r.cancel(),void ce(e);A.add(t)}G(L,e)}finally{ie()}};function se(e){if(null!=e)switch(K){case d.Verbose:return JSON.stringify(e,null,4);case d.Compact:return JSON.stringify(e);default:return}}function ae(e,t,n){if(K!==d.Off&&I)if(W===p.Text){let i;K!==d.Verbose&&K!==d.Compact||(e.error&&e.error.data?i=`Error data: ${se(e.error.data)}\n\n`:e.result?i=`Result: ${se(e.result)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),I.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,i)}else ue("send-response",e)}function ce(e){if(K!==d.Off&&I&&e.method!==v.type.method)if(W===p.Text){let t;K!==d.Verbose&&K!==d.Compact||(t=e.params?`Params: ${se(e.params)}\n\n`:"No parameters provided.\n\n"),I.log(`Received notification '${e.method}'.`,t)}else ue("receive-notification",e)}function ue(e,t){if(!I||K===d.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};I.log(n)}function le(){if(ee())throw new F(y.Closed,"Connection is closed.");if(te())throw new F(y.Disposed,"Connection is disposed.")}function de(e){return void 0===e?null:e}function ge(e){return null===e?void 0:e}function he(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function pe(e,t){switch(e){case i.ParameterStructures.auto:return he(t)?ge(t):[de(t)];case i.ParameterStructures.byName:if(!he(t))throw new Error("Received parameters by name but param is not an object literal.");return ge(t);case i.ParameterStructures.byPosition:return[de(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function me(e,t){let n;const i=e.numberOfParams;switch(i){case 0:n=void 0;break;case 1:n=pe(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<i;e++)n.push(de(t[e]));if(t.length<i)for(let e=t.length;e<i;e++)n.push(null)}return n}const fe={sendNotification:(e,...t)=>{let o,r;if(le(),n.string(e)){o=e;const n=t[0];let s=0,a=i.ParameterStructures.auto;i.ParameterStructures.is(n)&&(s=1,a=n);let c=t.length;const u=c-s;switch(u){case 0:r=void 0;break;case 1:r=pe(a,t[s]);break;default:if(a===i.ParameterStructures.byName)throw new Error(`Received ${u} parameters for 'by Name' notification parameter structure.`);r=t.slice(s,c).map((e=>de(e)))}}else{const n=t;o=e.method,r=me(e,n)}const s={jsonrpc:w,method:o,params:r};return function(e){if(K!==d.Off&&I)if(W===p.Text){let t;K!==d.Verbose&&K!==d.Compact||(t=e.params?`Params: ${se(e.params)}\n\n`:"No parameters provided.\n\n"),I.log(`Sending notification '${e.method}'.`,t)}else ue("send-notification",e)}(s),h.write(s).catch((e=>{throw D.error("Sending notification failed."),e}))},onNotification:(e,t)=>{let i;return le(),n.func(e)?O=e:t&&(n.string(e)?(i=e,E.set(e,{type:void 0,handler:t})):(i=e.method,E.set(e.method,{type:e,handler:t}))),{dispose:()=>{void 0!==i?E.delete(i):O=void 0}}},onProgress:(e,t,n)=>{if(M.has(t))throw new Error(`Progress handler for token ${t} already registered`);return M.set(t,n),{dispose:()=>{M.delete(t)}}},sendProgress:(e,t,n)=>fe.sendNotification(u.type,{token:t,value:n}),onUnhandledProgress:B.event,sendRequest:(e,...t)=>{let o,r,a;if(le(),function(){if(!Z())throw new Error("Call listen() first.")}(),n.string(e)){o=e;const n=t[0],c=t[t.length-1];let u=0,l=i.ParameterStructures.auto;i.ParameterStructures.is(n)&&(u=1,l=n);let d=t.length;s.CancellationToken.is(c)&&(d-=1,a=c);const g=d-u;switch(g){case 0:r=void 0;break;case 1:r=pe(l,t[u]);break;default:if(l===i.ParameterStructures.byName)throw new Error(`Received ${g} parameters for 'by Name' request parameter structure.`);r=t.slice(u,d).map((e=>de(e)))}}else{const n=t;o=e.method,r=me(e,n);const i=e.numberOfParams;a=s.CancellationToken.is(n[i])?n[i]:void 0}const c=b++;let u;a&&(u=a.onCancellationRequested((()=>{const e=X.sender.sendCancellation(fe,c);return void 0===e?(D.log(`Received no promise from cancellation strategy when cancelling id ${c}`),Promise.resolve()):e.catch((()=>{D.log(`Sending cancellation messages for id ${c} failed`)}))})));const l={jsonrpc:w,id:c,method:o,params:r};return function(e){if(K!==d.Off&&I)if(W===p.Text){let t;K!==d.Verbose&&K!==d.Compact||!e.params||(t=`Params: ${se(e.params)}\n\n`),I.log(`Sending request '${e.method} - (${e.id})'.`,t)}else ue("send-request",e)}(l),"function"==typeof X.sender.enableCancellation&&X.sender.enableCancellation(l),new Promise((async(e,t)=>{const n={method:o,timerStart:Date.now(),resolve:t=>{e(t),X.sender.cleanup(c),u?.dispose()},reject:e=>{t(e),X.sender.cleanup(c),u?.dispose()}};try{await h.write(l),j.set(c,n)}catch(r){throw D.error("Sending request failed."),n.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,r.message?r.message:"Unknown reason")),r}}))},onRequest:(e,t)=>{le();let i=null;return l.is(e)?(i=void 0,_=e):n.string(e)?(i=null,void 0!==t&&(i=e,P.set(e,{handler:t,type:void 0}))):void 0!==t&&(i=e.method,P.set(e.method,{type:e,handler:t})),{dispose:()=>{null!==i&&(void 0!==i?P.delete(i):_=void 0)}}},hasPendingResponse:()=>j.size>0,trace:async(e,t,i)=>{let o=!1,r=p.Text;void 0!==i&&(n.boolean(i)?o=i:(o=i.sendNotification||!1,r=i.traceFormat||p.Text)),K=e,W=r,I=K===d.Off?void 0:t,!o||ee()||te()||await fe.sendNotification(m.type,{value:d.toString(e)})},onError:z.event,onClose:$.event,onUnhandledNotification:V.event,onDispose:J.event,end:()=>{h.end()},dispose:()=>{if(te())return;U=q.Disposed,J.fire(void 0);const e=new i.ResponseError(i.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const t of j.values())t.reject(e);j=new Map,H=new Map,A=new Set,L=new o.LinkedMap,n.func(h.dispose)&&h.dispose(),n.func(g.dispose)&&g.dispose()},listen:()=>{le(),function(){if(Z())throw new F(y.AlreadyListening,"Connection is already listening")}(),U=q.Listening,g.listen(re)},inspect:()=>{(0,t.default)().console.log("inspect")}};return fe.onNotification(v.type,(e=>{if(K===d.Off||!I)return;const t=K===d.Verbose||K===d.Compact;I.log(e.message,t?e.verbose:void 0)})),fe.onNotification(u.type,(e=>{const t=M.get(e.token);t?t(e.value):B.fire(e)})),fe}}(A)),A}function K(){return j||(j=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const t=f();Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return t.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return t.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return t.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return t.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return t.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return t.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return t.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return t.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return t.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return t.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return t.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return t.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return t.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return t.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return t.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return t.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return t.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return t.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return t.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return t.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return t.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return t.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return t.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return t.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return t.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return t.ParameterStructures}});const n=C();Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return n.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return n.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return n.Touch}});const i=function(){return D||(D=1,e=R,Object.defineProperty(e,"__esModule",{value:!0}),e.Disposable=void 0,(e.Disposable||(e.Disposable={})).create=function(e){return{dispose:e}}),R;var e}();Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return i.Disposable}});const o=b;Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return o.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return o.Emitter}});const r=P();Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return r.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return r.CancellationToken}});const s=function(){if(x)return q;x=1,Object.defineProperty(q,"__esModule",{value:!0}),q.SharedArrayReceiverStrategy=q.SharedArraySenderStrategy=void 0;const e=P();var t;!function(e){e.Continue=0,e.Cancelled=1}(t||(t={})),q.SharedArraySenderStrategy=class{constructor(){this.buffers=new Map}enableCancellation(e){if(null===e.id)return;const n=new SharedArrayBuffer(4);new Int32Array(n,0,1)[0]=t.Continue,this.buffers.set(e.id,n),e.$cancellationData=n}async sendCancellation(e,n){const i=this.buffers.get(n);if(void 0===i)return;const o=new Int32Array(i,0,1);Atomics.store(o,0,t.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};class n{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===t.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class i{constructor(e){this.token=new n(e)}cancel(){}dispose(){}}return q.SharedArrayReceiverStrategy=class{constructor(){this.kind="request"}createCancellationTokenSource(t){const n=t.$cancellationData;return void 0===n?new e.CancellationTokenSource:new i(n)}},q}();Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const a=F;Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const c=M;Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const u=(N||(N=1,Object.defineProperty(I,"__esModule",{value:!0}),I.AbstractMessageBuffer=void 0,I.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(0===this._chunks.length)return;let t=0,n=0,i=0,o=0;e:for(;n<this._chunks.length;){const e=this._chunks[n];for(i=0;i<e.length;){switch(e[i]){case 13:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case 10:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}o+=e.byteLength,n++}if(4!==t)return;const r=this._read(o+i),s=new Map,a=this.toString(r,"ascii").split("\r\n");if(a.length<2)return s;for(let c=0;c<a.length-2;c++){const t=a[c],n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");const i=t.substr(0,n),o=t.substr(n+1).trim();s.set(e?i.toLowerCase():i,o)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const i=this._chunks[0];if(i.byteLength>e){const o=i.slice(0,e);t.set(o,n),n+=e,this._chunks[0]=i.slice(e),this._totalLength-=e,e-=e}else t.set(i,n),n+=i.byteLength,this._chunks.shift(),this._totalLength-=i.byteLength,e-=i.byteLength}return t}}),I);Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return u.AbstractMessageBuffer}});const l=H();Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return l.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return l.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return l.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return l.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return l.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return l.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return l.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return l.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return l.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return l.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return l.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return l.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return l.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return l.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return l.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return l.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return l.MessageStrategy}});const d=S;e.RAL=d.default}(d)),d}Object.defineProperty(l,"__esModule",{value:!0});const W=K();class U extends W.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return U.emptyBuffer}fromString(e,t){return(new TextEncoder).encode(e)}toString(e,t){return"ascii"===t?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}U.emptyBuffer=new Uint8Array(0);class z{constructor(e){this.socket=e,this._onData=new W.Emitter,this._messageListener=e=>{e.data.arrayBuffer().then((e=>{this._onData.fire(new Uint8Array(e))}),(()=>{(0,W.RAL)().console.error("Converting blob to array buffer failed.")}))},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),W.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),W.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),W.Disposable.create((()=>this.socket.removeEventListener("end",e)))}onData(e){return this._onData.event(e)}}class ${constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),W.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),W.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),W.Disposable.create((()=>this.socket.removeEventListener("end",e)))}write(e,t){if("string"==typeof e){if(void 0!==t&&"utf-8"!==t)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const V=new TextEncoder,B=Object.freeze({messageBuffer:Object.freeze({create:e=>new U(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if("utf-8"!==t.charset)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t.charset}`);return Promise.resolve(V.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new z(e),asWritableStream:e=>new $(e)}),console:console,timer:Object.freeze({setTimeout(e,t,...n){const i=setTimeout(e,t,...n);return{dispose:()=>clearTimeout(i)}},setImmediate(e,...t){const n=setTimeout(e,0,...t);return{dispose:()=>clearTimeout(n)}},setInterval(e,t,...n){const i=setInterval(e,t,...n);return{dispose:()=>clearInterval(i)}}})});function J(){return B}!function(e){e.install=function(){W.RAL.install(B)}}(J||(J={})),l.default=J,function(e){var t=n&&n.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),i=n&&n.__exportStar||function(e,n){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||t(n,e,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0;l.default.install();const o=K();i(K(),e);class r extends o.AbstractMessageReader{constructor(e){super(),this._onData=new o.Emitter,this._messageListener=e=>{this._onData.fire(e.data)},e.addEventListener("error",(e=>this.fireError(e))),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}}e.BrowserMessageReader=r;class s extends o.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.addEventListener("error",(e=>this.fireError(e)))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}e.BrowserMessageWriter=s,e.createMessageConnection=function(e,t,n,i){return void 0===n&&(n=o.NullLogger),o.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,o.createMessageConnection)(e,t,n,i)}}(u);var X,Q,G,Y,Z,ee,te,ne,ie,oe,re,se,ae,ce,ue,le,de,ge,he,pe,me,fe,ve,ye,Ce,De,Re,be,Se=u,Te={};!function(e){e.is=function(e){return"string"==typeof e}}(X||(X={})),function(e){e.is=function(e){return"string"==typeof e}}(Q||(Q={})),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(G||(G={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(Y||(Y={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=Y.MAX_VALUE),t===Number.MAX_VALUE&&(t=Y.MAX_VALUE),{line:e,character:t}},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Ct.uinteger(t.line)&&Ct.uinteger(t.character)}}(Z||(Z={})),function(e){e.create=function(e,t,n,i){if(Ct.uinteger(e)&&Ct.uinteger(t)&&Ct.uinteger(n)&&Ct.uinteger(i))return{start:Z.create(e,t),end:Z.create(n,i)};if(Z.is(e)&&Z.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments[".concat(e,", ").concat(t,", ").concat(n,", ").concat(i,"]"))},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Z.is(t.start)&&Z.is(t.end)}}(ee||(ee={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&ee.is(t.range)&&(Ct.string(t.uri)||Ct.undefined(t.uri))}}(te||(te={})),function(e){e.create=function(e,t,n,i){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:i}},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&ee.is(t.targetRange)&&Ct.string(t.targetUri)&&ee.is(t.targetSelectionRange)&&(ee.is(t.originSelectionRange)||Ct.undefined(t.originSelectionRange))}}(ne||(ne={})),function(e){e.create=function(e,t,n,i){return{red:e,green:t,blue:n,alpha:i}},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Ct.numberRange(t.red,0,1)&&Ct.numberRange(t.green,0,1)&&Ct.numberRange(t.blue,0,1)&&Ct.numberRange(t.alpha,0,1)}}(ie||(ie={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&ee.is(t.range)&&ie.is(t.color)}}(oe||(oe={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Ct.string(t.label)&&(Ct.undefined(t.textEdit)||pe.is(t))&&(Ct.undefined(t.additionalTextEdits)||Ct.typedArray(t.additionalTextEdits,pe.is))}}(re||(re={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(se||(se={})),function(e){e.create=function(e,t,n,i,o,r){var s={startLine:e,endLine:t};return Ct.defined(n)&&(s.startCharacter=n),Ct.defined(i)&&(s.endCharacter=i),Ct.defined(o)&&(s.kind=o),Ct.defined(r)&&(s.collapsedText=r),s},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Ct.uinteger(t.startLine)&&Ct.uinteger(t.startLine)&&(Ct.undefined(t.startCharacter)||Ct.uinteger(t.startCharacter))&&(Ct.undefined(t.endCharacter)||Ct.uinteger(t.endCharacter))&&(Ct.undefined(t.kind)||Ct.string(t.kind))}}(ae||(ae={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return Ct.defined(t)&&te.is(t.location)&&Ct.string(t.message)}}(ce||(ce={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(ue||(ue={})),function(e){e.Unnecessary=1,e.Deprecated=2}(le||(le={})),function(e){e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Ct.string(t.href)}}(de||(de={})),function(e){e.create=function(e,t,n,i,o,r){var s={range:e,message:t};return Ct.defined(n)&&(s.severity=n),Ct.defined(i)&&(s.code=i),Ct.defined(o)&&(s.source=o),Ct.defined(r)&&(s.relatedInformation=r),s},e.is=function(e){var t,n=e;return Ct.defined(n)&&ee.is(n.range)&&Ct.string(n.message)&&(Ct.number(n.severity)||Ct.undefined(n.severity))&&(Ct.integer(n.code)||Ct.string(n.code)||Ct.undefined(n.code))&&(Ct.undefined(n.codeDescription)||Ct.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(Ct.string(n.source)||Ct.undefined(n.source))&&(Ct.undefined(n.relatedInformation)||Ct.typedArray(n.relatedInformation,ce.is))}}(ge||(ge={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o={title:e,command:t};return Ct.defined(n)&&n.length>0&&(o.arguments=n),o},e.is=function(e){var t=e;return Ct.defined(t)&&Ct.string(t.title)&&Ct.string(t.command)}}(he||(he={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Ct.string(t.newText)&&ee.is(t.range)}}(pe||(pe={})),function(e){e.create=function(e,t,n){var i={label:e};return void 0!==t&&(i.needsConfirmation=t),void 0!==n&&(i.description=n),i},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Ct.string(t.label)&&(Ct.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(Ct.string(t.description)||void 0===t.description)}}(me||(me={})),function(e){e.is=function(e){var t=e;return Ct.string(t)}}(fe||(fe={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){var t=e;return pe.is(t)&&(me.is(t.annotationId)||fe.is(t.annotationId))}}(ve||(ve={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return Ct.defined(t)&&ke.is(t.textDocument)&&Array.isArray(t.edits)}}(ye||(ye={})),function(e){e.create=function(e,t,n){var i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"create"===t.kind&&Ct.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||Ct.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Ct.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||fe.is(t.annotationId))}}(Ce||(Ce={})),function(e){e.create=function(e,t,n,i){var o={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(o.options=n),void 0!==i&&(o.annotationId=i),o},e.is=function(e){var t=e;return t&&"rename"===t.kind&&Ct.string(t.oldUri)&&Ct.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||Ct.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Ct.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||fe.is(t.annotationId))}}(De||(De={})),function(e){e.create=function(e,t,n){var i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"delete"===t.kind&&Ct.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||Ct.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||Ct.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||fe.is(t.annotationId))}}(Re||(Re={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return Ct.string(e.kind)?Ce.is(e)||De.is(e)||Re.is(e):ye.is(e)})))}}(be||(be={}));var we,_e,ke,Pe,xe,qe,Fe,Oe,Ee,Me,Ne,Ie,Le,je,Ae,He,Ke,We,Ue,ze,$e,Ve,Be,Je,Xe,Qe,Ge,Ye,Ze,et,tt,nt,it,ot,rt,st,at,ct,ut,lt,dt,gt,ht,pt,mt=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var i,o;if(void 0===n?i=pe.insert(e,t):fe.is(n)?(o=n,i=ve.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=ve.insert(e,t,o)),this.edits.push(i),void 0!==o)return o},e.prototype.replace=function(e,t,n){var i,o;if(void 0===n?i=pe.replace(e,t):fe.is(n)?(o=n,i=ve.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=ve.replace(e,t,o)),this.edits.push(i),void 0!==o)return o},e.prototype.delete=function(e,t){var n,i;if(void 0===t?n=pe.del(e):fe.is(t)?(i=t,n=ve.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),n=ve.del(e,i)),this.edits.push(n),void 0!==i)return i},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),ft=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(fe.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error("Id ".concat(n," is already in use."));if(void 0===t)throw new Error("No annotation provided for id ".concat(n));return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),vt=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new ft(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((function(e){if(ye.is(e)){var n=new mt(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}}))):e.changes&&Object.keys(e.changes).forEach((function(n){var i=new mt(e.changes[n]);t._textEditChanges[n]=i}))):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(ke.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version};if(!(i=this._textEditChanges[t.uri])){var n={textDocument:t,edits:o=[]};this._workspaceEdit.documentChanges.push(n),i=new mt(o,this._changeAnnotations),this._textEditChanges[t.uri]=i}return i}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var i;if(!(i=this._textEditChanges[e])){var o=[];this._workspaceEdit.changes[e]=o,i=new mt(o),this._textEditChanges[e]=i}return i},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new ft,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,o,r;if(me.is(t)||fe.is(t)?i=t:n=t,void 0===i?o=Ce.create(e,n):(r=fe.is(i)?i:this._changeAnnotations.manage(i),o=Ce.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r},e.prototype.renameFile=function(e,t,n,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var o,r,s;if(me.is(n)||fe.is(n)?o=n:i=n,void 0===o?r=De.create(e,t,i):(s=fe.is(o)?o:this._changeAnnotations.manage(o),r=De.create(e,t,i,s)),this._workspaceEdit.documentChanges.push(r),void 0!==s)return s},e.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,o,r;if(me.is(t)||fe.is(t)?i=t:n=t,void 0===i?o=Re.create(e,n):(r=fe.is(i)?i:this._changeAnnotations.manage(i),o=Re.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return Ct.defined(t)&&Ct.string(t.uri)}}(we||(we={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return Ct.defined(t)&&Ct.string(t.uri)&&Ct.integer(t.version)}}(_e||(_e={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return Ct.defined(t)&&Ct.string(t.uri)&&(null===t.version||Ct.integer(t.version))}}(ke||(ke={})),function(e){e.create=function(e,t,n,i){return{uri:e,languageId:t,version:n,text:i}},e.is=function(e){var t=e;return Ct.defined(t)&&Ct.string(t.uri)&&Ct.string(t.languageId)&&Ct.integer(t.version)&&Ct.string(t.text)}}(Pe||(Pe={})),function(e){e.PlainText="plaintext",e.Markdown="markdown",e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(xe||(xe={})),function(e){e.is=function(e){var t=e;return Ct.objectLiteral(e)&&xe.is(t.kind)&&Ct.string(t.value)}}(qe||(qe={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(Fe||(Fe={})),function(e){e.PlainText=1,e.Snippet=2}(Oe||(Oe={})),function(e){e.Deprecated=1}(Ee||(Ee={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&Ct.string(t.newText)&&ee.is(t.insert)&&ee.is(t.replace)}}(Me||(Me={})),function(e){e.asIs=1,e.adjustIndentation=2}(Ne||(Ne={})),function(e){e.is=function(e){var t=e;return t&&(Ct.string(t.detail)||void 0===t.detail)&&(Ct.string(t.description)||void 0===t.description)}}(Ie||(Ie={})),function(e){e.create=function(e){return{label:e}}}(Le||(Le={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(je||(je={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return Ct.string(t)||Ct.objectLiteral(t)&&Ct.string(t.language)&&Ct.string(t.value)}}(Ae||(Ae={})),function(e){e.is=function(e){var t=e;return!!t&&Ct.objectLiteral(t)&&(qe.is(t.contents)||Ae.is(t.contents)||Ct.typedArray(t.contents,Ae.is))&&(void 0===e.range||ee.is(e.range))}}(He||(He={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(Ke||(Ke={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o={label:e};return Ct.defined(t)&&(o.documentation=t),Ct.defined(n)?o.parameters=n:o.parameters=[],o}}(We||(We={})),function(e){e.Text=1,e.Read=2,e.Write=3}(Ue||(Ue={})),function(e){e.create=function(e,t){var n={range:e};return Ct.number(t)&&(n.kind=t),n}}(ze||(ze={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}($e||($e={})),function(e){e.Deprecated=1}(Ve||(Ve={})),function(e){e.create=function(e,t,n,i,o){var r={name:e,kind:t,location:{uri:i,range:n}};return o&&(r.containerName=o),r}}(Be||(Be={})),(Je||(Je={})).create=function(e,t,n,i){return void 0!==i?{name:e,kind:t,location:{uri:n,range:i}}:{name:e,kind:t,location:{uri:n}}},function(e){e.create=function(e,t,n,i,o,r){var s={name:e,detail:t,kind:n,range:i,selectionRange:o};return void 0!==r&&(s.children=r),s},e.is=function(e){var t=e;return t&&Ct.string(t.name)&&Ct.number(t.kind)&&ee.is(t.range)&&ee.is(t.selectionRange)&&(void 0===t.detail||Ct.string(t.detail))&&(void 0===t.deprecated||Ct.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(Xe||(Xe={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(Qe||(Qe={})),function(e){e.Invoked=1,e.Automatic=2}(Ge||(Ge={})),function(e){e.create=function(e,t,n){var i={diagnostics:e};return null!=t&&(i.only=t),null!=n&&(i.triggerKind=n),i},e.is=function(e){var t=e;return Ct.defined(t)&&Ct.typedArray(t.diagnostics,ge.is)&&(void 0===t.only||Ct.typedArray(t.only,Ct.string))&&(void 0===t.triggerKind||t.triggerKind===Ge.Invoked||t.triggerKind===Ge.Automatic)}}(Ye||(Ye={})),function(e){e.create=function(e,t,n){var i={title:e},o=!0;return"string"==typeof t?(o=!1,i.kind=t):he.is(t)?i.command=t:i.edit=t,o&&void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return t&&Ct.string(t.title)&&(void 0===t.diagnostics||Ct.typedArray(t.diagnostics,ge.is))&&(void 0===t.kind||Ct.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||he.is(t.command))&&(void 0===t.isPreferred||Ct.boolean(t.isPreferred))&&(void 0===t.edit||be.is(t.edit))}}(Ze||(Ze={})),function(e){e.create=function(e,t){var n={range:e};return Ct.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return Ct.defined(t)&&ee.is(t.range)&&(Ct.undefined(t.command)||he.is(t.command))}}(et||(et={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return Ct.defined(t)&&Ct.uinteger(t.tabSize)&&Ct.boolean(t.insertSpaces)}}(tt||(tt={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return Ct.defined(t)&&ee.is(t.range)&&(Ct.undefined(t.target)||Ct.string(t.target))}}(nt||(nt={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return Ct.objectLiteral(n)&&ee.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(it||(it={})),function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"}(ot||(ot={})),function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"}(rt||(rt={})),function(e){e.is=function(e){var t=e;return Ct.objectLiteral(t)&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(st||(st={})),function(e){e.create=function(e,t){return{range:e,text:t}},e.is=function(e){var t=e;return null!=t&&ee.is(t.range)&&Ct.string(t.text)}}(at||(at={})),function(e){e.create=function(e,t,n){return{range:e,variableName:t,caseSensitiveLookup:n}},e.is=function(e){var t=e;return null!=t&&ee.is(t.range)&&Ct.boolean(t.caseSensitiveLookup)&&(Ct.string(t.variableName)||void 0===t.variableName)}}(ct||(ct={})),function(e){e.create=function(e,t){return{range:e,expression:t}},e.is=function(e){var t=e;return null!=t&&ee.is(t.range)&&(Ct.string(t.expression)||void 0===t.expression)}}(ut||(ut={})),function(e){e.create=function(e,t){return{frameId:e,stoppedLocation:t}},e.is=function(e){var t=e;return Ct.defined(t)&&ee.is(e.stoppedLocation)}}(lt||(lt={})),function(e){e.Type=1,e.Parameter=2,e.is=function(e){return 1===e||2===e}}(dt||(dt={})),function(e){e.create=function(e){return{value:e}},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&(void 0===t.tooltip||Ct.string(t.tooltip)||qe.is(t.tooltip))&&(void 0===t.location||te.is(t.location))&&(void 0===t.command||he.is(t.command))}}(gt||(gt={})),function(e){e.create=function(e,t,n){var i={position:e,label:t};return void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Z.is(t.position)&&(Ct.string(t.label)||Ct.typedArray(t.label,gt.is))&&(void 0===t.kind||dt.is(t.kind))&&void 0===t.textEdits||Ct.typedArray(t.textEdits,pe.is)&&(void 0===t.tooltip||Ct.string(t.tooltip)||qe.is(t.tooltip))&&(void 0===t.paddingLeft||Ct.boolean(t.paddingLeft))&&(void 0===t.paddingRight||Ct.boolean(t.paddingRight))}}(ht||(ht={})),function(e){e.is=function(e){var t=e;return Ct.objectLiteral(t)&&Q.is(t.uri)&&Ct.string(t.name)}}(pt||(pt={}));var yt;!function(e){function t(e,n){if(e.length<=1)return e;var i=e.length/2|0,o=e.slice(0,i),r=e.slice(i);t(o,n),t(r,n);for(var s=0,a=0,c=0;s<o.length&&a<r.length;){var u=n(o[s],r[a]);e[c++]=u<=0?o[s++]:r[a++]}for(;s<o.length;)e[c++]=o[s++];for(;a<r.length;)e[c++]=r[a++];return e}e.create=function(e,t,n,i){return new Dt(e,t,n,i)},e.is=function(e){var t=e;return!!(Ct.defined(t)&&Ct.string(t.uri)&&(Ct.undefined(t.languageId)||Ct.string(t.languageId))&&Ct.uinteger(t.lineCount)&&Ct.func(t.getText)&&Ct.func(t.positionAt)&&Ct.func(t.offsetAt))},e.applyEdits=function(e,n){for(var i=e.getText(),o=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),r=i.length,s=o.length-1;s>=0;s--){var a=o[s],c=e.offsetAt(a.range.start),u=e.offsetAt(a.range.end);if(!(u<=r))throw new Error("Overlapping edit");i=i.substring(0,c)+a.newText+i.substring(u,i.length),r=c}return i}}(yt||(yt={}));var Ct,Dt=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,i=0;i<t.length;i++){n&&(e.push(i),n=!1);var o=t.charAt(i);n="\r"===o||"\n"===o,"\r"===o&&i+1<t.length&&"\n"===t.charAt(i+1)&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return Z.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}var r=n-1;return Z.create(r,e-t[r])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,i){return"[object Number]"===t.call(e)&&n<=e&&e<=i},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(Ct||(Ct={}));const Rt=e(Object.freeze(Object.defineProperty({__proto__:null,get AnnotatedTextEdit(){return ve},get ChangeAnnotation(){return me},get ChangeAnnotationIdentifier(){return fe},get CodeAction(){return Ze},get CodeActionContext(){return Ye},get CodeActionKind(){return Qe},get CodeActionTriggerKind(){return Ge},get CodeDescription(){return de},get CodeLens(){return et},get Color(){return ie},get ColorInformation(){return oe},get ColorPresentation(){return re},get Command(){return he},get CompletionItem(){return Le},get CompletionItemKind(){return Fe},get CompletionItemLabelDetails(){return Ie},get CompletionItemTag(){return Ee},get CompletionList(){return je},get CreateFile(){return Ce},get DeleteFile(){return Re},get Diagnostic(){return ge},get DiagnosticRelatedInformation(){return ce},get DiagnosticSeverity(){return ue},get DiagnosticTag(){return le},get DocumentHighlight(){return ze},get DocumentHighlightKind(){return Ue},get DocumentLink(){return nt},get DocumentSymbol(){return Xe},get DocumentUri(){return X},EOL:["\n","\r\n","\r"],get FoldingRange(){return ae},get FoldingRangeKind(){return se},get FormattingOptions(){return tt},get Hover(){return He},get InlayHint(){return ht},get InlayHintKind(){return dt},get InlayHintLabelPart(){return gt},get InlineValueContext(){return lt},get InlineValueEvaluatableExpression(){return ut},get InlineValueText(){return at},get InlineValueVariableLookup(){return ct},get InsertReplaceEdit(){return Me},get InsertTextFormat(){return Oe},get InsertTextMode(){return Ne},get Location(){return te},get LocationLink(){return ne},get MarkedString(){return Ae},get MarkupContent(){return qe},get MarkupKind(){return xe},get OptionalVersionedTextDocumentIdentifier(){return ke},get ParameterInformation(){return Ke},get Position(){return Z},get Range(){return ee},get RenameFile(){return De},get SelectionRange(){return it},get SemanticTokenModifiers(){return rt},get SemanticTokenTypes(){return ot},get SemanticTokens(){return st},get SignatureInformation(){return We},get SymbolInformation(){return Be},get SymbolKind(){return $e},get SymbolTag(){return Ve},get TextDocument(){return yt},get TextDocumentEdit(){return ye},get TextDocumentIdentifier(){return we},get TextDocumentItem(){return Pe},get TextEdit(){return pe},get URI(){return Q},get VersionedTextDocumentIdentifier(){return _e},WorkspaceChange:vt,get WorkspaceEdit(){return be},get WorkspaceFolder(){return pt},get WorkspaceSymbol(){return Je},get integer(){return G},get uinteger(){return Y}},Symbol.toStringTag,{value:"Module"})));var bt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProtocolNotificationType=e.ProtocolNotificationType0=e.ProtocolRequestType=e.ProtocolRequestType0=e.RegistrationType=e.MessageDirection=void 0;const t=u;var n;(n=e.MessageDirection||(e.MessageDirection={})).clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both";e.RegistrationType=class{constructor(e){this.method=e}};e.ProtocolRequestType0=class extends t.RequestType0{constructor(e){super(e)}};e.ProtocolRequestType=class extends t.RequestType{constructor(e){super(e,t.ParameterStructures.byName)}};e.ProtocolNotificationType0=class extends t.NotificationType0{constructor(e){super(e)}};e.ProtocolNotificationType=class extends t.NotificationType{constructor(e){super(e,t.ParameterStructures.byName)}}}(bt);var St={},Tt={};function wt(e){return"string"==typeof e||e instanceof String}function _t(e){return Array.isArray(e)}Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.objectLiteral=Tt.typedArray=Tt.stringArray=Tt.array=Tt.func=Tt.error=Tt.number=Tt.string=Tt.boolean=void 0,Tt.boolean=function(e){return!0===e||!1===e},Tt.string=wt,Tt.number=function(e){return"number"==typeof e||e instanceof Number},Tt.error=function(e){return e instanceof Error},Tt.func=function(e){return"function"==typeof e},Tt.array=_t,Tt.stringArray=function(e){return _t(e)&&e.every((e=>wt(e)))},Tt.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},Tt.objectLiteral=function(e){return null!==e&&"object"==typeof e};var kt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ImplementationRequest=void 0;const t=bt;var n;(n=e.ImplementationRequest||(e.ImplementationRequest={})).method="textDocument/implementation",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(kt);var Pt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TypeDefinitionRequest=void 0;const t=bt;var n;(n=e.TypeDefinitionRequest||(e.TypeDefinitionRequest={})).method="textDocument/typeDefinition",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(Pt);var xt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DidChangeWorkspaceFoldersNotification=e.WorkspaceFoldersRequest=void 0;const t=bt;var n,i;(n=e.WorkspaceFoldersRequest||(e.WorkspaceFoldersRequest={})).method="workspace/workspaceFolders",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType0(n.method),(i=e.DidChangeWorkspaceFoldersNotification||(e.DidChangeWorkspaceFoldersNotification={})).method="workspace/didChangeWorkspaceFolders",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolNotificationType(i.method)}(xt);var qt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConfigurationRequest=void 0;const t=bt;var n;(n=e.ConfigurationRequest||(e.ConfigurationRequest={})).method="workspace/configuration",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)}(qt);var Ft={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ColorPresentationRequest=e.DocumentColorRequest=void 0;const t=bt;var n,i;(n=e.DocumentColorRequest||(e.DocumentColorRequest={})).method="textDocument/documentColor",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method),(i=e.ColorPresentationRequest||(e.ColorPresentationRequest={})).method="textDocument/colorPresentation",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)}(Ft);var Ot={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FoldingRangeRequest=void 0;const t=bt;var n;(n=e.FoldingRangeRequest||(e.FoldingRangeRequest={})).method="textDocument/foldingRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(Ot);var Et={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DeclarationRequest=void 0;const t=bt;var n;(n=e.DeclarationRequest||(e.DeclarationRequest={})).method="textDocument/declaration",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(Et);var Mt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRangeRequest=void 0;const t=bt;var n;(n=e.SelectionRangeRequest||(e.SelectionRangeRequest={})).method="textDocument/selectionRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(Mt);var Nt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkDoneProgressCancelNotification=e.WorkDoneProgressCreateRequest=e.WorkDoneProgress=void 0;const t=u,n=bt;var i,o,r;(i=e.WorkDoneProgress||(e.WorkDoneProgress={})).type=new t.ProgressType,i.is=function(e){return e===i.type},(o=e.WorkDoneProgressCreateRequest||(e.WorkDoneProgressCreateRequest={})).method="window/workDoneProgress/create",o.messageDirection=n.MessageDirection.serverToClient,o.type=new n.ProtocolRequestType(o.method),(r=e.WorkDoneProgressCancelNotification||(e.WorkDoneProgressCancelNotification={})).method="window/workDoneProgress/cancel",r.messageDirection=n.MessageDirection.clientToServer,r.type=new n.ProtocolNotificationType(r.method)}(Nt);var It={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CallHierarchyOutgoingCallsRequest=e.CallHierarchyIncomingCallsRequest=e.CallHierarchyPrepareRequest=void 0;const t=bt;var n,i,o;(n=e.CallHierarchyPrepareRequest||(e.CallHierarchyPrepareRequest={})).method="textDocument/prepareCallHierarchy",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method),(i=e.CallHierarchyIncomingCallsRequest||(e.CallHierarchyIncomingCallsRequest={})).method="callHierarchy/incomingCalls",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method),(o=e.CallHierarchyOutgoingCallsRequest||(e.CallHierarchyOutgoingCallsRequest={})).method="callHierarchy/outgoingCalls",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method)}(It);var Lt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SemanticTokensRefreshRequest=e.SemanticTokensRangeRequest=e.SemanticTokensDeltaRequest=e.SemanticTokensRequest=e.SemanticTokensRegistrationType=e.TokenFormat=void 0;const t=bt;var n,i,o,r,s;(e.TokenFormat||(e.TokenFormat={})).Relative="relative",function(e){e.method="textDocument/semanticTokens",e.type=new t.RegistrationType(e.method)}(n=e.SemanticTokensRegistrationType||(e.SemanticTokensRegistrationType={})),(i=e.SemanticTokensRequest||(e.SemanticTokensRequest={})).method="textDocument/semanticTokens/full",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method),i.registrationMethod=n.method,(o=e.SemanticTokensDeltaRequest||(e.SemanticTokensDeltaRequest={})).method="textDocument/semanticTokens/full/delta",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method),o.registrationMethod=n.method,(r=e.SemanticTokensRangeRequest||(e.SemanticTokensRangeRequest={})).method="textDocument/semanticTokens/range",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method),r.registrationMethod=n.method,(s=e.SemanticTokensRefreshRequest||(e.SemanticTokensRefreshRequest={})).method="workspace/semanticTokens/refresh",s.messageDirection=t.MessageDirection.serverToClient,s.type=new t.ProtocolRequestType0(s.method)}(Lt);var jt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ShowDocumentRequest=void 0;const t=bt;var n;(n=e.ShowDocumentRequest||(e.ShowDocumentRequest={})).method="window/showDocument",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)}(jt);var At={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LinkedEditingRangeRequest=void 0;const t=bt;var n;(n=e.LinkedEditingRangeRequest||(e.LinkedEditingRangeRequest={})).method="textDocument/linkedEditingRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(At);var Ht={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WillDeleteFilesRequest=e.DidDeleteFilesNotification=e.DidRenameFilesNotification=e.WillRenameFilesRequest=e.DidCreateFilesNotification=e.WillCreateFilesRequest=e.FileOperationPatternKind=void 0;const t=bt;var n,i,o,r,s,a,c;(n=e.FileOperationPatternKind||(e.FileOperationPatternKind={})).file="file",n.folder="folder",(i=e.WillCreateFilesRequest||(e.WillCreateFilesRequest={})).method="workspace/willCreateFiles",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method),(o=e.DidCreateFilesNotification||(e.DidCreateFilesNotification={})).method="workspace/didCreateFiles",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolNotificationType(o.method),(r=e.WillRenameFilesRequest||(e.WillRenameFilesRequest={})).method="workspace/willRenameFiles",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method),(s=e.DidRenameFilesNotification||(e.DidRenameFilesNotification={})).method="workspace/didRenameFiles",s.messageDirection=t.MessageDirection.clientToServer,s.type=new t.ProtocolNotificationType(s.method),(a=e.DidDeleteFilesNotification||(e.DidDeleteFilesNotification={})).method="workspace/didDeleteFiles",a.messageDirection=t.MessageDirection.clientToServer,a.type=new t.ProtocolNotificationType(a.method),(c=e.WillDeleteFilesRequest||(e.WillDeleteFilesRequest={})).method="workspace/willDeleteFiles",c.messageDirection=t.MessageDirection.clientToServer,c.type=new t.ProtocolRequestType(c.method)}(Ht);var Kt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MonikerRequest=e.MonikerKind=e.UniquenessLevel=void 0;const t=bt;var n,i,o;(n=e.UniquenessLevel||(e.UniquenessLevel={})).document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global",(i=e.MonikerKind||(e.MonikerKind={})).$import="import",i.$export="export",i.local="local",(o=e.MonikerRequest||(e.MonikerRequest={})).method="textDocument/moniker",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method)}(Kt);var Wt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TypeHierarchySubtypesRequest=e.TypeHierarchySupertypesRequest=e.TypeHierarchyPrepareRequest=void 0;const t=bt;var n,i,o;(n=e.TypeHierarchyPrepareRequest||(e.TypeHierarchyPrepareRequest={})).method="textDocument/prepareTypeHierarchy",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method),(i=e.TypeHierarchySupertypesRequest||(e.TypeHierarchySupertypesRequest={})).method="typeHierarchy/supertypes",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method),(o=e.TypeHierarchySubtypesRequest||(e.TypeHierarchySubtypesRequest={})).method="typeHierarchy/subtypes",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method)}(Wt);var Ut={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InlineValueRefreshRequest=e.InlineValueRequest=void 0;const t=bt;var n,i;(n=e.InlineValueRequest||(e.InlineValueRequest={})).method="textDocument/inlineValue",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method),(i=e.InlineValueRefreshRequest||(e.InlineValueRefreshRequest={})).method="workspace/inlineValue/refresh",i.messageDirection=t.MessageDirection.serverToClient,i.type=new t.ProtocolRequestType0(i.method)}(Ut);var zt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InlayHintRefreshRequest=e.InlayHintResolveRequest=e.InlayHintRequest=void 0;const t=bt;var n,i,o;(n=e.InlayHintRequest||(e.InlayHintRequest={})).method="textDocument/inlayHint",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method),(i=e.InlayHintResolveRequest||(e.InlayHintResolveRequest={})).method="inlayHint/resolve",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method),(o=e.InlayHintRefreshRequest||(e.InlayHintRefreshRequest={})).method="workspace/inlayHint/refresh",o.messageDirection=t.MessageDirection.serverToClient,o.type=new t.ProtocolRequestType0(o.method)}(zt);var $t={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiagnosticRefreshRequest=e.WorkspaceDiagnosticRequest=e.DocumentDiagnosticRequest=e.DocumentDiagnosticReportKind=e.DiagnosticServerCancellationData=void 0;const t=u,n=Tt,i=bt;var o,r,s,a;(e.DiagnosticServerCancellationData||(e.DiagnosticServerCancellationData={})).is=function(e){const t=e;return t&&n.boolean(t.retriggerRequest)},(o=e.DocumentDiagnosticReportKind||(e.DocumentDiagnosticReportKind={})).Full="full",o.Unchanged="unchanged",(r=e.DocumentDiagnosticRequest||(e.DocumentDiagnosticRequest={})).method="textDocument/diagnostic",r.messageDirection=i.MessageDirection.clientToServer,r.type=new i.ProtocolRequestType(r.method),r.partialResult=new t.ProgressType,(s=e.WorkspaceDiagnosticRequest||(e.WorkspaceDiagnosticRequest={})).method="workspace/diagnostic",s.messageDirection=i.MessageDirection.clientToServer,s.type=new i.ProtocolRequestType(s.method),s.partialResult=new t.ProgressType,(a=e.DiagnosticRefreshRequest||(e.DiagnosticRefreshRequest={})).method="workspace/diagnostic/refresh",a.messageDirection=i.MessageDirection.serverToClient,a.type=new i.ProtocolRequestType0(a.method)}($t);var Vt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DidCloseNotebookDocumentNotification=e.DidSaveNotebookDocumentNotification=e.DidChangeNotebookDocumentNotification=e.NotebookCellArrayChange=e.DidOpenNotebookDocumentNotification=e.NotebookDocumentSyncRegistrationType=e.NotebookDocument=e.NotebookCell=e.ExecutionSummary=e.NotebookCellKind=void 0;const t=Rt,n=Tt,i=bt;var o,r,s,a,c,u,l,d,g,h;!function(e){e.Markup=1,e.Code=2,e.is=function(e){return 1===e||2===e}}(o=e.NotebookCellKind||(e.NotebookCellKind={})),function(e){e.create=function(e,t){const n={executionOrder:e};return!0!==t&&!1!==t||(n.success=t),n},e.is=function(e){const i=e;return n.objectLiteral(i)&&t.uinteger.is(i.executionOrder)&&(void 0===i.success||n.boolean(i.success))},e.equals=function(e,t){return e===t||null!=e&&null!=t&&(e.executionOrder===t.executionOrder&&e.success===t.success)}}(r=e.ExecutionSummary||(e.ExecutionSummary={})),function(e){function i(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return!1;const o=Array.isArray(e),r=Array.isArray(t);if(o!==r)return!1;if(o&&r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!i(e[n],t[n]))return!1}if(n.objectLiteral(e)&&n.objectLiteral(t)){const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;if(n.sort(),o.sort(),!i(n,o))return!1;for(let r=0;r<n.length;r++){const o=n[r];if(!i(e[o],t[o]))return!1}}return!0}e.create=function(e,t){return{kind:e,document:t}},e.is=function(e){const i=e;return n.objectLiteral(i)&&o.is(i.kind)&&t.DocumentUri.is(i.document)&&(void 0===i.metadata||n.objectLiteral(i.metadata))},e.diff=function(e,t){const n=new Set;return e.document!==t.document&&n.add("document"),e.kind!==t.kind&&n.add("kind"),e.executionSummary!==t.executionSummary&&n.add("executionSummary"),void 0===e.metadata&&void 0===t.metadata||i(e.metadata,t.metadata)||n.add("metadata"),void 0===e.executionSummary&&void 0===t.executionSummary||r.equals(e.executionSummary,t.executionSummary)||n.add("executionSummary"),n}}(s=e.NotebookCell||(e.NotebookCell={})),(a=e.NotebookDocument||(e.NotebookDocument={})).create=function(e,t,n,i){return{uri:e,notebookType:t,version:n,cells:i}},a.is=function(e){const i=e;return n.objectLiteral(i)&&n.string(i.uri)&&t.integer.is(i.version)&&n.typedArray(i.cells,s.is)},function(e){e.method="notebookDocument/sync",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.RegistrationType(e.method)}(c=e.NotebookDocumentSyncRegistrationType||(e.NotebookDocumentSyncRegistrationType={})),(u=e.DidOpenNotebookDocumentNotification||(e.DidOpenNotebookDocumentNotification={})).method="notebookDocument/didOpen",u.messageDirection=i.MessageDirection.clientToServer,u.type=new i.ProtocolNotificationType(u.method),u.registrationMethod=c.method,(l=e.NotebookCellArrayChange||(e.NotebookCellArrayChange={})).is=function(e){const i=e;return n.objectLiteral(i)&&t.uinteger.is(i.start)&&t.uinteger.is(i.deleteCount)&&(void 0===i.cells||n.typedArray(i.cells,s.is))},l.create=function(e,t,n){const i={start:e,deleteCount:t};return void 0!==n&&(i.cells=n),i},(d=e.DidChangeNotebookDocumentNotification||(e.DidChangeNotebookDocumentNotification={})).method="notebookDocument/didChange",d.messageDirection=i.MessageDirection.clientToServer,d.type=new i.ProtocolNotificationType(d.method),d.registrationMethod=c.method,(g=e.DidSaveNotebookDocumentNotification||(e.DidSaveNotebookDocumentNotification={})).method="notebookDocument/didSave",g.messageDirection=i.MessageDirection.clientToServer,g.type=new i.ProtocolNotificationType(g.method),g.registrationMethod=c.method,(h=e.DidCloseNotebookDocumentNotification||(e.DidCloseNotebookDocumentNotification={})).method="notebookDocument/didClose",h.messageDirection=i.MessageDirection.clientToServer,h.type=new i.ProtocolNotificationType(h.method),h.registrationMethod=c.method}(Vt),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceSymbolRequest=e.CodeActionResolveRequest=e.CodeActionRequest=e.DocumentSymbolRequest=e.DocumentHighlightRequest=e.ReferencesRequest=e.DefinitionRequest=e.SignatureHelpRequest=e.SignatureHelpTriggerKind=e.HoverRequest=e.CompletionResolveRequest=e.CompletionRequest=e.CompletionTriggerKind=e.PublishDiagnosticsNotification=e.WatchKind=e.RelativePattern=e.FileChangeType=e.DidChangeWatchedFilesNotification=e.WillSaveTextDocumentWaitUntilRequest=e.WillSaveTextDocumentNotification=e.TextDocumentSaveReason=e.DidSaveTextDocumentNotification=e.DidCloseTextDocumentNotification=e.DidChangeTextDocumentNotification=e.TextDocumentContentChangeEvent=e.DidOpenTextDocumentNotification=e.TextDocumentSyncKind=e.TelemetryEventNotification=e.LogMessageNotification=e.ShowMessageRequest=e.ShowMessageNotification=e.MessageType=e.DidChangeConfigurationNotification=e.ExitNotification=e.ShutdownRequest=e.InitializedNotification=e.InitializeErrorCodes=e.InitializeRequest=e.WorkDoneProgressOptions=e.TextDocumentRegistrationOptions=e.StaticRegistrationOptions=e.PositionEncodingKind=e.FailureHandlingKind=e.ResourceOperationKind=e.UnregistrationRequest=e.RegistrationRequest=e.DocumentSelector=e.NotebookCellTextDocumentFilter=e.NotebookDocumentFilter=e.TextDocumentFilter=void 0,e.TypeHierarchySubtypesRequest=e.TypeHierarchyPrepareRequest=e.MonikerRequest=e.MonikerKind=e.UniquenessLevel=e.WillDeleteFilesRequest=e.DidDeleteFilesNotification=e.WillRenameFilesRequest=e.DidRenameFilesNotification=e.WillCreateFilesRequest=e.DidCreateFilesNotification=e.FileOperationPatternKind=e.LinkedEditingRangeRequest=e.ShowDocumentRequest=e.SemanticTokensRegistrationType=e.SemanticTokensRefreshRequest=e.SemanticTokensRangeRequest=e.SemanticTokensDeltaRequest=e.SemanticTokensRequest=e.TokenFormat=e.CallHierarchyPrepareRequest=e.CallHierarchyOutgoingCallsRequest=e.CallHierarchyIncomingCallsRequest=e.WorkDoneProgressCancelNotification=e.WorkDoneProgressCreateRequest=e.WorkDoneProgress=e.SelectionRangeRequest=e.DeclarationRequest=e.FoldingRangeRequest=e.ColorPresentationRequest=e.DocumentColorRequest=e.ConfigurationRequest=e.DidChangeWorkspaceFoldersNotification=e.WorkspaceFoldersRequest=e.TypeDefinitionRequest=e.ImplementationRequest=e.ApplyWorkspaceEditRequest=e.ExecuteCommandRequest=e.PrepareRenameRequest=e.RenameRequest=e.PrepareSupportDefaultBehavior=e.DocumentOnTypeFormattingRequest=e.DocumentRangeFormattingRequest=e.DocumentFormattingRequest=e.DocumentLinkResolveRequest=e.DocumentLinkRequest=e.CodeLensRefreshRequest=e.CodeLensResolveRequest=e.CodeLensRequest=e.WorkspaceSymbolResolveRequest=void 0,e.DidCloseNotebookDocumentNotification=e.DidSaveNotebookDocumentNotification=e.DidChangeNotebookDocumentNotification=e.NotebookCellArrayChange=e.DidOpenNotebookDocumentNotification=e.NotebookDocumentSyncRegistrationType=e.NotebookDocument=e.NotebookCell=e.ExecutionSummary=e.NotebookCellKind=e.DiagnosticRefreshRequest=e.WorkspaceDiagnosticRequest=e.DocumentDiagnosticRequest=e.DocumentDiagnosticReportKind=e.DiagnosticServerCancellationData=e.InlayHintRefreshRequest=e.InlayHintResolveRequest=e.InlayHintRequest=e.InlineValueRefreshRequest=e.InlineValueRequest=e.TypeHierarchySupertypesRequest=void 0;const t=bt,n=Rt,i=Tt,o=kt;Object.defineProperty(e,"ImplementationRequest",{enumerable:!0,get:function(){return o.ImplementationRequest}});const r=Pt;Object.defineProperty(e,"TypeDefinitionRequest",{enumerable:!0,get:function(){return r.TypeDefinitionRequest}});const s=xt;Object.defineProperty(e,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return s.WorkspaceFoldersRequest}}),Object.defineProperty(e,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return s.DidChangeWorkspaceFoldersNotification}});const a=qt;Object.defineProperty(e,"ConfigurationRequest",{enumerable:!0,get:function(){return a.ConfigurationRequest}});const c=Ft;Object.defineProperty(e,"DocumentColorRequest",{enumerable:!0,get:function(){return c.DocumentColorRequest}}),Object.defineProperty(e,"ColorPresentationRequest",{enumerable:!0,get:function(){return c.ColorPresentationRequest}});const u=Ot;Object.defineProperty(e,"FoldingRangeRequest",{enumerable:!0,get:function(){return u.FoldingRangeRequest}});const l=Et;Object.defineProperty(e,"DeclarationRequest",{enumerable:!0,get:function(){return l.DeclarationRequest}});const d=Mt;Object.defineProperty(e,"SelectionRangeRequest",{enumerable:!0,get:function(){return d.SelectionRangeRequest}});const g=Nt;Object.defineProperty(e,"WorkDoneProgress",{enumerable:!0,get:function(){return g.WorkDoneProgress}}),Object.defineProperty(e,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return g.WorkDoneProgressCreateRequest}}),Object.defineProperty(e,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return g.WorkDoneProgressCancelNotification}});const h=It;Object.defineProperty(e,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(e,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(e,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return h.CallHierarchyPrepareRequest}});const p=Lt;Object.defineProperty(e,"TokenFormat",{enumerable:!0,get:function(){return p.TokenFormat}}),Object.defineProperty(e,"SemanticTokensRequest",{enumerable:!0,get:function(){return p.SemanticTokensRequest}}),Object.defineProperty(e,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return p.SemanticTokensDeltaRequest}}),Object.defineProperty(e,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return p.SemanticTokensRangeRequest}}),Object.defineProperty(e,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return p.SemanticTokensRefreshRequest}}),Object.defineProperty(e,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return p.SemanticTokensRegistrationType}});const m=jt;Object.defineProperty(e,"ShowDocumentRequest",{enumerable:!0,get:function(){return m.ShowDocumentRequest}});const f=At;Object.defineProperty(e,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return f.LinkedEditingRangeRequest}});const v=Ht;Object.defineProperty(e,"FileOperationPatternKind",{enumerable:!0,get:function(){return v.FileOperationPatternKind}}),Object.defineProperty(e,"DidCreateFilesNotification",{enumerable:!0,get:function(){return v.DidCreateFilesNotification}}),Object.defineProperty(e,"WillCreateFilesRequest",{enumerable:!0,get:function(){return v.WillCreateFilesRequest}}),Object.defineProperty(e,"DidRenameFilesNotification",{enumerable:!0,get:function(){return v.DidRenameFilesNotification}}),Object.defineProperty(e,"WillRenameFilesRequest",{enumerable:!0,get:function(){return v.WillRenameFilesRequest}}),Object.defineProperty(e,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return v.DidDeleteFilesNotification}}),Object.defineProperty(e,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return v.WillDeleteFilesRequest}});const y=Kt;Object.defineProperty(e,"UniquenessLevel",{enumerable:!0,get:function(){return y.UniquenessLevel}}),Object.defineProperty(e,"MonikerKind",{enumerable:!0,get:function(){return y.MonikerKind}}),Object.defineProperty(e,"MonikerRequest",{enumerable:!0,get:function(){return y.MonikerRequest}});const C=Wt;Object.defineProperty(e,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return C.TypeHierarchyPrepareRequest}}),Object.defineProperty(e,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return C.TypeHierarchySubtypesRequest}}),Object.defineProperty(e,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return C.TypeHierarchySupertypesRequest}});const D=Ut;Object.defineProperty(e,"InlineValueRequest",{enumerable:!0,get:function(){return D.InlineValueRequest}}),Object.defineProperty(e,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return D.InlineValueRefreshRequest}});const R=zt;Object.defineProperty(e,"InlayHintRequest",{enumerable:!0,get:function(){return R.InlayHintRequest}}),Object.defineProperty(e,"InlayHintResolveRequest",{enumerable:!0,get:function(){return R.InlayHintResolveRequest}}),Object.defineProperty(e,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return R.InlayHintRefreshRequest}});const b=$t;Object.defineProperty(e,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return b.DiagnosticServerCancellationData}}),Object.defineProperty(e,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return b.DocumentDiagnosticReportKind}}),Object.defineProperty(e,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return b.DocumentDiagnosticRequest}}),Object.defineProperty(e,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return b.WorkspaceDiagnosticRequest}}),Object.defineProperty(e,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return b.DiagnosticRefreshRequest}});const S=Vt;var T,w,_,k,P,x,q,F,O,E,M,N,I,L,j,A,H,K,W,U,z,$,V,B,J,X,Q,G,Y,Z,ee,te,ne,ie,oe,re,se,ae,ce,ue,le,de,ge,he,pe,me,fe,ve,ye,Ce,De,Re,be,Se,Te,we,_e,ke,Pe;Object.defineProperty(e,"NotebookCellKind",{enumerable:!0,get:function(){return S.NotebookCellKind}}),Object.defineProperty(e,"ExecutionSummary",{enumerable:!0,get:function(){return S.ExecutionSummary}}),Object.defineProperty(e,"NotebookCell",{enumerable:!0,get:function(){return S.NotebookCell}}),Object.defineProperty(e,"NotebookDocument",{enumerable:!0,get:function(){return S.NotebookDocument}}),Object.defineProperty(e,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return S.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(e,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return S.DidOpenNotebookDocumentNotification}}),Object.defineProperty(e,"NotebookCellArrayChange",{enumerable:!0,get:function(){return S.NotebookCellArrayChange}}),Object.defineProperty(e,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return S.DidChangeNotebookDocumentNotification}}),Object.defineProperty(e,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return S.DidSaveNotebookDocumentNotification}}),Object.defineProperty(e,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return S.DidCloseNotebookDocumentNotification}}),function(e){e.is=function(e){const t=e;return i.string(t.language)||i.string(t.scheme)||i.string(t.pattern)}}(T=e.TextDocumentFilter||(e.TextDocumentFilter={})),function(e){e.is=function(e){const t=e;return i.objectLiteral(t)&&(i.string(t.notebookType)||i.string(t.scheme)||i.string(t.pattern))}}(w=e.NotebookDocumentFilter||(e.NotebookDocumentFilter={})),function(e){e.is=function(e){const t=e;return i.objectLiteral(t)&&(i.string(t.notebook)||w.is(t.notebook))&&(void 0===t.language||i.string(t.language))}}(_=e.NotebookCellTextDocumentFilter||(e.NotebookCellTextDocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!i.string(t)&&!T.is(t)&&!_.is(t))return!1;return!0}}(k=e.DocumentSelector||(e.DocumentSelector={})),(P=e.RegistrationRequest||(e.RegistrationRequest={})).method="client/registerCapability",P.messageDirection=t.MessageDirection.serverToClient,P.type=new t.ProtocolRequestType(P.method),(x=e.UnregistrationRequest||(e.UnregistrationRequest={})).method="client/unregisterCapability",x.messageDirection=t.MessageDirection.serverToClient,x.type=new t.ProtocolRequestType(x.method),(q=e.ResourceOperationKind||(e.ResourceOperationKind={})).Create="create",q.Rename="rename",q.Delete="delete",(F=e.FailureHandlingKind||(e.FailureHandlingKind={})).Abort="abort",F.Transactional="transactional",F.TextOnlyTransactional="textOnlyTransactional",F.Undo="undo",(O=e.PositionEncodingKind||(e.PositionEncodingKind={})).UTF8="utf-8",O.UTF16="utf-16",O.UTF32="utf-32",(e.StaticRegistrationOptions||(e.StaticRegistrationOptions={})).hasId=function(e){const t=e;return t&&i.string(t.id)&&t.id.length>0},(e.TextDocumentRegistrationOptions||(e.TextDocumentRegistrationOptions={})).is=function(e){const t=e;return t&&(null===t.documentSelector||k.is(t.documentSelector))},(E=e.WorkDoneProgressOptions||(e.WorkDoneProgressOptions={})).is=function(e){const t=e;return i.objectLiteral(t)&&(void 0===t.workDoneProgress||i.boolean(t.workDoneProgress))},E.hasWorkDoneProgress=function(e){const t=e;return t&&i.boolean(t.workDoneProgress)},(M=e.InitializeRequest||(e.InitializeRequest={})).method="initialize",M.messageDirection=t.MessageDirection.clientToServer,M.type=new t.ProtocolRequestType(M.method),(e.InitializeErrorCodes||(e.InitializeErrorCodes={})).unknownProtocolVersion=1,(N=e.InitializedNotification||(e.InitializedNotification={})).method="initialized",N.messageDirection=t.MessageDirection.clientToServer,N.type=new t.ProtocolNotificationType(N.method),(I=e.ShutdownRequest||(e.ShutdownRequest={})).method="shutdown",I.messageDirection=t.MessageDirection.clientToServer,I.type=new t.ProtocolRequestType0(I.method),(L=e.ExitNotification||(e.ExitNotification={})).method="exit",L.messageDirection=t.MessageDirection.clientToServer,L.type=new t.ProtocolNotificationType0(L.method),(j=e.DidChangeConfigurationNotification||(e.DidChangeConfigurationNotification={})).method="workspace/didChangeConfiguration",j.messageDirection=t.MessageDirection.clientToServer,j.type=new t.ProtocolNotificationType(j.method),(A=e.MessageType||(e.MessageType={})).Error=1,A.Warning=2,A.Info=3,A.Log=4,(H=e.ShowMessageNotification||(e.ShowMessageNotification={})).method="window/showMessage",H.messageDirection=t.MessageDirection.serverToClient,H.type=new t.ProtocolNotificationType(H.method),(K=e.ShowMessageRequest||(e.ShowMessageRequest={})).method="window/showMessageRequest",K.messageDirection=t.MessageDirection.serverToClient,K.type=new t.ProtocolRequestType(K.method),(W=e.LogMessageNotification||(e.LogMessageNotification={})).method="window/logMessage",W.messageDirection=t.MessageDirection.serverToClient,W.type=new t.ProtocolNotificationType(W.method),(U=e.TelemetryEventNotification||(e.TelemetryEventNotification={})).method="telemetry/event",U.messageDirection=t.MessageDirection.serverToClient,U.type=new t.ProtocolNotificationType(U.method),(z=e.TextDocumentSyncKind||(e.TextDocumentSyncKind={})).None=0,z.Full=1,z.Incremental=2,($=e.DidOpenTextDocumentNotification||(e.DidOpenTextDocumentNotification={})).method="textDocument/didOpen",$.messageDirection=t.MessageDirection.clientToServer,$.type=new t.ProtocolNotificationType($.method),(V=e.TextDocumentContentChangeEvent||(e.TextDocumentContentChangeEvent={})).isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},V.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},(B=e.DidChangeTextDocumentNotification||(e.DidChangeTextDocumentNotification={})).method="textDocument/didChange",B.messageDirection=t.MessageDirection.clientToServer,B.type=new t.ProtocolNotificationType(B.method),(J=e.DidCloseTextDocumentNotification||(e.DidCloseTextDocumentNotification={})).method="textDocument/didClose",J.messageDirection=t.MessageDirection.clientToServer,J.type=new t.ProtocolNotificationType(J.method),(X=e.DidSaveTextDocumentNotification||(e.DidSaveTextDocumentNotification={})).method="textDocument/didSave",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType(X.method),(Q=e.TextDocumentSaveReason||(e.TextDocumentSaveReason={})).Manual=1,Q.AfterDelay=2,Q.FocusOut=3,(G=e.WillSaveTextDocumentNotification||(e.WillSaveTextDocumentNotification={})).method="textDocument/willSave",G.messageDirection=t.MessageDirection.clientToServer,G.type=new t.ProtocolNotificationType(G.method),(Y=e.WillSaveTextDocumentWaitUntilRequest||(e.WillSaveTextDocumentWaitUntilRequest={})).method="textDocument/willSaveWaitUntil",Y.messageDirection=t.MessageDirection.clientToServer,Y.type=new t.ProtocolRequestType(Y.method),(Z=e.DidChangeWatchedFilesNotification||(e.DidChangeWatchedFilesNotification={})).method="workspace/didChangeWatchedFiles",Z.messageDirection=t.MessageDirection.clientToServer,Z.type=new t.ProtocolNotificationType(Z.method),(ee=e.FileChangeType||(e.FileChangeType={})).Created=1,ee.Changed=2,ee.Deleted=3,(e.RelativePattern||(e.RelativePattern={})).is=function(e){const t=e;return i.objectLiteral(t)&&(n.URI.is(t.baseUri)||n.WorkspaceFolder.is(t.baseUri))&&i.string(t.pattern)},(te=e.WatchKind||(e.WatchKind={})).Create=1,te.Change=2,te.Delete=4,(ne=e.PublishDiagnosticsNotification||(e.PublishDiagnosticsNotification={})).method="textDocument/publishDiagnostics",ne.messageDirection=t.MessageDirection.serverToClient,ne.type=new t.ProtocolNotificationType(ne.method),(ie=e.CompletionTriggerKind||(e.CompletionTriggerKind={})).Invoked=1,ie.TriggerCharacter=2,ie.TriggerForIncompleteCompletions=3,(oe=e.CompletionRequest||(e.CompletionRequest={})).method="textDocument/completion",oe.messageDirection=t.MessageDirection.clientToServer,oe.type=new t.ProtocolRequestType(oe.method),(re=e.CompletionResolveRequest||(e.CompletionResolveRequest={})).method="completionItem/resolve",re.messageDirection=t.MessageDirection.clientToServer,re.type=new t.ProtocolRequestType(re.method),(se=e.HoverRequest||(e.HoverRequest={})).method="textDocument/hover",se.messageDirection=t.MessageDirection.clientToServer,se.type=new t.ProtocolRequestType(se.method),(ae=e.SignatureHelpTriggerKind||(e.SignatureHelpTriggerKind={})).Invoked=1,ae.TriggerCharacter=2,ae.ContentChange=3,(ce=e.SignatureHelpRequest||(e.SignatureHelpRequest={})).method="textDocument/signatureHelp",ce.messageDirection=t.MessageDirection.clientToServer,ce.type=new t.ProtocolRequestType(ce.method),(ue=e.DefinitionRequest||(e.DefinitionRequest={})).method="textDocument/definition",ue.messageDirection=t.MessageDirection.clientToServer,ue.type=new t.ProtocolRequestType(ue.method),(le=e.ReferencesRequest||(e.ReferencesRequest={})).method="textDocument/references",le.messageDirection=t.MessageDirection.clientToServer,le.type=new t.ProtocolRequestType(le.method),(de=e.DocumentHighlightRequest||(e.DocumentHighlightRequest={})).method="textDocument/documentHighlight",de.messageDirection=t.MessageDirection.clientToServer,de.type=new t.ProtocolRequestType(de.method),(ge=e.DocumentSymbolRequest||(e.DocumentSymbolRequest={})).method="textDocument/documentSymbol",ge.messageDirection=t.MessageDirection.clientToServer,ge.type=new t.ProtocolRequestType(ge.method),(he=e.CodeActionRequest||(e.CodeActionRequest={})).method="textDocument/codeAction",he.messageDirection=t.MessageDirection.clientToServer,he.type=new t.ProtocolRequestType(he.method),(pe=e.CodeActionResolveRequest||(e.CodeActionResolveRequest={})).method="codeAction/resolve",pe.messageDirection=t.MessageDirection.clientToServer,pe.type=new t.ProtocolRequestType(pe.method),(me=e.WorkspaceSymbolRequest||(e.WorkspaceSymbolRequest={})).method="workspace/symbol",me.messageDirection=t.MessageDirection.clientToServer,me.type=new t.ProtocolRequestType(me.method),(fe=e.WorkspaceSymbolResolveRequest||(e.WorkspaceSymbolResolveRequest={})).method="workspaceSymbol/resolve",fe.messageDirection=t.MessageDirection.clientToServer,fe.type=new t.ProtocolRequestType(fe.method),(ve=e.CodeLensRequest||(e.CodeLensRequest={})).method="textDocument/codeLens",ve.messageDirection=t.MessageDirection.clientToServer,ve.type=new t.ProtocolRequestType(ve.method),(ye=e.CodeLensResolveRequest||(e.CodeLensResolveRequest={})).method="codeLens/resolve",ye.messageDirection=t.MessageDirection.clientToServer,ye.type=new t.ProtocolRequestType(ye.method),(Ce=e.CodeLensRefreshRequest||(e.CodeLensRefreshRequest={})).method="workspace/codeLens/refresh",Ce.messageDirection=t.MessageDirection.serverToClient,Ce.type=new t.ProtocolRequestType0(Ce.method),(De=e.DocumentLinkRequest||(e.DocumentLinkRequest={})).method="textDocument/documentLink",De.messageDirection=t.MessageDirection.clientToServer,De.type=new t.ProtocolRequestType(De.method),(Re=e.DocumentLinkResolveRequest||(e.DocumentLinkResolveRequest={})).method="documentLink/resolve",Re.messageDirection=t.MessageDirection.clientToServer,Re.type=new t.ProtocolRequestType(Re.method),(be=e.DocumentFormattingRequest||(e.DocumentFormattingRequest={})).method="textDocument/formatting",be.messageDirection=t.MessageDirection.clientToServer,be.type=new t.ProtocolRequestType(be.method),(Se=e.DocumentRangeFormattingRequest||(e.DocumentRangeFormattingRequest={})).method="textDocument/rangeFormatting",Se.messageDirection=t.MessageDirection.clientToServer,Se.type=new t.ProtocolRequestType(Se.method),(Te=e.DocumentOnTypeFormattingRequest||(e.DocumentOnTypeFormattingRequest={})).method="textDocument/onTypeFormatting",Te.messageDirection=t.MessageDirection.clientToServer,Te.type=new t.ProtocolRequestType(Te.method),(e.PrepareSupportDefaultBehavior||(e.PrepareSupportDefaultBehavior={})).Identifier=1,(we=e.RenameRequest||(e.RenameRequest={})).method="textDocument/rename",we.messageDirection=t.MessageDirection.clientToServer,we.type=new t.ProtocolRequestType(we.method),(_e=e.PrepareRenameRequest||(e.PrepareRenameRequest={})).method="textDocument/prepareRename",_e.messageDirection=t.MessageDirection.clientToServer,_e.type=new t.ProtocolRequestType(_e.method),(ke=e.ExecuteCommandRequest||(e.ExecuteCommandRequest={})).method="workspace/executeCommand",ke.messageDirection=t.MessageDirection.clientToServer,ke.type=new t.ProtocolRequestType(ke.method),(Pe=e.ApplyWorkspaceEditRequest||(e.ApplyWorkspaceEditRequest={})).method="workspace/applyEdit",Pe.messageDirection=t.MessageDirection.serverToClient,Pe.type=new t.ProtocolRequestType("workspace/applyEdit")}(St);var Bt={};Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.createProtocolConnection=void 0;const Jt=u;Bt.createProtocolConnection=function(e,t,n,i){return Jt.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,Jt.createMessageConnection)(e,t,n,i)},function(e){var t=n&&n.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),i=n&&n.__exportStar||function(e,n){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||t(n,e,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.LSPErrorCodes=e.createProtocolConnection=void 0,i(u,e),i(Rt,e),i(bt,e),i(St,e);var o,r=Bt;Object.defineProperty(e,"createProtocolConnection",{enumerable:!0,get:function(){return r.createProtocolConnection}}),(o=e.LSPErrorCodes||(e.LSPErrorCodes={})).lspReservedErrorRangeStart=-32899,o.RequestFailed=-32803,o.ServerCancelled=-32802,o.ContentModified=-32801,o.RequestCancelled=-32800,o.lspReservedErrorRangeEnd=-32800}(Te),function(e){var t=n&&n.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),i=n&&n.__exportStar||function(e,n){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||t(n,e,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.createProtocolConnection=void 0;const o=Se;i(Se,e),i(Te,e),e.createProtocolConnection=function(e,t,n,i){return(0,o.createMessageConnection)(e,t,n,i)}}(c);var Xt={},Qt={};function Gt(e){return"string"==typeof e||e instanceof String}function Yt(e){return"function"==typeof e}function Zt(e){return Array.isArray(e)}function en(e){return e&&Yt(e.then)}Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.asPromise=Qt.thenable=Qt.typedArray=Qt.stringArray=Qt.array=Qt.func=Qt.error=Qt.number=Qt.string=Qt.boolean=void 0,Qt.boolean=function(e){return!0===e||!1===e},Qt.string=Gt,Qt.number=function(e){return"number"==typeof e||e instanceof Number},Qt.error=function(e){return e instanceof Error},Qt.func=Yt,Qt.array=Zt,Qt.stringArray=function(e){return Zt(e)&&e.every((e=>Gt(e)))},Qt.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},Qt.thenable=en,Qt.asPromise=function(e){return e instanceof Promise?e:en(e)?new Promise(((t,n)=>{e.then((e=>t(e)),(e=>n(e)))})):Promise.resolve(e)};var tn={};Object.defineProperty(tn,"__esModule",{value:!0}),tn.forEach=tn.mapAsync=tn.map=tn.clearTestMode=tn.setTestMode=tn.Semaphore=tn.Delayer=void 0;const nn=c;tn.Delayer=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((e=>{this.onSuccess=e})).then((()=>{this.completionPromise=void 0,this.onSuccess=void 0;var e=this.task();return this.task=void 0,e}))),(t>=0||void 0===this.timeout)&&(this.timeout=(0,nn.RAL)().timer.setTimeout((()=>{this.timeout=void 0,this.onSuccess(void 0)}),t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return void 0!==this.timeout}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){void 0!==this.timeout&&(this.timeout.dispose(),this.timeout=void 0)}};tn.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,nn.RAL)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};let on=!1;tn.setTestMode=function(){on=!0},tn.clearTestMode=function(){on=!1};class rn{constructor(e=15){this.yieldAfter=!0===on?Math.max(e,2):Math.max(e,15),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){const e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=2*this.total}}return!1}}tn.map=async function(e,t,n,i){if(0===e.length)return[];const o=new Array(e.length),r=new rn(i?.yieldAfter);function s(n){r.start();for(let s=n;s<e.length;s++)if(o[s]=t(e[s]),r.shouldYield())return i?.yieldCallback&&i.yieldCallback(),s+1;return-1}let a=s(0);for(;-1!==a&&(void 0===n||!n.isCancellationRequested);)a=await new Promise((e=>{(0,nn.RAL)().timer.setImmediate((()=>{e(s(a))}))}));return o},tn.mapAsync=async function(e,t,n,i){if(0===e.length)return[];const o=new Array(e.length),r=new rn(i?.yieldAfter);async function s(s){r.start();for(let a=s;a<e.length;a++)if(o[a]=await t(e[a],n),r.shouldYield())return i?.yieldCallback&&i.yieldCallback(),a+1;return-1}let a=await s(0);for(;-1!==a&&(void 0===n||!n.isCancellationRequested);)a=await new Promise((e=>{(0,nn.RAL)().timer.setImmediate((()=>{e(s(a))}))}));return o},tn.forEach=async function(e,t,n,i){if(0===e.length)return;const o=new rn(i?.yieldAfter);function r(n){o.start();for(let r=n;r<e.length;r++)if(t(e[r]),o.shouldYield())return i?.yieldCallback&&i.yieldCallback(),r+1;return-1}let s=r(0);for(;-1!==s&&(void 0===n||!n.isCancellationRequested);)s=await new Promise((e=>{(0,nn.RAL)().timer.setImmediate((()=>{e(r(s))}))}))};var sn={};Object.defineProperty(sn,"__esModule",{value:!0});const an=s;class cn extends an.CompletionItem{constructor(e){super(e)}}sn.default=cn;var un={};Object.defineProperty(un,"__esModule",{value:!0});const ln=s;class dn extends ln.CodeLens{constructor(e){super(e)}}un.default=dn;var gn={};Object.defineProperty(gn,"__esModule",{value:!0});const hn=s;class pn extends hn.DocumentLink{constructor(e,t){super(e,t)}}gn.default=pn;var mn={};Object.defineProperty(mn,"__esModule",{value:!0});const fn=s;class vn extends fn.CodeAction{constructor(e,t){super(e),this.data=t}}mn.default=vn;var yn={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProtocolDiagnostic=e.DiagnosticCode=void 0;const t=s,n=Qt;(e.DiagnosticCode||(e.DiagnosticCode={})).is=function(e){const t=e;return null!=t&&(n.number(t.value)||n.string(t.value))&&n.string(t.target)};class i extends t.Diagnostic{constructor(e,t,n,i){super(e,t,n),this.data=i,this.hasDiagnosticCode=!1}}e.ProtocolDiagnostic=i}(yn);var Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});const Dn=s;class Rn extends Dn.CallHierarchyItem{constructor(e,t,n,i,o,r,s){super(e,t,n,i,o,r),void 0!==s&&(this.data=s)}}Cn.default=Rn;var bn={};Object.defineProperty(bn,"__esModule",{value:!0});const Sn=s;class Tn extends Sn.TypeHierarchyItem{constructor(e,t,n,i,o,r,s){super(e,t,n,i,o,r),void 0!==s&&(this.data=s)}}bn.default=Tn;var wn={};Object.defineProperty(wn,"__esModule",{value:!0});const _n=s;class kn extends _n.SymbolInformation{constructor(e,t,n,i,o){const r=!(i instanceof _n.Uri);super(e,t,n,r?i:new _n.Location(i,new _n.Range(0,0,0,0))),this.hasRange=r,void 0!==o&&(this.data=o)}}wn.default=kn;var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0});const xn=s;class qn extends xn.InlayHint{constructor(e,t,n){super(e,t,n)}}Pn.default=qn,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.createConverter=void 0;const Fn=s,On=c,En=Qt,Mn=tn,Nn=sn,In=un,Ln=gn,jn=mn,An=yn,Hn=Cn,Kn=bn,Wn=wn,Un=Pn;var zn;!function(e){e.is=function(e){const t=e;return t&&!!t.inserting&&!!t.replacing}}(zn||(zn={})),Xt.createConverter=function(e){const t=e||(e=>e.toString());function n(e){return t(e)}function i(e){return{uri:t(e.uri)}}function o(e){return{uri:t(e.uri),languageId:e.languageId,version:e.version,text:e.getText()}}function r(e){switch(e){case Fn.TextDocumentSaveReason.Manual:return On.TextDocumentSaveReason.Manual;case Fn.TextDocumentSaveReason.AfterDelay:return On.TextDocumentSaveReason.AfterDelay;case Fn.TextDocumentSaveReason.FocusOut:return On.TextDocumentSaveReason.FocusOut}return On.TextDocumentSaveReason.Manual}function s(e){switch(e){case Fn.CompletionTriggerKind.TriggerCharacter:return On.CompletionTriggerKind.TriggerCharacter;case Fn.CompletionTriggerKind.TriggerForIncompleteCompletions:return On.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return On.CompletionTriggerKind.Invoked}}function a(e){switch(e){case Fn.SignatureHelpTriggerKind.Invoke:return On.SignatureHelpTriggerKind.Invoked;case Fn.SignatureHelpTriggerKind.TriggerCharacter:return On.SignatureHelpTriggerKind.TriggerCharacter;case Fn.SignatureHelpTriggerKind.ContentChange:return On.SignatureHelpTriggerKind.ContentChange}}function c(e){return{label:e.label}}function u(e){return{label:e.label,parameters:(t=e.parameters,t.map(c))};var t}function l(e){return{line:e.line,character:e.character}}function d(e){return null==e?e:{line:e.line>On.uinteger.MAX_VALUE?On.uinteger.MAX_VALUE:e.line,character:e.character>On.uinteger.MAX_VALUE?On.uinteger.MAX_VALUE:e.character}}function g(e){return null==e?e:{start:d(e.start),end:d(e.end)}}function h(e){return null==e?e:On.Location.create(n(e.uri),g(e.range))}function p(e){switch(e){case Fn.DiagnosticSeverity.Error:return On.DiagnosticSeverity.Error;case Fn.DiagnosticSeverity.Warning:return On.DiagnosticSeverity.Warning;case Fn.DiagnosticSeverity.Information:return On.DiagnosticSeverity.Information;case Fn.DiagnosticSeverity.Hint:return On.DiagnosticSeverity.Hint}}function m(e){switch(e){case Fn.DiagnosticTag.Unnecessary:return On.DiagnosticTag.Unnecessary;case Fn.DiagnosticTag.Deprecated:return On.DiagnosticTag.Deprecated;default:return}}function f(e){return{message:e.message,location:h(e.location)}}function v(e){const t=On.Diagnostic.create(g(e.range),e.message),i=e instanceof An.ProtocolDiagnostic?e:void 0;void 0!==i&&void 0!==i.data&&(t.data=i.data);const o=function(e){if(null!=e)return En.number(e)||En.string(e)?e:{value:e.value,target:n(e.target)}}(e.code);return An.DiagnosticCode.is(o)?void 0!==i&&i.hasDiagnosticCode?t.code=o:(t.code=o.value,t.codeDescription={href:o.target}):t.code=o,En.number(e.severity)&&(t.severity=p(e.severity)),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let n of e){let e=m(n);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(f)),e.source&&(t.source=e.source),t}function y(e,t){return null==e?e:Mn.map(e,v,t)}function C(e){if(e===Fn.CompletionItemTag.Deprecated)return On.CompletionItemTag.Deprecated}function D(e){return{range:g(e.range),newText:e.newText}}function R(e){return null==e?e:e.map(D)}function b(e){return e<=Fn.SymbolKind.TypeParameter?e+1:On.SymbolKind.Property}function S(e){return e}function T(e){return e.map(S)}function w(e){let t=On.Command.create(e.title,e.command);return e.arguments&&(t.arguments=e.arguments),t}function _(e){const t=On.InlayHintLabelPart.create(e.value);return void 0!==e.location&&(t.location=h(e.location)),void 0!==e.command&&(t.command=w(e.command)),void 0!==e.tooltip&&(t.tooltip=k(e.tooltip)),t}function k(e){if("string"==typeof e)return e;return{kind:On.MarkupKind.Markdown,value:e.value}}return{asUri:n,asTextDocumentIdentifier:i,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:function(e){return{uri:t(e.uri),version:e.version}},asOpenTextDocumentParams:function(e){return{textDocument:o(e)}},asChangeTextDocumentParams:function(e,n,i){if(function(e){const t=e;return!!t.uri&&!!t.version}(e)){return{textDocument:{uri:t(e.uri),version:e.version},contentChanges:[{text:e.getText()}]}}if(function(e){const t=e;return!!t.document&&!!t.contentChanges}(e)){const o=i,r={textDocument:{uri:t(n),version:o},contentChanges:e.contentChanges.map((e=>{const t=e.range;return{range:{start:{line:t.start.line,character:t.start.character},end:{line:t.end.line,character:t.end.character}},rangeLength:e.rangeLength,text:e.text}}))};return r}throw Error("Unsupported text document change parameter")},asCloseTextDocumentParams:function(e){return{textDocument:i(e)}},asSaveTextDocumentParams:function(e,t=!1){let n={textDocument:i(e)};return t&&(n.text=e.getText()),n},asWillSaveTextDocumentParams:function(e){return{textDocument:i(e.document),reason:r(e.reason)}},asDidCreateFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asDidRenameFilesParams:function(e){return{files:e.files.map((e=>({oldUri:t(e.oldUri),newUri:t(e.newUri)})))}},asDidDeleteFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asWillCreateFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asWillRenameFilesParams:function(e){return{files:e.files.map((e=>({oldUri:t(e.oldUri),newUri:t(e.newUri)})))}},asWillDeleteFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asTextDocumentPositionParams:function(e,t){return{textDocument:i(e),position:l(t)}},asCompletionParams:function(e,t,n){return{textDocument:i(e),position:l(t),context:{triggerKind:s(n.triggerKind),triggerCharacter:n.triggerCharacter}}},asSignatureHelpParams:function(e,t,n){return{textDocument:i(e),position:l(t),context:{isRetrigger:n.isRetrigger,triggerCharacter:n.triggerCharacter,triggerKind:a(n.triggerKind),activeSignatureHelp:(o=n.activeSignatureHelp,void 0===o?o:{signatures:(r=o.signatures,r.map(u)),activeSignature:o.activeSignature,activeParameter:o.activeParameter})}};var o,r},asWorkerPosition:l,asRange:g,asPosition:d,asPositions:function(e,t){return Mn.map(e,d,t)},asLocation:h,asDiagnosticSeverity:p,asDiagnosticTag:m,asDiagnostic:v,asDiagnostics:y,asCompletionItem:function(e,t=!1){let n,i;En.string(e.label)?n=e.label:(n=e.label.label,!t||void 0===e.label.detail&&void 0===e.label.description||(i={detail:e.label.detail,description:e.label.description}));let o={label:n};void 0!==i&&(o.labelDetails=i);let r=e instanceof Nn.default?e:void 0;var s,a;e.detail&&(o.detail=e.detail),e.documentation&&(r&&"$string"!==r.documentationFormat?o.documentation=function(e,t){switch(e){case"$string":return t;case On.MarkupKind.PlainText:return{kind:e,value:t};case On.MarkupKind.Markdown:return{kind:e,value:t.value};default:return`Unsupported Markup content received. Kind is: ${e}`}}(r.documentationFormat,e.documentation):o.documentation=e.documentation),e.filterText&&(o.filterText=e.filterText),function(e,t){let n,i,o=On.InsertTextFormat.PlainText;t.textEdit?(n=t.textEdit.newText,i=t.textEdit.range):t.insertText instanceof Fn.SnippetString?(o=On.InsertTextFormat.Snippet,n=t.insertText.value):n=t.insertText;t.range&&(i=t.range);e.insertTextFormat=o,t.fromEdit&&void 0!==n&&void 0!==i?e.textEdit=function(e,t){return zn.is(t)?On.InsertReplaceEdit.create(e,g(t.inserting),g(t.replacing)):{newText:e,range:g(t)}}(n,i):e.insertText=n}(o,e),En.number(e.kind)&&(o.kind=(s=e.kind,void 0!==(a=r&&r.originalItemKind)?a:s+1)),e.sortText&&(o.sortText=e.sortText),e.additionalTextEdits&&(o.additionalTextEdits=R(e.additionalTextEdits)),e.commitCharacters&&(o.commitCharacters=e.commitCharacters.slice()),e.command&&(o.command=w(e.command)),!0!==e.preselect&&!1!==e.preselect||(o.preselect=e.preselect);const c=function(e){if(void 0===e)return e;const t=[];for(let n of e){const e=C(n);void 0!==e&&t.push(e)}return t}(e.tags);if(r){if(void 0!==r.data&&(o.data=r.data),!0===r.deprecated||!1===r.deprecated){if(!0===r.deprecated&&void 0!==c&&c.length>0){const e=c.indexOf(Fn.CompletionItemTag.Deprecated);-1!==e&&c.splice(e,1)}o.deprecated=r.deprecated}void 0!==r.insertTextMode&&(o.insertTextMode=r.insertTextMode)}return void 0!==c&&c.length>0&&(o.tags=c),void 0===o.insertTextMode&&!0===e.keepWhitespace&&(o.insertTextMode=On.InsertTextMode.adjustIndentation),o},asTextEdit:D,asSymbolKind:b,asSymbolTag:S,asSymbolTags:T,asReferenceParams:function(e,t,n){return{textDocument:i(e),position:l(t),context:{includeDeclaration:n.includeDeclaration}}},asCodeAction:async function(e,t){let n=On.CodeAction.create(e.title);if(e instanceof jn.default&&void 0!==e.data&&(n.data=e.data),void 0!==e.kind&&(n.kind=function(e){if(null==e)return;return e.value}(e.kind)),void 0!==e.diagnostics&&(n.diagnostics=await y(e.diagnostics,t)),void 0!==e.edit)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return void 0!==e.command&&(n.command=w(e.command)),void 0!==e.isPreferred&&(n.isPreferred=e.isPreferred),void 0!==e.disabled&&(n.disabled={reason:e.disabled.reason}),n},asCodeActionContext:async function(e,t){if(null==e)return e;let n;return e.only&&En.string(e.only.value)&&(n=[e.only.value]),On.CodeActionContext.create(await y(e.diagnostics,t),n,function(e){switch(e){case Fn.CodeActionTriggerKind.Invoke:return On.CodeActionTriggerKind.Invoked;case Fn.CodeActionTriggerKind.Automatic:return On.CodeActionTriggerKind.Automatic;default:return}}(e.triggerKind))},asInlineValueContext:function(e){return null==e?e:On.InlineValueContext.create(e.frameId,g(e.stoppedLocation))},asCommand:w,asCodeLens:function(e){let t=On.CodeLens.create(g(e.range));return e.command&&(t.command=w(e.command)),e instanceof In.default&&e.data&&(t.data=e.data),t},asFormattingOptions:function(e,t){const n={tabSize:e.tabSize,insertSpaces:e.insertSpaces};return t.trimTrailingWhitespace&&(n.trimTrailingWhitespace=!0),t.trimFinalNewlines&&(n.trimFinalNewlines=!0),t.insertFinalNewline&&(n.insertFinalNewline=!0),n},asDocumentSymbolParams:function(e){return{textDocument:i(e)}},asCodeLensParams:function(e){return{textDocument:i(e)}},asDocumentLink:function(e){let t=On.DocumentLink.create(g(e.range));e.target&&(t.target=n(e.target)),void 0!==e.tooltip&&(t.tooltip=e.tooltip);let i=e instanceof Ln.default?e:void 0;return i&&i.data&&(t.data=i.data),t},asDocumentLinkParams:function(e){return{textDocument:i(e)}},asCallHierarchyItem:function(e){const t={name:e.name,kind:b(e.kind),uri:n(e.uri),range:g(e.range),selectionRange:g(e.selectionRange)};return void 0!==e.detail&&e.detail.length>0&&(t.detail=e.detail),void 0!==e.tags&&(t.tags=T(e.tags)),e instanceof Hn.default&&void 0!==e.data&&(t.data=e.data),t},asTypeHierarchyItem:function(e){const t={name:e.name,kind:b(e.kind),uri:n(e.uri),range:g(e.range),selectionRange:g(e.selectionRange)};return void 0!==e.detail&&e.detail.length>0&&(t.detail=e.detail),void 0!==e.tags&&(t.tags=T(e.tags)),e instanceof Kn.default&&void 0!==e.data&&(t.data=e.data),t},asInlayHint:function(e){const t="string"==typeof e.label?e.label:e.label.map(_),n=On.InlayHint.create(d(e.position),t);return void 0!==e.kind&&(n.kind=e.kind),void 0!==e.textEdits&&(n.textEdits=R(e.textEdits)),void 0!==e.tooltip&&(n.tooltip=k(e.tooltip)),void 0!==e.paddingLeft&&(n.paddingLeft=e.paddingLeft),void 0!==e.paddingRight&&(n.paddingRight=e.paddingRight),e instanceof Un.default&&void 0!==e.data&&(n.data=e.data),n},asWorkspaceSymbol:function(e){const n=e instanceof Wn.default?{name:e.name,kind:b(e.kind),location:e.hasRange?h(e.location):{uri:t(e.location.uri)},data:e.data}:{name:e.name,kind:b(e.kind),location:h(e.location)};return void 0!==e.tags&&(n.tags=T(e.tags)),""!==e.containerName&&(n.containerName=e.containerName),n}}};var $n={};Object.defineProperty($n,"__esModule",{value:!0}),$n.createConverter=void 0;const Vn=s,Bn=c,Jn=Qt,Xn=tn,Qn=sn,Gn=un,Yn=gn,Zn=mn,ei=yn,ti=Cn,ni=bn,ii=wn,oi=Pn,ri=c;var si;!function(e){e.is=function(e){let t=e;return t&&Jn.string(t.language)&&Jn.string(t.value)}}(si||(si={})),$n.createConverter=function(e,t,n){const i=e||(e=>Vn.Uri.parse(e));function o(e){return i(e)}function r(e){let t=new ei.ProtocolDiagnostic(c(e.range),e.message,l(e.severity),e.data);if(void 0!==e.code)if("string"==typeof e.code||"number"==typeof e.code)Bn.CodeDescription.is(e.codeDescription)?t.code={value:e.code,target:o(e.codeDescription.href)}:t.code=e.code;else if(ei.DiagnosticCode.is(e.code)){t.hasDiagnosticCode=!0;const n=e.code;t.code={value:n.value,target:o(n.target)}}return e.source&&(t.source=e.source),e.relatedInformation&&(t.relatedInformation=function(e){const t=new Array(e.length);for(let n=0;n<e.length;n++){const i=e[n];t[n]=new Vn.DiagnosticRelatedInformation(b(i.location),i.message)}return t}(e.relatedInformation)),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let n of e){let e=s(n);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),t}function s(e){switch(e){case Bn.DiagnosticTag.Unnecessary:return Vn.DiagnosticTag.Unnecessary;case Bn.DiagnosticTag.Deprecated:return Vn.DiagnosticTag.Deprecated;default:return}}function a(e){return e?new Vn.Position(e.line,e.character):void 0}function c(e){return e?new Vn.Range(e.start.line,e.start.character,e.end.line,e.end.character):void 0}async function u(e,t){return Xn.map(e,(e=>new Vn.Range(e.start.line,e.start.character,e.end.line,e.end.character)),t)}function l(e){if(null==e)return Vn.DiagnosticSeverity.Error;switch(e){case Bn.DiagnosticSeverity.Error:return Vn.DiagnosticSeverity.Error;case Bn.DiagnosticSeverity.Warning:return Vn.DiagnosticSeverity.Warning;case Bn.DiagnosticSeverity.Information:return Vn.DiagnosticSeverity.Information;case Bn.DiagnosticSeverity.Hint:return Vn.DiagnosticSeverity.Hint}return Vn.DiagnosticSeverity.Error}function d(e){if(Jn.string(e))return e;switch(e.kind){case Bn.MarkupKind.Markdown:return g(e.value);case Bn.MarkupKind.PlainText:return e.value;default:return`Unsupported Markup content received. Kind is: ${e.kind}`}}function g(e){let i;if(void 0===e||"string"==typeof e)i=new Vn.MarkdownString(e);else switch(e.kind){case Bn.MarkupKind.Markdown:i=new Vn.MarkdownString(e.value);break;case Bn.MarkupKind.PlainText:i=new Vn.MarkdownString,i.appendText(e.value);break;default:i=new Vn.MarkdownString,i.appendText(`Unsupported Markup content received. Kind is: ${e.kind}`)}return i.isTrusted=t,i.supportHtml=n,i}function h(e){if(e===Bn.CompletionItemTag.Deprecated)return Vn.CompletionItemTag.Deprecated}function p(e,t,n,i,o,r){const s=function(e){if(null==e)return[];const t=[];for(const n of e){const e=h(n);void 0!==e&&t.push(e)}return t}(e.tags),a=function(e){return Bn.CompletionItemLabelDetails.is(e.labelDetails)?{label:e.label,detail:e.labelDetails.detail,description:e.labelDetails.description}:e.label}(e),u=new Qn.default(a);e.detail&&(u.detail=e.detail),e.documentation&&(u.documentation=d(e.documentation),u.documentationFormat=Jn.string(e.documentation)?"$string":e.documentation.kind),e.filterText&&(u.filterText=e.filterText);const l=function(e,t,n){const i=e.insertTextFormat??n;if(void 0!==e.textEdit||void 0!==t){const[n,r]=void 0!==e.textEdit?(o=e.textEdit,Bn.InsertReplaceEdit.is(o)?[{inserting:c(o.insert),replacing:c(o.replace)},o.newText]:[c(o.range),o.newText]):[t,e.textEditText??e.label];return i===Bn.InsertTextFormat.Snippet?{text:new Vn.SnippetString(r),range:n,fromEdit:!0}:{text:r,range:n,fromEdit:!0}}return e.insertText?i===Bn.InsertTextFormat.Snippet?{text:new Vn.SnippetString(e.insertText),fromEdit:!1}:{text:e.insertText,fromEdit:!1}:void 0;var o}(e,n,o);if(l&&(u.insertText=l.text,u.range=l.range,u.fromEdit=l.fromEdit),Jn.number(e.kind)){let[t,n]=(g=e.kind,Bn.CompletionItemKind.Text<=g&&g<=Bn.CompletionItemKind.TypeParameter?[g-1,void 0]:[Vn.CompletionItemKind.Text,g]);u.kind=t,n&&(u.originalItemKind=n)}var g;e.sortText&&(u.sortText=e.sortText),e.additionalTextEdits&&(u.additionalTextEdits=v(e.additionalTextEdits));const p=void 0!==e.commitCharacters?Jn.stringArray(e.commitCharacters)?e.commitCharacters:void 0:t;p&&(u.commitCharacters=p.slice()),e.command&&(u.command=E(e.command)),!0!==e.deprecated&&!1!==e.deprecated||(u.deprecated=e.deprecated,!0===e.deprecated&&s.push(Vn.CompletionItemTag.Deprecated)),!0!==e.preselect&&!1!==e.preselect||(u.preselect=e.preselect);const m=e.data??r;void 0!==m&&(u.data=m),s.length>0&&(u.tags=s);const f=e.insertTextMode??i;return void 0!==f&&(u.insertTextMode=f,f===Bn.InsertTextMode.asIs&&(u.keepWhitespace=!0)),u}function m(e){if(e)return new Vn.TextEdit(c(e.range),e.newText)}async function f(e,t){if(e)return Xn.map(e,m,t)}function v(e){if(!e)return;const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=m(e[n]);return t}async function y(e,t){return Xn.mapAsync(e,C,t)}async function C(e,t){let n=new Vn.SignatureInformation(e.label);return void 0!==e.documentation&&(n.documentation=d(e.documentation)),void 0!==e.parameters&&(n.parameters=await D(e.parameters,t)),void 0!==e.activeParameter&&(n.activeParameter=e.activeParameter),n}function D(e,t){return Xn.map(e,R,t)}function R(e){let t=new Vn.ParameterInformation(e.label);return e.documentation&&(t.documentation=d(e.documentation)),t}function b(e){return e?new Vn.Location(i(e.uri),c(e.range)):void 0}function S(e){if(!e)return;let t={targetUri:i(e.targetUri),targetRange:c(e.targetRange),originSelectionRange:c(e.originSelectionRange),targetSelectionRange:c(e.targetSelectionRange)};if(!t.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return t}async function T(e,t){if(e){if(Jn.array(e)){if(0===e.length)return[];if(Bn.LocationLink.is(e[0])){const n=e;return Xn.map(n,S,t)}{const n=e;return Xn.map(n,b,t)}}return Bn.LocationLink.is(e)?[S(e)]:b(e)}}function w(e){let t=new Vn.DocumentHighlight(c(e.range));return Jn.number(e.kind)&&(t.kind=_(e.kind)),t}function _(e){switch(e){case Bn.DocumentHighlightKind.Text:return Vn.DocumentHighlightKind.Text;case Bn.DocumentHighlightKind.Read:return Vn.DocumentHighlightKind.Read;case Bn.DocumentHighlightKind.Write:return Vn.DocumentHighlightKind.Write}return Vn.DocumentHighlightKind.Text}function k(e){return e<=Bn.SymbolKind.TypeParameter?e-1:Vn.SymbolKind.Property}function P(e){if(e===Bn.SymbolTag.Deprecated)return Vn.SymbolTag.Deprecated}function x(e){if(null==e)return;const t=[];for(const n of e){const e=P(n);void 0!==e&&t.push(e)}return 0===t.length?void 0:t}function q(e){const t=e.data,n=e.location,o=void 0===n.range||void 0!==t?new ii.default(e.name,k(e.kind),e.containerName??"",void 0===n.range?i(n.uri):new Vn.Location(i(e.location.uri),c(n.range)),t):new Vn.SymbolInformation(e.name,k(e.kind),e.containerName??"",new Vn.Location(i(e.location.uri),c(n.range)));return O(o,e),o}function F(e){let t=new Vn.DocumentSymbol(e.name,e.detail||"",k(e.kind),c(e.range),c(e.selectionRange));if(O(t,e),void 0!==e.children&&e.children.length>0){let n=[];for(let t of e.children)n.push(F(t));t.children=n}return t}function O(e,t){e.tags=x(t.tags),t.deprecated&&(e.tags?e.tags.includes(Vn.SymbolTag.Deprecated)||(e.tags=e.tags.concat(Vn.SymbolTag.Deprecated)):e.tags=[Vn.SymbolTag.Deprecated])}function E(e){let t={title:e.title,command:e.command};return e.arguments&&(t.arguments=e.arguments),t}const M=new Map;function N(e){if(null==e)return;let t=M.get(e);if(t)return t;let n=e.split(".");t=Vn.CodeActionKind.Empty;for(let i of n)t=t.append(i);return t}async function I(e,t){if(null==e)return;let n=new Zn.default(e.title,e.data);return void 0!==e.kind&&(n.kind=N(e.kind)),void 0!==e.diagnostics&&(n.diagnostics=function(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=r(e[n]);return t}(e.diagnostics)),void 0!==e.edit&&(n.edit=await j(e.edit,t)),void 0!==e.command&&(n.command=E(e.command)),void 0!==e.isPreferred&&(n.isPreferred=e.isPreferred),void 0!==e.disabled&&(n.disabled={reason:e.disabled.reason}),n}function L(e){if(!e)return;let t=new Gn.default(c(e.range));return e.command&&(t.command=E(e.command)),void 0!==e.data&&null!==e.data&&(t.data=e.data),t}async function j(e,t){if(!e)return;const n=new Map;if(void 0!==e.changeAnnotations){const i=e.changeAnnotations;await Xn.forEach(Object.keys(i),(e=>{const t=function(e){if(void 0===e)return;return{label:e.label,needsConfirmation:!!e.needsConfirmation,description:e.description}}(i[e]);n.set(e,t)}),t)}const o=e=>void 0===e?void 0:n.get(e),r=new Vn.WorkspaceEdit;if(e.documentChanges){const n=e.documentChanges;await Xn.forEach(n,(e=>{if(Bn.CreateFile.is(e))r.createFile(i(e.uri),e.options,o(e.annotationId));else if(Bn.RenameFile.is(e))r.renameFile(i(e.oldUri),i(e.newUri),e.options,o(e.annotationId));else if(Bn.DeleteFile.is(e))r.deleteFile(i(e.uri),e.options,o(e.annotationId));else{if(!Bn.TextDocumentEdit.is(e))throw new Error(`Unknown workspace edit change received:\n${JSON.stringify(e,void 0,4)}`);{const t=i(e.textDocument.uri);for(const n of e.edits)Bn.AnnotatedTextEdit.is(n)?r.replace(t,c(n.range),n.newText,o(n.annotationId)):r.replace(t,c(n.range),n.newText)}}}),t)}else if(e.changes){const n=e.changes;await Xn.forEach(Object.keys(n),(e=>{r.set(i(e),v(n[e]))}),t)}return r}function A(e){let t=c(e.range),n=e.target?o(e.target):void 0,i=new Yn.default(t,n);return void 0!==e.tooltip&&(i.tooltip=e.tooltip),void 0!==e.data&&null!==e.data&&(i.data=e.data),i}function H(e){return new Vn.Color(e.red,e.green,e.blue,e.alpha)}function K(e){return new Vn.ColorInformation(c(e.range),H(e.color))}function W(e){let t=new Vn.ColorPresentation(e.label);return t.additionalTextEdits=v(e.additionalTextEdits),e.textEdit&&(t.textEdit=m(e.textEdit)),t}function U(e){if(e)switch(e){case Bn.FoldingRangeKind.Comment:return Vn.FoldingRangeKind.Comment;case Bn.FoldingRangeKind.Imports:return Vn.FoldingRangeKind.Imports;case Bn.FoldingRangeKind.Region:return Vn.FoldingRangeKind.Region}}function z(e){return new Vn.FoldingRange(e.startLine,e.endLine,U(e.kind))}function $(e){return new Vn.SelectionRange(c(e.range),e.parent?$(e.parent):void 0)}function V(e){return Bn.InlineValueText.is(e)?new Vn.InlineValueText(c(e.range),e.text):Bn.InlineValueVariableLookup.is(e)?new Vn.InlineValueVariableLookup(c(e.range),e.variableName,e.caseSensitiveLookup):new Vn.InlineValueEvaluatableExpression(c(e.range),e.expression)}async function B(e,t){const n="string"==typeof e.label?e.label:await Xn.map(e.label,J,t),i=new oi.default(a(e.position),n);return void 0!==e.kind&&(i.kind=e.kind),void 0!==e.textEdits&&(i.textEdits=await f(e.textEdits,t)),void 0!==e.tooltip&&(i.tooltip=X(e.tooltip)),void 0!==e.paddingLeft&&(i.paddingLeft=e.paddingLeft),void 0!==e.paddingRight&&(i.paddingRight=e.paddingRight),void 0!==e.data&&(i.data=e.data),i}function J(e){const t=new Vn.InlayHintLabelPart(e.value);return void 0!==e.location&&(t.location=b(e.location)),void 0!==e.tooltip&&(t.tooltip=X(e.tooltip)),void 0!==e.command&&(t.command=E(e.command)),t}function X(e){return"string"==typeof e?e:g(e)}function Q(e){if(null===e)return;const t=new ti.default(k(e.kind),e.name,e.detail||"",o(e.uri),c(e.range),c(e.selectionRange),e.data);return void 0!==e.tags&&(t.tags=x(e.tags)),t}async function G(e,t){return new Vn.CallHierarchyIncomingCall(Q(e.from),await u(e.fromRanges,t))}async function Y(e,t){return new Vn.CallHierarchyOutgoingCall(Q(e.to),await u(e.fromRanges,t))}function Z(e){return new Vn.SemanticTokensEdit(e.start,e.deleteCount,void 0!==e.data?new Uint32Array(e.data):void 0)}function ee(e){if(null===e)return;let t=new ni.default(k(e.kind),e.name,e.detail||"",o(e.uri),c(e.range),c(e.selectionRange),e.data);return void 0!==e.tags&&(t.tags=x(e.tags)),t}return M.set(Bn.CodeActionKind.Empty,Vn.CodeActionKind.Empty),M.set(Bn.CodeActionKind.QuickFix,Vn.CodeActionKind.QuickFix),M.set(Bn.CodeActionKind.Refactor,Vn.CodeActionKind.Refactor),M.set(Bn.CodeActionKind.RefactorExtract,Vn.CodeActionKind.RefactorExtract),M.set(Bn.CodeActionKind.RefactorInline,Vn.CodeActionKind.RefactorInline),M.set(Bn.CodeActionKind.RefactorRewrite,Vn.CodeActionKind.RefactorRewrite),M.set(Bn.CodeActionKind.Source,Vn.CodeActionKind.Source),M.set(Bn.CodeActionKind.SourceOrganizeImports,Vn.CodeActionKind.SourceOrganizeImports),{asUri:o,asDocumentSelector:function(e){const t=[];for(const n of e)if("string"==typeof n)t.push(n);else if(ri.NotebookCellTextDocumentFilter.is(n))if("string"==typeof n.notebook)t.push({notebookType:n.notebook,language:n.language});else{const e=n.notebook.notebookType??"*";t.push({notebookType:e,scheme:n.notebook.scheme,pattern:n.notebook.pattern,language:n.language})}else ri.TextDocumentFilter.is(n)&&t.push({language:n.language,scheme:n.scheme,pattern:n.pattern});return t},asDiagnostics:async function(e,t){return Xn.map(e,r,t)},asDiagnostic:r,asRange:c,asRanges:u,asPosition:a,asDiagnosticSeverity:l,asDiagnosticTag:s,asHover:function(e){if(e)return new Vn.Hover(function(e){if(Jn.string(e))return g(e);if(si.is(e))return g().appendCodeblock(e.value,e.language);if(Array.isArray(e)){let t=[];for(let n of e){let e=g();si.is(n)?e.appendCodeblock(n.value,n.language):e.appendMarkdown(n),t.push(e)}return t}return g(e)}(e.contents),c(e.range))},asCompletionResult:async function(e,t,n){if(!e)return;if(Array.isArray(e))return Xn.map(e,(e=>p(e,t)),n);const i=e,{defaultRange:o,commitCharacters:r}=function(e,t){const n=e.itemDefaults?.editRange,i=e.itemDefaults?.commitCharacters??t;return Bn.Range.is(n)?{defaultRange:c(n),commitCharacters:i}:void 0!==n?{defaultRange:{inserting:c(n.insert),replacing:c(n.replace)},commitCharacters:i}:{defaultRange:void 0,commitCharacters:i}}(i,t),s=await Xn.map(i.items,(e=>p(e,r,o,i.itemDefaults?.insertTextMode,i.itemDefaults?.insertTextFormat,i.itemDefaults?.data)),n);return new Vn.CompletionList(s,i.isIncomplete)},asCompletionItem:p,asTextEdit:m,asTextEdits:f,asSignatureHelp:async function(e,t){if(!e)return;let n=new Vn.SignatureHelp;return Jn.number(e.activeSignature)?n.activeSignature=e.activeSignature:n.activeSignature=0,Jn.number(e.activeParameter)?n.activeParameter=e.activeParameter:n.activeParameter=0,e.signatures&&(n.signatures=await y(e.signatures,t)),n},asSignatureInformations:y,asSignatureInformation:C,asParameterInformations:D,asParameterInformation:R,asDeclarationResult:async function(e,t){if(e)return T(e,t)},asDefinitionResult:async function(e,t){if(e)return T(e,t)},asLocation:b,asReferences:async function(e,t){if(e)return Xn.map(e,b,t)},asDocumentHighlights:async function(e,t){if(e)return Xn.map(e,w,t)},asDocumentHighlight:w,asDocumentHighlightKind:_,asSymbolKind:k,asSymbolTag:P,asSymbolTags:x,asSymbolInformations:async function(e,t){if(e)return Xn.map(e,q,t)},asSymbolInformation:q,asDocumentSymbols:async function(e,t){if(null!=e)return Xn.map(e,F,t)},asDocumentSymbol:F,asCommand:E,asCommands:async function(e,t){if(e)return Xn.map(e,E,t)},asCodeAction:I,asCodeActionKind:N,asCodeActionKinds:function(e){if(null!=e)return e.map((e=>N(e)))},asCodeActionResult:function(e,t){return Xn.mapAsync(e,(async e=>Bn.Command.is(e)?E(e):I(e,t)),t)},asCodeLens:L,asCodeLenses:async function(e,t){if(e)return Xn.map(e,L,t)},asWorkspaceEdit:j,asDocumentLink:A,asDocumentLinks:async function(e,t){if(e)return Xn.map(e,A,t)},asFoldingRangeKind:U,asFoldingRange:z,asFoldingRanges:async function(e,t){if(e)return Xn.map(e,z,t)},asColor:H,asColorInformation:K,asColorInformations:async function(e,t){if(e)return Xn.map(e,K,t)},asColorPresentation:W,asColorPresentations:async function(e,t){if(e)return Xn.map(e,W,t)},asSelectionRange:$,asSelectionRanges:async function(e,t){return Array.isArray(e)?Xn.map(e,$,t):[]},asInlineValue:V,asInlineValues:async function(e,t){return Array.isArray(e)?Xn.map(e,V,t):[]},asInlayHint:B,asInlayHints:async function(e,t){if(Array.isArray(e))return Xn.mapAsync(e,B,t)},asSemanticTokensLegend:function(e){return e},asSemanticTokens:async function(e,t){if(null!=e)return new Vn.SemanticTokens(new Uint32Array(e.data),e.resultId)},asSemanticTokensEdit:Z,asSemanticTokensEdits:async function(e,t){if(null!=e)return new Vn.SemanticTokensEdits(e.edits.map(Z),e.resultId)},asCallHierarchyItem:Q,asCallHierarchyItems:async function(e,t){if(null!==e)return Xn.map(e,Q,t)},asCallHierarchyIncomingCall:G,asCallHierarchyIncomingCalls:async function(e,t){if(null!==e)return Xn.mapAsync(e,G,t)},asCallHierarchyOutgoingCall:Y,asCallHierarchyOutgoingCalls:async function(e,t){if(null!==e)return Xn.mapAsync(e,Y,t)},asLinkedEditingRanges:async function(e,t){if(null!=e)return new Vn.LinkedEditingRanges(await u(e.ranges,t),function(e){if(null==e)return;return new RegExp(e)}(e.wordPattern))},asTypeHierarchyItem:ee,asTypeHierarchyItems:async function(e,t){if(null!==e)return Xn.map(e,ee,t)},asGlobPattern:function(e){if(Jn.string(e))return e;if(Bn.RelativePattern.is(e)){if(Bn.URI.is(e.baseUri))return new Vn.RelativePattern(o(e.baseUri),e.pattern);if(Bn.WorkspaceFolder.is(e.baseUri)){const t=Vn.workspace.getWorkspaceFolder(o(e.baseUri.uri));return void 0!==t?new Vn.RelativePattern(t,e.pattern):void 0}}}}};var ai={};Object.defineProperty(ai,"__esModule",{value:!0}),ai.generateUuid=ai.parse=ai.isUUID=ai.v4=ai.empty=void 0;class ci{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class ui extends ci{constructor(){super([ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),"-",ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),"-","4",ui._randomHex(),ui._randomHex(),ui._randomHex(),"-",ui._oneOf(ui._timeHighBits),ui._randomHex(),ui._randomHex(),ui._randomHex(),"-",ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex(),ui._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return ui._oneOf(ui._chars)}}function li(){return new ui}ui._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],ui._timeHighBits=["8","9","a","b"],ai.empty=new ci("00000000-0000-0000-0000-000000000000"),ai.v4=li;const di=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function gi(e){return di.test(e)}ai.isUUID=gi,ai.parse=function(e){if(!gi(e))throw new Error("invalid uuid");return new ci(e)},ai.generateUuid=function(){return li().asHex()};var hi={};Object.defineProperty(hi,"__esModule",{value:!0}),hi.ProgressPart=void 0;const pi=s,mi=c,fi=Qt;hi.ProgressPart=class{constructor(e,t,n){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(mi.WorkDoneProgress.type,this._token,(e=>{switch(e.kind){case"begin":this.begin(e);break;case"report":this.report(e);break;case"end":this.done(),n&&n(this)}}))}begin(e){this._infinite=void 0===e.percentage,void 0!==this._lspProgressDisposable&&pi.window.withProgress({location:pi.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},(async(t,n)=>{if(void 0!==this._lspProgressDisposable)return this._progress=t,this._cancellationToken=n,this._tokenDisposable=this._cancellationToken.onCancellationRequested((()=>{this._client.sendNotification(mi.WorkDoneProgressCancelNotification.type,{token:this._token})})),this.report(e),new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}))}report(e){if(this._infinite&&fi.string(e.message))void 0!==this._progress&&this._progress.report({message:e.message});else if(fi.number(e.percentage)){const t=Math.max(0,Math.min(e.percentage,100)),n=Math.max(0,t-this._reported);this._reported+=n,void 0!==this._progress&&this._progress.report({message:e.message,increment:n})}}cancel(){this.cleanup(),void 0!==this._reject&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),void 0!==this._resolve&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){void 0!==this._lspProgressDisposable&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),void 0!==this._tokenDisposable&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};var vi={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceFeature=e.TextDocumentLanguageFeature=e.TextDocumentEventFeature=e.DynamicDocumentFeature=e.DynamicFeature=e.StaticFeature=e.ensure=e.LSPCancellationError=void 0;const t=s,n=c,i=Qt,o=ai;class r extends t.CancellationError{constructor(e){super(),this.data=e}}e.LSPCancellationError=r,e.ensure=function(e,t){return void 0===e[t]&&(e[t]={}),e[t]},(e.StaticFeature||(e.StaticFeature={})).is=function(e){const t=e;return null!=t&&i.func(t.fillClientCapabilities)&&i.func(t.initialize)&&i.func(t.getState)&&i.func(t.dispose)&&(void 0===t.fillInitializeParams||i.func(t.fillInitializeParams))},(e.DynamicFeature||(e.DynamicFeature={})).is=function(e){const t=e;return null!=t&&i.func(t.fillClientCapabilities)&&i.func(t.initialize)&&i.func(t.getState)&&i.func(t.dispose)&&(void 0===t.fillInitializeParams||i.func(t.fillInitializeParams))&&i.func(t.register)&&i.func(t.unregister)&&void 0!==t.registrationType};class a{constructor(e){this._client=e}getState(){const e=this.getDocumentSelectors();let n=0;for(const o of e){n++;for(const e of t.workspace.textDocuments)if(t.languages.match(o,e)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}const i=n>0;return{kind:"document",id:this.registrationType.method,registrations:i,matches:!1}}}e.DynamicDocumentFeature=a;e.TextDocumentEventFeature=class extends a{constructor(e,n,i,o,r,s,a){super(e),this._event=n,this._type=i,this._middleware=o,this._createParams=r,this._textDocument=s,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new t.EventEmitter}static textDocumentFilter(e,n){for(const i of e)if(t.languages.match(i,n)>0)return!0;return!1}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event((e=>{this.callback(e).catch((e=>{this._client.error(`Sending document notification ${this._type.method} failed.`,e)}))}))),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){const t=async e=>{const t=this._createParams(e);await this._client.sendNotification(this._type,t),this.notificationSent(this.getTextDocument(e),this._type,t)};if(this.matches(e)){const n=this._middleware();return n?n(e,(e=>t(e))):t(e)}}matches(e){return!this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))&&(!this._selectorFilter||this._selectorFilter(this._selectors.values(),e))}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,n){this._onNotificationSent.fire({textDocument:e,type:t,params:n})}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(const n of this._selectors.values())if(t.languages.match(n,e)>0)return{send:e=>this.callback(e)}}};e.TextDocumentLanguageFeature=class extends a{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(const e of this._registrations.values()){const t=e.data.registerOptions.documentSelector;null!==t&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}dispose(){this._registrations.forEach((e=>{e.disposable.dispose()})),this._registrations.clear()}getRegistration(e,t){if(!t)return[void 0,void 0];if(n.TextDocumentRegistrationOptions.is(t)){const i=n.StaticRegistrationOptions.hasId(t)?t.id:o.generateUuid(),r=t.documentSelector??e;if(r)return[i,Object.assign({},t,{documentSelector:r})]}else if(i.boolean(t)&&!0===t||n.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];const n=i.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[o.generateUuid(),n]}return[void 0,void 0]}getRegistrationOptions(e,t){if(e&&t)return i.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(const n of this._registrations.values()){let i=n.data.registerOptions.documentSelector;if(null!==i&&t.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(i),e)>0)return n.provider}}getAllProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}};e.WorkspaceFeature=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){const e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){const t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}dispose(){this._registrations.forEach((e=>{e.disposable.dispose()})),this._registrations.clear()}getProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}}(vi);var yi={};var Ci="object"==typeof process&&process&&"win32"===process.platform?{sep:"\\"}:{sep:"/"},Di=Ri;function Ri(e,t,n){e instanceof RegExp&&(e=bi(e,n)),t instanceof RegExp&&(t=bi(t,n));var i=Si(e,t,n);return i&&{start:i[0],end:i[1],pre:n.slice(0,i[0]),body:n.slice(i[0]+e.length,i[1]),post:n.slice(i[1]+t.length)}}function bi(e,t){var n=t.match(e);return n?n[0]:null}function Si(e,t,n){var i,o,r,s,a,c=n.indexOf(e),u=n.indexOf(t,c+1),l=c;if(c>=0&&u>0){if(e===t)return[c,u];for(i=[],r=n.length;l>=0&&!a;)l==c?(i.push(l),c=n.indexOf(e,l+1)):1==i.length?a=[i.pop(),u]:((o=i.pop())<r&&(r=o,s=u),u=n.indexOf(t,l+1)),l=c<u&&c>=0?c:u;i.length&&(a=[r,s])}return a}Ri.range=Si;var Ti=Di,wi=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return ji(function(e){return e.split("\\\\").join(_i).split("\\{").join(ki).split("\\}").join(Pi).split("\\,").join(xi).split("\\.").join(qi)}(e),!0).map(Oi)},_i="\0SLASH"+Math.random()+"\0",ki="\0OPEN"+Math.random()+"\0",Pi="\0CLOSE"+Math.random()+"\0",xi="\0COMMA"+Math.random()+"\0",qi="\0PERIOD"+Math.random()+"\0";function Fi(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function Oi(e){return e.split(_i).join("\\").split(ki).join("{").split(Pi).join("}").split(xi).join(",").split(qi).join(".")}function Ei(e){if(!e)return[""];var t=[],n=Ti("{","}",e);if(!n)return e.split(",");var i=n.pre,o=n.body,r=n.post,s=i.split(",");s[s.length-1]+="{"+o+"}";var a=Ei(r);return r.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),t.push.apply(t,s),t}function Mi(e){return"{"+e+"}"}function Ni(e){return/^-?0\d/.test(e)}function Ii(e,t){return e<=t}function Li(e,t){return e>=t}function ji(e,t){var n=[],i=Ti("{","}",e);if(!i)return[e];var o=i.pre,r=i.post.length?ji(i.post,!1):[""];if(/\$$/.test(i.pre))for(var s=0;s<r.length;s++){var a=o+"{"+i.body+"}"+r[s];n.push(a)}else{var c,u,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),g=l||d,h=i.body.indexOf(",")>=0;if(!g&&!h)return i.post.match(/,.*\}/)?ji(e=i.pre+"{"+i.body+Pi+i.post):[e];if(g)c=i.body.split(/\.\./);else if(1===(c=Ei(i.body)).length&&1===(c=ji(c[0],!1).map(Mi)).length)return r.map((function(e){return i.pre+c[0]+e}));if(g){var p=Fi(c[0]),m=Fi(c[1]),f=Math.max(c[0].length,c[1].length),v=3==c.length?Math.abs(Fi(c[2])):1,y=Ii;m<p&&(v*=-1,y=Li);var C=c.some(Ni);u=[];for(var D=p;y(D,m);D+=v){var R;if(d)"\\"===(R=String.fromCharCode(D))&&(R="");else if(R=String(D),C){var b=f-R.length;if(b>0){var S=new Array(b+1).join("0");R=D<0?"-"+S+R.slice(1):S+R}}u.push(R)}}else{u=[];for(var T=0;T<c.length;T++)u.push.apply(u,ji(c[T],!1))}for(T=0;T<u.length;T++)for(s=0;s<r.length;s++){a=o+u[T]+r[s];(!t||g||a)&&n.push(a)}}return n}const Ai=(e,t,n={})=>(Zi(t),!(!n.nocomment&&"#"===t.charAt(0))&&new no(t,n).match(e));var Hi=Ai;const Ki=Ci;Ai.sep=Ki.sep;const Wi=Symbol("globstar **");Ai.GLOBSTAR=Wi;const Ui=wi,zi={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},$i="[^/]",Vi=$i+"*?",Bi=e=>e.split("").reduce(((e,t)=>(e[t]=!0,e)),{}),Ji=Bi("().*{}+?[]^$\\!"),Xi=Bi("[.("),Qi=/\/+/;Ai.filter=(e,t={})=>(n,i,o)=>Ai(n,e,t);const Gi=(e,t={})=>{const n={};return Object.keys(e).forEach((t=>n[t]=e[t])),Object.keys(t).forEach((e=>n[e]=t[e])),n};Ai.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return Ai;const t=Ai,n=(n,i,o)=>t(n,i,Gi(e,o));return(n.Minimatch=class extends t.Minimatch{constructor(t,n){super(t,Gi(e,n))}}).defaults=n=>t.defaults(Gi(e,n)).Minimatch,n.filter=(n,i)=>t.filter(n,Gi(e,i)),n.defaults=n=>t.defaults(Gi(e,n)),n.makeRe=(n,i)=>t.makeRe(n,Gi(e,i)),n.braceExpand=(n,i)=>t.braceExpand(n,Gi(e,i)),n.match=(n,i,o)=>t.match(n,i,Gi(e,o)),n},Ai.braceExpand=(e,t)=>Yi(e,t);const Yi=(e,t={})=>(Zi(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:Ui(e)),Zi=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")},eo=Symbol("subparse");Ai.makeRe=(e,t)=>new no(e,t||{}).makeRe(),Ai.match=(e,t,n={})=>{const i=new no(t,n);return e=e.filter((e=>i.match(e))),i.options.nonull&&!e.length&&e.push(t),e};const to=e=>e.replace(/[[\]\\]/g,"\\$&");class no{constructor(e,t){Zi(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();let n=this.globSet=this.braceExpand();t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,n),n=this.globParts=n.map((e=>e.split(Qi))),this.debug(this.pattern,n),n=n.map(((e,t,n)=>e.map(this.parse,this))),this.debug(this.pattern,n),n=n.filter((e=>-1===e.indexOf(!1))),this.debug(this.pattern,n),this.set=n}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let t=!1,n=0;for(let i=0;i<e.length&&"!"===e.charAt(i);i++)t=!t,n++;n&&(this.pattern=e.slice(n)),this.negate=t}matchOne(e,t,n){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,r=0,s=e.length,a=t.length;o<s&&r<a;o++,r++){this.debug("matchOne loop");var c,u=t[r],l=e[o];if(this.debug(t,u,l),!1===u)return!1;if(u===Wi){this.debug("GLOBSTAR",[t,u,l]);var d=o,g=r+1;if(g===a){for(this.debug("** at the end");o<s;o++)if("."===e[o]||".."===e[o]||!i.dot&&"."===e[o].charAt(0))return!1;return!0}for(;d<s;){var h=e[d];if(this.debug("\nglobstar while",e,d,t,g,h),this.matchOne(e.slice(d),t.slice(g),n))return this.debug("globstar found match!",d,s,h),!0;if("."===h||".."===h||!i.dot&&"."===h.charAt(0)){this.debug("dot detected!",e,d,t,g);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!n||(this.debug("\n>>> no match, partial?",e,d,t,g),d!==s))}if("string"==typeof u?(c=l===u,this.debug("string match",u,l,c)):(c=l.match(u),this.debug("pattern match",u,l,c)),!c)return!1}if(o===s&&r===a)return!0;if(o===s)return n;if(r===a)return o===s-1&&""===e[o];throw new Error("wtf?")}braceExpand(){return Yi(this.pattern,this.options)}parse(e,t){Zi(e);const n=this.options;if("**"===e){if(!n.noglobstar)return Wi;e="*"}if(""===e)return"";let i="",o=!1,r=!1;const s=[],a=[];let c,u,l,d,g=!1,h=-1,p=-1,m="."===e.charAt(0),f=n.dot||m;const v=e=>"."===e.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",y=()=>{if(c){switch(c){case"*":i+=Vi,o=!0;break;case"?":i+=$i,o=!0;break;default:i+="\\"+c}this.debug("clearStateChar %j %j",c,i),c=!1}};for(let b,S=0;S<e.length&&(b=e.charAt(S));S++)if(this.debug("%s\t%s %s %j",e,S,i,b),r){if("/"===b)return!1;Ji[b]&&(i+="\\"),i+=b,r=!1}else switch(b){case"/":return!1;case"\\":if(g&&"-"===e.charAt(S+1)){i+=b;continue}y(),r=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,S,i,b),g){this.debug("  in class"),"!"===b&&S===p+1&&(b="^"),i+=b;continue}this.debug("call clearStateChar %j",c),y(),c=b,n.noext&&y();continue;case"(":{if(g){i+="(";continue}if(!c){i+="\\(";continue}const t={type:c,start:S-1,reStart:i.length,open:zi[c].open,close:zi[c].close};this.debug(this.pattern,"\t",t),s.push(t),i+=t.open,0===t.start&&"!"!==t.type&&(m=!0,i+=v(e.slice(S+1))),this.debug("plType %j %j",c,i),c=!1;continue}case")":{const e=s[s.length-1];if(g||!e){i+="\\)";continue}s.pop(),y(),o=!0,l=e,i+=l.close,"!"===l.type&&a.push(Object.assign(l,{reEnd:i.length}));continue}case"|":{const t=s[s.length-1];if(g||!t){i+="\\|";continue}y(),i+="|",0===t.start&&"!"!==t.type&&(m=!0,i+=v(e.slice(S+1)));continue}case"[":if(y(),g){i+="\\"+b;continue}g=!0,p=S,h=i.length,i+=b;continue;case"]":if(S===p+1||!g){i+="\\"+b;continue}u=e.substring(p+1,S);try{RegExp("["+to(u.replace(/\\([^-\]])/g,"$1"))+"]"),i+=b}catch(R){i=i.substring(0,h)+"(?:$.)"}o=!0,g=!1;continue;default:y(),!Ji[b]||"^"===b&&g||(i+="\\"),i+=b}for(g&&(u=e.slice(p+1),d=this.parse(u,eo),i=i.substring(0,h)+"\\["+d[0],o=o||d[1]),l=s.pop();l;l=s.pop()){let e;e=i.slice(l.reStart+l.open.length),this.debug("setting tail",i,l),e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,((e,t,n)=>(n||(n="\\"),t+t+n+"|"))),this.debug("tail=%j\n   %s",e,e,l,i);const t="*"===l.type?Vi:"?"===l.type?$i:"\\"+l.type;o=!0,i=i.slice(0,l.reStart)+t+"\\("+e}y(),r&&(i+="\\\\");const C=Xi[i.charAt(0)];for(let b=a.length-1;b>-1;b--){const e=a[b],n=i.slice(0,e.reStart),o=i.slice(e.reStart,e.reEnd-8);let r=i.slice(e.reEnd);const s=i.slice(e.reEnd-8,e.reEnd)+r,c=n.split(")").length,u=n.split("(").length-c;let l=r;for(let t=0;t<u;t++)l=l.replace(/\)[+*?]?/,"");r=l;i=n+o+r+(""===r&&t!==eo?"(?:$|\\/)":"")+s}if(""!==i&&o&&(i="(?=.)"+i),C&&(i=(m?"":f?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)")+i),t===eo)return[i,o];if(n.nocase&&!o&&(o=e.toUpperCase()!==e.toLowerCase()),!o)return(e=>e.replace(/\\(.)/g,"$1"))(e);const D=n.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",D),{_glob:e,_src:i})}catch(R){return new RegExp("$.")}}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,n=t.noglobstar?Vi:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=t.nocase?"i":"";let o=e.map((e=>(e=e.map((e=>"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===Wi?Wi:e._src)).reduce(((e,t)=>(e[e.length-1]===Wi&&t===Wi||e.push(t),e)),[]),e.forEach(((t,i)=>{t===Wi&&e[i-1]!==Wi&&(0===i?e.length>1?e[i+1]="(?:\\/|"+n+"\\/)?"+e[i+1]:e[i]=n:i===e.length-1?e[i-1]+="(?:\\/|"+n+")?":(e[i-1]+="(?:\\/|\\/"+n+"\\/)"+e[i+1],e[i+1]=Wi))})),e.filter((e=>e!==Wi)).join("/")))).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,i)}catch(r){this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const n=this.options;"/"!==Ki.sep&&(e=e.split(Ki.sep).join("/")),e=e.split(Qi),this.debug(this.pattern,"split",e);const i=this.set;let o;this.debug(this.pattern,"set",i);for(let r=e.length-1;r>=0&&(o=e[r],!o);r--);for(let r=0;r<i.length;r++){const s=i[r];let a=e;n.matchBase&&1===s.length&&(a=[o]);if(this.matchOne(a,s,t))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate}static defaults(e){return Ai.defaults(e).Minimatch}}Ai.Minimatch=no,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiagnosticFeature=e.DiagnosticPullMode=e.vsdiag=void 0;const t=Hi,n=s,i=c,o=ai,r=vi;function a(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var u,l,d,g,h;!function(e){var t;(t=e.DocumentDiagnosticReportKind||(e.DocumentDiagnosticReportKind={})).full="full",t.unChanged="unChanged"}(u=e.vsdiag||(e.vsdiag={})),function(e){e.onType="onType",e.onSave="onSave"}(l=e.DiagnosticPullMode||(e.DiagnosticPullMode={})),function(e){e.active="open",e.reschedule="reschedule",e.outDated="drop"}(d||(d={}));class p{constructor(){this.open=new Set,this._onOpen=new n.EventEmitter,this._onClose=new n.EventEmitter,p.fillTabResources(this.open);const e=e=>{if(0===e.closed.length&&0===e.opened.length)return;const t=this.open,i=new Set;p.fillTabResources(i);const o=new Set,r=new Set(i);for(const n of t.values())i.has(n)?r.delete(n):o.add(n);if(this.open=i,o.size>0){const e=new Set;for(const t of o)e.add(n.Uri.parse(t));this._onClose.fire(e)}if(r.size>0){const e=new Set;for(const t of r)e.add(n.Uri.parse(t));this._onOpen.fire(e)}};void 0!==n.window.tabGroups.onDidChangeTabs?this.disposable=n.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof n.Uri?n.window.activeTextEditor?.document.uri===e:n.window.activeTextEditor?.document===e}isVisible(e){const t=e instanceof n.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){const e=new Set;return p.fillTabResources(new Set,e),e}static fillTabResources(e,t){const i=e??new Set;for(const o of n.window.tabGroups.all)for(const e of o.tabs){const o=e.input;let r;o instanceof n.TabInputText?r=o.uri:o instanceof n.TabInputTextDiff&&(r=o.modified),void 0===r||i.has(r.toString())||(i.add(r.toString()),void 0!==t&&t.add(r))}}}!function(e){e[e.document=1]="document",e[e.workspace=2]="workspace"}(g||(g={})),function(e){e.asKey=function(e){return e instanceof n.Uri?e.toString():e.uri.toString()}}(h||(h={}));class m{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,i){const o=e===g.document?this.documentPullStates:this.workspacePullStates,[r,s,a]=t instanceof n.Uri?[t.toString(),t,i]:[t.uri.toString(),t.uri,t.version];let c=o.get(r);return void 0===c&&(c={document:s,pulledVersion:a,resultId:void 0},o.set(r,c)),c}update(e,t,i,o){const r=e===g.document?this.documentPullStates:this.workspacePullStates,[s,a,c,u]=t instanceof n.Uri?[t.toString(),t,i,o]:[t.uri.toString(),t.uri,t.version,i];let l=r.get(s);void 0===l?(l={document:a,pulledVersion:c,resultId:u},r.set(s,l)):(l.pulledVersion=c,l.resultId=u)}unTrack(e,t){const n=h.asKey(t);(e===g.document?this.documentPullStates:this.workspacePullStates).delete(n)}tracks(e,t){const n=h.asKey(t);return(e===g.document?this.documentPullStates:this.workspacePullStates).has(n)}getResultId(e,t){const n=h.asKey(t),i=e===g.document?this.documentPullStates:this.workspacePullStates;return i.get(n)?.resultId}getAllResultIds(){const e=[];for(let[t,n]of this.workspacePullStates)this.documentPullStates.has(t)&&(n=this.documentPullStates.get(t)),void 0!==n.resultId&&e.push({uri:t,value:n.resultId});return e}}class f{constructor(e,t,i){this.client=e,this.tabs=t,this.options=i,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new n.EventEmitter,this.provider=this.createProvider(),this.diagnostics=n.languages.createDiagnosticCollection(i.identifier),this.openRequests=new Map,this.documentStates=new m,this.workspaceErrorCounter=0}knows(e,t){const i=t instanceof n.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(i.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;const i=e instanceof n.Uri?e:e.uri;this.pullAsync(e).then((()=>{t&&t()}),(e=>{this.client.error(`Document pull failed for text document ${i.toString()}`,e,!1)}))}async pullAsync(e,t){if(this.isDisposed)return;const o=e instanceof n.Uri,s=o?e:e.uri,a=s.toString();t=o?t:e.version;const c=this.openRequests.get(a),l=o?this.documentStates.track(g.document,e,t):this.documentStates.track(g.document,e);if(void 0===c){const o=new n.CancellationTokenSource;let c,p;this.openRequests.set(a,{state:d.active,document:e,version:t,tokenSource:o});try{c=await this.provider.provideDiagnostics(e,l.resultId,o.token)??{kind:u.DocumentDiagnosticReportKind.full,items:[]}}catch(h){if(h instanceof r.LSPCancellationError&&i.DiagnosticServerCancellationData.is(h.data)&&!1===h.data.retriggerRequest&&(p={state:d.outDated,document:e}),!(void 0===p&&h instanceof n.CancellationError))throw h;p={state:d.reschedule,document:e}}if(p=p??this.openRequests.get(a),void 0===p)return this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${a}`),void this.diagnostics.delete(s);if(this.openRequests.delete(a),!this.tabs.isVisible(e))return void this.documentStates.unTrack(g.document,e);if(p.state===d.outDated)return;void 0!==c&&(c.kind===u.DocumentDiagnosticReportKind.full&&this.diagnostics.set(s,c.items),l.pulledVersion=t,l.resultId=c.resultId),p.state===d.reschedule&&this.pull(e)}else c.state===d.active?(c.tokenSource.cancel(),this.openRequests.set(a,{state:d.reschedule,document:c.document})):c.state===d.outDated&&this.openRequests.set(a,{state:d.reschedule,document:c.document})}forgetDocument(e){const t=e instanceof n.Uri?e:e.uri,i=t.toString(),o=this.openRequests.get(i);this.options.workspaceDiagnostics?void 0!==o?this.openRequests.set(i,{state:d.reschedule,document:e}):this.pull(e,(()=>{this.forget(g.document,e)})):(void 0!==o&&(o.state===d.active&&o.tokenSource.cancel(),this.openRequests.set(i,{state:d.outDated,document:e})),this.diagnostics.delete(t),this.forget(g.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then((()=>{this.workspaceTimeout=(0,i.RAL)().timer.setTimeout((()=>{this.pullWorkspace()}),2e3)}),(e=>{e instanceof r.LSPCancellationError||i.DiagnosticServerCancellationData.is(e.data)||(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,i.RAL)().timer.setTimeout((()=>{this.pullWorkspace()}),2e3))}))}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;void 0!==this.workspaceCancellation&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new n.CancellationTokenSource;const e=this.documentStates.getAllResultIds().map((e=>({uri:this.client.protocol2CodeConverter.asUri(e.uri),value:e.value})));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,(e=>{if(e&&!this.isDisposed)for(const t of e.items)t.kind===u.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(g.document,t.uri)||this.diagnostics.set(t.uri,t.items)),this.documentStates.update(g.workspace,t.uri,t.version??void 0,t.resultId)}))}createProvider(){const e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(e,t,o)=>{const r=(e,t,o)=>{const r={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(e instanceof n.Uri?e:e.uri)},previousResultId:t};return!0!==this.isDisposed&&this.client.isRunning()?this.client.sendRequest(i.DocumentDiagnosticRequest.type,r,o).then((async e=>null==e||this.isDisposed||o.isCancellationRequested?{kind:u.DocumentDiagnosticReportKind.full,items:[]}:e.kind===i.DocumentDiagnosticReportKind.Full?{kind:u.DocumentDiagnosticReportKind.full,resultId:e.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(e.items,o)}:{kind:u.DocumentDiagnosticReportKind.unChanged,resultId:e.resultId}),(e=>this.client.handleFailedRequest(i.DocumentDiagnosticRequest.type,o,e,{kind:u.DocumentDiagnosticReportKind.full,items:[]}))):{kind:u.DocumentDiagnosticReportKind.full,items:[]}},s=this.client.middleware;return s.provideDiagnostics?s.provideDiagnostics(e,t,o,r):r(e,t,o)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(e,t,n)=>{const r=async e=>e.kind===i.DocumentDiagnosticReportKind.Full?{kind:u.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(e.uri),resultId:e.resultId,version:e.version,items:await this.client.protocol2CodeConverter.asDiagnostics(e.items,t)}:{kind:u.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(e.uri),resultId:e.resultId,version:e.version},s=e=>{const t=[];for(const n of e)t.push({uri:this.client.code2ProtocolConverter.asUri(n.uri),value:n.value});return t},a=(e,t)=>{const a=(0,o.generateUuid)(),c=this.client.onProgress(i.WorkspaceDiagnosticRequest.partialResult,a,(async e=>{if(null==e)return void n(null);const t={items:[]};for(const n of e.items)try{t.items.push(await r(n))}catch(i){this.client.error("Converting workspace diagnostics failed.",i)}n(t)})),u={identifier:this.options.identifier,previousResultIds:s(e),partialResultToken:a};return!0!==this.isDisposed&&this.client.isRunning()?this.client.sendRequest(i.WorkspaceDiagnosticRequest.type,u,t).then((async e=>{if(t.isCancellationRequested)return{items:[]};const i={items:[]};for(const t of e.items)i.items.push(await r(t));return c.dispose(),n(i),{items:[]}}),(e=>(c.dispose(),this.client.handleFailedRequest(i.DocumentDiagnosticRequest.type,t,e,{items:[]})))):{items:[]}},c=this.client.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(e,t,n,a):a(e,t)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(const[e,t]of this.openRequests)t.state===d.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:d.outDated,document:t.document});this.diagnostics.dispose()}}class v{constructor(e){this.diagnosticRequestor=e,this.documents=new i.LinkedMap,this.isDisposed=!1}add(e){if(!0===this.isDisposed)return;const t=h.asKey(e);this.documents.has(t)||(this.documents.set(t,e,i.Touch.Last),this.trigger())}remove(e){const t=h.asKey(e);this.documents.delete(t),0===this.documents.size?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){!0!==this.isDisposed&&(void 0===this.intervalHandle?(this.endDocument=this.documents.last,this.intervalHandle=(0,i.RAL)().timer.setInterval((()=>{const e=this.documents.first;if(void 0!==e){const t=h.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,i.Touch.Last),t===this.endDocumentKey()&&this.stop()}}),200)):this.endDocument=this.documents.last)}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return void 0!==this.endDocument?h.asKey(this.endDocument):void 0}}class y{constructor(e,o,r){const s=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},a=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),c=[],u=e=>e instanceof n.Uri?(e=>{const n=r.documentSelector;if(void 0!==s.match)return s.match(n,e);for(const o of n)if(i.TextDocumentFilter.is(o)){if("string"==typeof o)return!1;if(void 0!==o.language&&"*"!==o.language)return!1;if(void 0!==o.scheme&&"*"!==o.scheme&&o.scheme!==e.scheme)return!1;if(void 0!==o.pattern){const n=new t.Minimatch(o.pattern,{noext:!0});if(!n.makeRe())return!1;if(!n.match(e.fsPath))return!1}}return!0})(e):n.languages.match(a,e)>0&&o.isVisible(e),d=e=>e instanceof n.Uri?this.activeTextDocument?.uri.toString()===e.toString():this.activeTextDocument===e;this.diagnosticRequestor=new f(e,o,r),this.backgroundScheduler=new v(this.diagnosticRequestor);const h=e=>{u(e)&&r.interFileDependencies&&!d(e)&&this.backgroundScheduler.add(e)};this.activeTextDocument=n.window.activeTextEditor?.document,n.window.onDidChangeActiveTextEditor((e=>{const t=this.activeTextDocument;this.activeTextDocument=e?.document,void 0!==t&&h(t),void 0!==this.activeTextDocument&&this.backgroundScheduler.remove(this.activeTextDocument)}));const p=e.getFeature(i.DidOpenTextDocumentNotification.method);c.push(p.onNotificationSent((e=>{const t=e.textDocument;this.diagnosticRequestor.knows(g.document,t)||u(t)&&this.diagnosticRequestor.pull(t,(()=>{h(t)}))}))),o.onOpen((e=>{for(const t of e){if(this.diagnosticRequestor.knows(g.document,t))continue;const e=t.toString();let i;for(const t of n.workspace.textDocuments)if(e===t.uri.toString()){i=t;break}void 0!==i&&u(i)?this.diagnosticRequestor.pull(i,(()=>{h(i)})):u(t)&&this.diagnosticRequestor.pull(t,(()=>{h(t)}))}}));const m=new Set;for(const t of n.workspace.textDocuments)u(t)&&(this.diagnosticRequestor.pull(t,(()=>{h(t)})),m.add(t.uri.toString()));if(!0===s.onTabs)for(const t of o.getTabResources())!m.has(t.toString())&&u(t)&&this.diagnosticRequestor.pull(t,(()=>{h(t)}));if(!0===s.onChange){const t=e.getFeature(i.DidChangeTextDocumentNotification.method);c.push(t.onNotificationSent((async e=>{const t=e.textDocument;void 0!==s.filter&&s.filter(t,l.onType)||!this.diagnosticRequestor.knows(g.document,t)||this.diagnosticRequestor.pull(t,(()=>{this.backgroundScheduler.trigger()}))})))}if(!0===s.onSave){const t=e.getFeature(i.DidSaveTextDocumentNotification.method);c.push(t.onNotificationSent((e=>{const t=e.textDocument;void 0!==s.filter&&s.filter(t,l.onSave)||!this.diagnosticRequestor.knows(g.document,t)||this.diagnosticRequestor.pull(e.textDocument,(()=>{this.backgroundScheduler.trigger()}))})))}const y=e.getFeature(i.DidCloseTextDocumentNotification.method);c.push(y.onNotificationSent((e=>{this.cleanUpDocument(e.textDocument)}))),o.onClose((e=>{for(const t of e)this.cleanUpDocument(t)})),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event((()=>{for(const e of n.workspace.textDocuments)u(e)&&this.diagnosticRequestor.pull(e)})),!0===r.workspaceDiagnostics&&"da348dc5-c30a-4515-9d98-31ff3be38d14"!==r.identifier&&this.diagnosticRequestor.pullWorkspace(),this.disposable=n.Disposable.from(...c,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(g.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}}e.DiagnosticFeature=class extends r.TextDocumentLanguageFeature{constructor(e){super(e,i.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=a(a(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,a(a(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(i.DiagnosticRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeDiagnosticsEmitter.fire()}));let[n,o]=this.getRegistration(t,e.diagnosticProvider);n&&o&&this.register({id:n,registerOptions:o})}dispose(){void 0!==this.tabs&&(this.tabs.dispose(),this.tabs=void 0),super.dispose()}registerLanguageProvider(e){void 0===this.tabs&&(this.tabs=new p);const t=new y(this._client,this.tabs,e);return[t.disposable,t]}}}(yi);var io={};Object.defineProperty(io,"__esModule",{value:!0}),io.NotebookDocumentSyncFeature=void 0;const oo=s,ro=Hi,so=c,ao=ai,co=Qt;function uo(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var lo,go,ho,po,mo;!function(e){!function(t){function n(e,t){return e.map((e=>o(e,t)))}function i(e){return r(new Set,e)}function o(e,t){const n=so.NotebookCell.create(function(e){switch(e){case oo.NotebookCellKind.Markup:return so.NotebookCellKind.Markup;case oo.NotebookCellKind.Code:return so.NotebookCellKind.Code}}(e.kind),t.asUri(e.document.uri));return Object.keys(e.metadata).length>0&&(n.metadata=i(e.metadata)),void 0!==e.executionSummary&&co.number(e.executionSummary.executionOrder)&&co.boolean(e.executionSummary.success)&&(n.executionSummary={executionOrder:e.executionSummary.executionOrder,success:e.executionSummary.success}),n}function r(e,t){if(e.has(t))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(t)){const n=[];for(const i of t)if(null!==i&&"object"==typeof i||Array.isArray(i))n.push(r(e,i));else{if(i instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");n.push(i)}return n}{const n=Object.keys(t),i=Object.create(null);for(const o of n){const n=t[o];if(null!==n&&"object"==typeof n||Array.isArray(n))i[o]=r(e,n);else{if(n instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");i[o]=n}}return i}}t.asVersionedNotebookDocumentIdentifier=function(e,t){return{version:e.version,uri:t.asUri(e.uri)}},t.asNotebookDocument=function(e,t,o){const r=so.NotebookDocument.create(o.asUri(e.uri),e.notebookType,e.version,n(t,o));return Object.keys(e.metadata).length>0&&(r.metadata=i(e.metadata)),r},t.asNotebookCells=n,t.asMetadata=i,t.asNotebookCell=o,t.asTextContentChange=function(e,t){const n=t.asChangeTextDocumentParams(e,e.document.uri,e.document.version);return{document:n.textDocument,changes:n.contentChanges}},t.asNotebookDocumentChangeEvent=function(t,n){const i=Object.create(null);if(t.metadata&&(i.metadata=e.c2p.asMetadata(t.metadata)),void 0!==t.cells){const o=Object.create(null),r=t.cells;r.structure&&(o.structure={array:{start:r.structure.array.start,deleteCount:r.structure.array.deleteCount,cells:void 0!==r.structure.array.cells?r.structure.array.cells.map((t=>e.c2p.asNotebookCell(t,n))):void 0},didOpen:void 0!==r.structure.didOpen?r.structure.didOpen.map((e=>n.asOpenTextDocumentParams(e.document).textDocument)):void 0,didClose:void 0!==r.structure.didClose?r.structure.didClose.map((e=>n.asCloseTextDocumentParams(e.document).textDocument)):void 0}),void 0!==r.data&&(o.data=r.data.map((t=>e.c2p.asNotebookCell(t,n)))),void 0!==r.textContent&&(o.textContent=r.textContent.map((t=>e.c2p.asTextContentChange(t,n)))),Object.keys(o).length>0&&(i.cells=o)}return i}}(e.c2p||(e.c2p={}))}(lo||(lo={})),function(e){function t(e,t,i=!0){return!(e.kind!==t.kind||e.document.uri.toString()!==t.document.uri.toString()||e.document.languageId!==t.document.languageId||!function(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;return e.executionOrder===t.executionOrder&&e.success===t.success&&function(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;return e.startTime===t.startTime&&e.endTime===t.endTime}(e.timing,t.timing)}(e.executionSummary,t.executionSummary))&&(!i||i&&n(e.metadata,t.metadata))}function n(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return!1;const o=Array.isArray(e),r=Array.isArray(t);if(o!==r)return!1;if(o&&r){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1}if(i(e)&&i(t)){const i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;if(i.sort(),o.sort(),!n(i,o))return!1;for(let r=0;r<i.length;r++){const o=i[r];if(!n(e[o],t[o]))return!1}return!0}return!1}function i(e){return null!==e&&"object"==typeof e}e.computeDiff=function(e,n,i){const o=e.length,r=n.length;let s=0;for(;s<r&&s<o&&t(e[s],n[s],i);)s++;if(s<r&&s<o){let a=o-1,c=r-1;for(;a>=0&&c>=0&&t(e[a],n[c],i);)a--,c--;const u=a+1-s,l=s===c+1?void 0:n.slice(s,c+1);return void 0!==l?{start:s,deleteCount:u,cells:l}:{start:s,deleteCount:u}}return s<r?{start:s,deleteCount:0,cells:n.slice(s)}:s<o?{start:s,deleteCount:o-s}:void 0},e.isObjectLiteral=i}(go||(go={})),function(e){e.matchNotebook=function(e,t){if("string"==typeof e)return"*"===e||t.notebookType===e;if(void 0!==e.notebookType&&"*"!==e.notebookType&&t.notebookType!==e.notebookType)return!1;const n=t.uri;if(void 0!==e.scheme&&"*"!==e.scheme&&n.scheme!==e.scheme)return!1;if(void 0!==e.pattern){const t=new ro.Minimatch(e.pattern,{noext:!0});if(!t.makeRe())return!1;if(!t.match(n.fsPath))return!1}return!0}}(ho||(ho={})),function(e){function t(e,t,n,i){return void 0===t&&void 0===n?{notebook:e,language:i}:{notebook:{notebookType:e,scheme:t,pattern:n},language:i}}e.asDocumentSelector=function(e){const n=e.notebookSelector,i=[];for(const o of n){const e=("string"==typeof o.notebook?o.notebook:o.notebook?.notebookType)??"*",n="string"==typeof o.notebook?void 0:o.notebook?.scheme,r="string"==typeof o.notebook?void 0:o.notebook?.pattern;if(void 0!==o.cells)for(const s of o.cells)i.push(t(e,n,r,s.language));else i.push(t(e,n,r,void 0))}return i}}(po||(po={})),function(e){e.create=function(e){return{cells:e,uris:new Set(e.map((e=>e.document.uri.toString())))}}}(mo||(mo={}));class fo{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(po.asDocumentSelector(t)),oo.workspace.onDidOpenNotebookDocument((e=>{this.notebookDidOpen.add(e.uri.toString()),this.didOpen(e)}),void 0,this.disposables);for(const n of oo.workspace.notebookDocuments)this.notebookDidOpen.add(n.uri.toString()),this.didOpen(n);oo.workspace.onDidChangeNotebookDocument((e=>this.didChangeNotebookDocument(e)),void 0,this.disposables),!0===this.options.save&&oo.workspace.onDidSaveNotebookDocument((e=>this.didSave(e)),void 0,this.disposables),oo.workspace.onDidCloseNotebookDocument((e=>{this.didClose(e),this.notebookDidOpen.delete(e.uri.toString())}),void 0,this.disposables)}getState(){for(const e of oo.workspace.notebookDocuments){if(void 0!==this.getMatchingCells(e))return{kind:"document",id:"$internal",registrations:!0,matches:!0}}return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return oo.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(0===oo.languages.match(this.selector,t.document))return;if(!this.notebookDidOpen.has(e.uri.toString()))return;const n=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(void 0!==n){const o=n.uris.has(t.document.uri.toString());if(i&&o||!i&&!o)return;if(i){const t=this.getMatchingCells(e);if(void 0!==t){const i=this.asNotebookDocumentChangeEvent(e,void 0,n,t);void 0!==i&&this.doSendChange(i,t).catch((()=>{}))}}}else i&&this.doSendOpen(e,[t]).catch((()=>{}))}didChangeNotebookCellTextDocument(e,t){0!==oo.languages.match(this.selector,t.document)&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch((()=>{}))}didCloseNotebookCellTextDocument(e,t){const n=this.notebookSyncInfo.get(e.uri.toString());if(void 0===n)return;const i=t.document.uri,o=n.cells.findIndex((e=>e.document.uri.toString()===i.toString()));if(-1!==o)if(0===o&&1===n.cells.length)this.doSendClose(e,n.cells).catch((()=>{}));else{const t=n.cells.slice(),i=t.splice(o,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:o,deleteCount:1},didClose:i}}},t).catch((()=>{}))}}dispose(){for(const e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),n=this.notebookSyncInfo.get(e.uri.toString())){if(void 0!==n)if(void 0!==t){const i=this.asNotebookDocumentChangeEvent(e,void 0,n,t);void 0!==i&&this.doSendChange(i,t).catch((()=>{}))}else this.doSendClose(e,[]).catch((()=>{}));else{if(void 0===t)return;this.doSendOpen(e,t).catch((()=>{}))}}didChangeNotebookDocument(e){const t=e.notebook,n=this.notebookSyncInfo.get(t.uri.toString());if(void 0===n){if(0===e.contentChanges.length)return;const i=this.getMatchingCells(t);if(void 0===i)return;this.didOpen(t,i,n)}else{const i=this.getMatchingCells(t);if(void 0===i)return void this.didClose(t,n);const o=this.asNotebookDocumentChangeEvent(e.notebook,e,n,i);void 0!==o&&this.doSendChange(o,i).catch((()=>{}))}}didSave(e){void 0!==this.notebookSyncInfo.get(e.uri.toString())&&this.doSendSave(e).catch((()=>{}))}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(void 0===t)return;const n=e.getCells().filter((e=>t.uris.has(e.document.uri.toString())));this.doSendClose(e,n).catch((()=>{}))}async sendDidOpenNotebookDocument(e){const t=this.getMatchingCells(e);if(void 0!==t)return this.doSendOpen(e,t)}async doSendOpen(e,t){const n=async(e,t)=>{const n=lo.c2p.asNotebookDocument(e,t,this.client.code2ProtocolConverter),i=t.map((e=>this.client.code2ProtocolConverter.asTextDocumentItem(e.document)));try{await this.client.sendNotification(so.DidOpenNotebookDocumentNotification.type,{notebookDocument:n,cellTextDocuments:i})}catch(o){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",o),o}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),mo.create(t)),void 0!==i?.didOpen?i.didOpen(e,t,n):n(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){const n=async e=>{try{await this.client.sendNotification(so.DidChangeNotebookDocumentNotification.type,{notebookDocument:lo.c2p.asVersionedNotebookDocumentIdentifier(e.notebook,this.client.code2ProtocolConverter),change:lo.c2p.asNotebookDocumentChangeEvent(e,this.client.code2ProtocolConverter)})}catch(t){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",t),t}},i=this.client.middleware?.notebooks;return void 0!==e.cells?.structure&&this.notebookSyncInfo.set(e.notebook.uri.toString(),mo.create(t??[])),void 0!==i?.didChange?i?.didChange(e,n):n(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){const t=async e=>{try{await this.client.sendNotification(so.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(e.uri)}})}catch(t){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",t),t}},n=this.client.middleware?.notebooks;return void 0!==n?.didSave?n.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){const n=async(e,t)=>{try{await this.client.sendNotification(so.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(e.uri)},cellTextDocuments:t.map((e=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document)))})}catch(n){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",n),n}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),void 0!==i?.didClose?i.didClose(e,t,n):n(e,t)}asNotebookDocumentChangeEvent(e,t,n,i){if(void 0!==t&&t.notebook!==e)throw new Error("Notebook must be identical");const o={notebook:e};let r;if(void 0!==t?.metadata&&(o.metadata=lo.c2p.asMetadata(t.metadata)),void 0!==t?.cellChanges&&t.cellChanges.length>0){const e=[];r=new Set(i.map((e=>e.document.uri.toString())));for(const n of t.cellChanges)!r.has(n.cell.document.uri.toString())||void 0===n.executionSummary&&void 0===n.metadata||e.push(n.cell);e.length>0&&(o.cells=o.cells??{},o.cells.data=e)}if((void 0!==t?.contentChanges&&t.contentChanges.length>0||void 0===t)&&void 0!==n&&void 0!==i){const e=n.cells,t=i,r=go.computeDiff(e,t,!1);let s,a;if(void 0!==r){s=void 0===r.cells?new Map:new Map(r.cells.map((e=>[e.document.uri.toString(),e]))),a=0===r.deleteCount?new Map:new Map(e.slice(r.start,r.start+r.deleteCount).map((e=>[e.document.uri.toString(),e])));for(const e of Array.from(a.keys()))s.has(e)&&(a.delete(e),s.delete(e));o.cells=o.cells??{};const t=[],n=[];if(s.size>0||a.size>0){for(const e of s.values())t.push(e);for(const e of a.values())n.push(e)}o.cells.structure={array:r,didOpen:t,didClose:n}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(e,t=e.getCells()){if(void 0!==this.options.notebookSelector)for(const n of this.options.notebookSelector)if(void 0===n.notebook||ho.matchNotebook(n.notebook,e)){const i=this.filterCells(e,t,n.cells);return 0===i.length?void 0:i}}cellMatches(e,t){const n=this.getMatchingCells(e,[t]);return void 0!==n&&n[0]===t}filterCells(e,t,n){const i=void 0!==n?t.filter((e=>{const t=e.document.languageId;return n.some((e=>"*"===e.language||t===e.language))})):t;return"function"==typeof this.client.clientOptions.notebookDocumentOptions?.filterCells?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}}class vo{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=so.NotebookDocumentSyncRegistrationType.type,oo.workspace.onDidOpenTextDocument((e=>{if(e.uri.scheme!==vo.CellScheme)return;const[t,n]=this.findNotebookDocumentAndCell(e);if(void 0!==t&&void 0!==n)for(const i of this.registrations.values())i instanceof fo&&i.didOpenNotebookCellTextDocument(t,n)})),oo.workspace.onDidChangeTextDocument((e=>{if(0===e.contentChanges.length)return;const t=e.document;if(t.uri.scheme!==vo.CellScheme)return;const[n]=this.findNotebookDocumentAndCell(t);if(void 0!==n)for(const i of this.registrations.values())i instanceof fo&&i.didChangeNotebookCellTextDocument(n,e)})),oo.workspace.onDidCloseTextDocument((e=>{if(e.uri.scheme!==vo.CellScheme)return;const[t,n]=this.findNotebookDocumentAndCell(e);if(void 0!==t&&void 0!==n)for(const i of this.registrations.values())i instanceof fo&&i.didCloseNotebookCellTextDocument(t,n)}))}getState(){if(0===this.registrations.size)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(const e of this.registrations.values()){const t=e.getState();if("document"===t.kind&&!0===t.registrations&&!0===t.matches)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){const t=uo(uo(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){const t=e.notebookDocumentSync;void 0!==t&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(po.asDocumentSelector(t)))}initialize(e){const t=e.notebookDocumentSync;if(void 0===t)return;const n=t.id??ao.generateUuid();this.register({id:n,registerOptions:t})}register(e){const t=new fo(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){const t=this.registrations.get(e);t&&t.dispose()}dispose(){for(const e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==vo.CellScheme)return!1;if(void 0!==this.dedicatedChannel&&oo.languages.match(this.dedicatedChannel,e)>0)return!0;for(const t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(const t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){const t=e.uri.toString();for(const n of oo.workspace.notebookDocuments)for(const e of n.getCells())if(e.document.uri.toString()===t)return[n,e];return[void 0,void 0]}}io.NotebookDocumentSyncFeature=vo,vo.CellScheme="vscode-notebook-cell";var yo={};Object.defineProperty(yo,"__esModule",{value:!0}),yo.SyncConfigurationFeature=yo.toJSONObject=yo.ConfigurationFeature=void 0;const Co=s,Do=c,Ro=Qt,bo=ai,So=vi;function To(e){if(e){if(Array.isArray(e))return e.map(To);if("object"==typeof e){const t=Object.create(null);for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=To(e[n]));return t}}return e}yo.ConfigurationFeature=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(Do.ConfigurationRequest.type,((t,n)=>{let i=e=>{let t=[];for(let n of e.items){let e=void 0!==n.scopeUri&&null!==n.scopeUri?this._client.protocol2CodeConverter.asUri(n.scopeUri):void 0;t.push(this.getConfiguration(e,null!==n.section?n.section:void 0))}return t},o=e.middleware.workspace;return o&&o.configuration?o.configuration(t,n,i):i(t)}))}getConfiguration(e,t){let n=null;if(t){let i=t.lastIndexOf(".");if(-1===i)n=To(Co.workspace.getConfiguration(void 0,e).get(t));else{let o=Co.workspace.getConfiguration(t.substr(0,i),e);o&&(n=To(o.get(t.substr(i+1))))}}else{let t=Co.workspace.getConfiguration(void 0,e);n={};for(let e of Object.keys(t))t.has(e)&&(n[e]=To(t.get(e)))}return void 0===n&&(n=null),n}dispose(){}},yo.toJSONObject=To;yo.SyncConfigurationFeature=class{constructor(e){this._client=e,this.isDisposed=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Do.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,So.ensure)((0,So.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let e=this._client.clientOptions.synchronize?.configurationSection;void 0!==e&&this.register({id:bo.generateUuid(),registerOptions:{section:e}})}register(e){let t=Co.workspace.onDidChangeConfiguration((t=>{this.onDidChangeConfiguration(e.registerOptions.section,t)}));this._listeners.set(e.id,t),void 0!==e.registerOptions.section&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(const e of this._listeners.values())e.dispose();this._listeners.clear(),this.isDisposed=!0}onDidChangeConfiguration(e,t){if(this.isDisposed)return;let n;if(n=Ro.string(e)?[e]:e,void 0!==n&&void 0!==t){if(!n.some((e=>t.affectsConfiguration(e))))return}const i=async e=>void 0===e?this._client.sendNotification(Do.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(Do.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(e)});let o=this._client.middleware.workspace?.didChangeConfiguration;(o?o(n,i):i(n)).catch((e=>{this._client.error(`Sending notification ${Do.DidChangeConfigurationNotification.type.method} failed`,e)}))}extractSettingsInformation(e){function t(e,t){let n=e;for(let i=0;i<t.length-1;i++){let e=n[t[i]];e||(e=Object.create(null),n[t[i]]=e),n=e}return n}let n=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let o=0;o<e.length;o++){let r=e[o],s=r.indexOf("."),a=null;if(a=s>=0?Co.workspace.getConfiguration(r.substr(0,s),n).get(r.substr(s+1)):Co.workspace.getConfiguration(void 0,n).get(r),a){let n=e[o].split(".");t(i,n)[n[n.length-1]]=To(a)}}return i}};var wo={};Object.defineProperty(wo,"__esModule",{value:!0}),wo.DidSaveTextDocumentFeature=wo.WillSaveWaitUntilFeature=wo.WillSaveFeature=wo.DidChangeTextDocumentFeature=wo.DidCloseTextDocumentFeature=wo.DidOpenTextDocumentFeature=void 0;const _o=s,ko=c,Po=vi,xo=ai;class qo extends Po.TextDocumentEventFeature{constructor(e,t){super(e,_o.workspace.onDidOpenTextDocument,ko.DidOpenTextDocumentNotification.type,(()=>e.middleware.didOpen),(t=>e.code2ProtocolConverter.asOpenTextDocumentParams(t)),(e=>e),Po.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Po.ensure)((0,Po.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){const n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:xo.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return ko.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;const t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);_o.workspace.textDocuments.forEach((e=>{const n=e.uri.toString();if(!this._syncedDocuments.has(n)&&_o.languages.match(t,e)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e)){const t=this._client.middleware,i=e=>this._client.sendNotification(this._type,this._createParams(e));(t.didOpen?t.didOpen(e,i):i(e)).catch((e=>{this._client.error(`Sending document notification ${this._type.method} failed`,e)})),this._syncedDocuments.set(n,e)}}))}getTextDocument(e){return e}notificationSent(e,t,n){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,n)}}wo.DidOpenTextDocumentFeature=qo;class Fo extends Po.TextDocumentEventFeature{constructor(e,t,n){super(e,_o.workspace.onDidCloseTextDocument,ko.DidCloseTextDocumentNotification.type,(()=>e.middleware.didClose),(t=>e.code2ProtocolConverter.asCloseTextDocumentParams(t)),(e=>e),Po.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=n}get registrationType(){return ko.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Po.ensure)((0,Po.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:xo.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,n){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,n)}unregister(e){const t=this._selectors.get(e);super.unregister(e);const n=this._selectors.values();this._syncedDocuments.forEach((e=>{if(_o.languages.match(t,e)>0&&!this._selectorFilter(n,e)&&!this._client.hasDedicatedTextSynchronizationFeature(e)){let t=this._client.middleware,n=e=>this._client.sendNotification(this._type,this._createParams(e));this._syncedDocuments.delete(e.uri.toString()),(t.didClose?t.didClose(e,n):n(e)).catch((e=>{this._client.error(`Sending document notification ${this._type.method} failed`,e)}))}}))}}wo.DidCloseTextDocumentFeature=Fo;class Oo extends Po.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new _o.EventEmitter,this._onPendingChangeAdded=new _o.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=ko.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return ko.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Po.ensure)((0,Po.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&void 0!==n.change&&n.change!==ko.TextDocumentSyncKind.None&&this.register({id:xo.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:n.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=_o.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(const e of this._changeData.values())yield e.documentSelector}async callback(e){if(0===e.contentChanges.length)return;const t=e.document.uri,n=e.document.version,i=[];for(const o of this._changeData.values())if(_o.languages.match(o.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){const r=this._client.middleware;if(o.syncKind===ko.TextDocumentSyncKind.Incremental){const o=async e=>{const i=this._client.code2ProtocolConverter.asChangeTextDocumentParams(e,t,n);await this._client.sendNotification(ko.DidChangeTextDocumentNotification.type,i),this.notificationSent(e.document,ko.DidChangeTextDocumentNotification.type,i)};i.push(r.didChange?r.didChange(e,(e=>o(e))):o(e))}else if(o.syncKind===ko.TextDocumentSyncKind.Full){const t=async e=>{const t=e.document.uri.toString();this._pendingTextDocumentChanges.set(t,e.document),this._onPendingChangeAdded.fire()};i.push(r.didChange?r.didChange(e,(e=>t(e))):t(e))}}return Promise.all(i).then(void 0,(e=>{throw this._client.error(`Sending document notification ${ko.DidChangeTextDocumentNotification.type.method} failed`,e),e}))}notificationSent(e,t,n){this._onNotificationSent.fire({textDocument:e,type:t,params:n})}unregister(e){if(this._changeData.delete(e),0===this._changeData.size)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=ko.TextDocumentSyncKind.None;else{this._syncKind=ko.TextDocumentSyncKind.None;for(const e of this._changeData.values())if(this.updateSyncKind(e.syncKind),this._syncKind===ko.TextDocumentSyncKind.Full)break}}dispose(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=ko.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(0===this._pendingTextDocumentChanges.size)return[];let t;if(0===e.size)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(const n of this._pendingTextDocumentChanges)e.has(n[0])||(t.push(n[1]),this._pendingTextDocumentChanges.delete(n[0]))}return t}getProvider(e){for(const t of this._changeData.values())if(_o.languages.match(t.documentSelector,e)>0)return{send:e=>this.callback(e)}}updateSyncKind(e){if(this._syncKind!==ko.TextDocumentSyncKind.Full)switch(e){case ko.TextDocumentSyncKind.Full:this._syncKind=e;break;case ko.TextDocumentSyncKind.Incremental:this._syncKind===ko.TextDocumentSyncKind.None&&(this._syncKind=ko.TextDocumentSyncKind.Incremental)}}}wo.DidChangeTextDocumentFeature=Oo;class Eo extends Po.TextDocumentEventFeature{constructor(e){super(e,_o.workspace.onWillSaveTextDocument,ko.WillSaveTextDocumentNotification.type,(()=>e.middleware.willSave),(t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t)),(e=>e.document),((e,t)=>Po.TextDocumentEventFeature.textDocumentFilter(e,t.document)))}get registrationType(){return ko.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Po.ensure)((0,Po.ensure)(e,"textDocument"),"synchronization").willSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSave&&this.register({id:xo.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}}wo.WillSaveFeature=Eo;class Mo extends Po.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return ko.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){(0,Po.ensure)((0,Po.ensure)(e,"textDocument"),"synchronization").willSaveWaitUntil=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSaveWaitUntil&&this.register({id:xo.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=_o.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Po.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,n=e=>this._client.sendRequest(ko.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(e)).then((async e=>{let t=await this._client.protocol2CodeConverter.asTextEdits(e);return void 0===t?[]:t}));e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,n):n(e))}}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}wo.WillSaveWaitUntilFeature=Mo;class No extends Po.TextDocumentEventFeature{constructor(e){super(e,_o.workspace.onDidSaveTextDocument,ko.DidSaveTextDocumentNotification.type,(()=>e.middleware.didSave),(t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText)),(e=>e),Po.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return ko.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Po.ensure)((0,Po.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){const n=e.resolvedTextDocumentSync;if(t&&n&&n.save){const e="boolean"==typeof n.save?{includeText:!1}:{includeText:!!n.save.includeText};this.register({id:xo.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},e)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}}wo.DidSaveTextDocumentFeature=No;var Io={};Object.defineProperty(Io,"__esModule",{value:!0}),Io.CompletionItemFeature=void 0;const Lo=s,jo=c,Ao=vi,Ho=ai,Ko=[jo.CompletionItemKind.Text,jo.CompletionItemKind.Method,jo.CompletionItemKind.Function,jo.CompletionItemKind.Constructor,jo.CompletionItemKind.Field,jo.CompletionItemKind.Variable,jo.CompletionItemKind.Class,jo.CompletionItemKind.Interface,jo.CompletionItemKind.Module,jo.CompletionItemKind.Property,jo.CompletionItemKind.Unit,jo.CompletionItemKind.Value,jo.CompletionItemKind.Enum,jo.CompletionItemKind.Keyword,jo.CompletionItemKind.Snippet,jo.CompletionItemKind.Color,jo.CompletionItemKind.File,jo.CompletionItemKind.Reference,jo.CompletionItemKind.Folder,jo.CompletionItemKind.EnumMember,jo.CompletionItemKind.Constant,jo.CompletionItemKind.Struct,jo.CompletionItemKind.Event,jo.CompletionItemKind.Operator,jo.CompletionItemKind.TypeParameter];Io.CompletionItemFeature=class extends Ao.TextDocumentLanguageFeature{constructor(e){super(e,jo.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,Ao.ensure)((0,Ao.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[jo.MarkupKind.Markdown,jo.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[jo.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[jo.InsertTextMode.asIs,jo.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=jo.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:Ko},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode"]}}initialize(e,t){const n=this.getRegistrationOptions(t,e.completionProvider);n&&this.register({id:Ho.generateUuid(),registerOptions:n})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);const n=e.triggerCharacters??[],i=e.allCommitCharacters,o=e.documentSelector,r={provideCompletionItems:(e,t,n,o)=>{const r=this._client,s=this._client.middleware,a=(e,t,n,o)=>r.sendRequest(jo.CompletionRequest.type,r.code2ProtocolConverter.asCompletionParams(e,t,n),o).then((e=>o.isCancellationRequested?null:r.protocol2CodeConverter.asCompletionResult(e,i,o)),(e=>r.handleFailedRequest(jo.CompletionRequest.type,o,e,null)));return s.provideCompletionItem?s.provideCompletionItem(e,t,o,n,a):a(e,t,o,n)},resolveCompletionItem:e.resolveProvider?(e,n)=>{const i=this._client,o=this._client.middleware,r=(e,n)=>i.sendRequest(jo.CompletionResolveRequest.type,i.code2ProtocolConverter.asCompletionItem(e,!!this.labelDetailsSupport.get(t)),n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asCompletionItem(e)),(t=>i.handleFailedRequest(jo.CompletionResolveRequest.type,n,t,e)));return o.resolveCompletionItem?o.resolveCompletionItem(e,n,r):r(e,n)}:void 0};return[Lo.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),r,...n),r]}};var Wo={};Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.HoverFeature=void 0;const Uo=s,zo=c,$o=vi,Vo=ai;Wo.HoverFeature=class extends $o.TextDocumentLanguageFeature{constructor(e){super(e,zo.HoverRequest.type)}fillClientCapabilities(e){const t=(0,$o.ensure)((0,$o.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[zo.MarkupKind.Markdown,zo.MarkupKind.PlainText]}initialize(e,t){const n=this.getRegistrationOptions(t,e.hoverProvider);n&&this.register({id:Vo.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n={provideHover:(e,t,n)=>{const i=this._client,o=(e,t,n)=>i.sendRequest(zo.HoverRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asHover(e)),(e=>i.handleFailedRequest(zo.HoverRequest.type,n,e,null))),r=i.middleware;return r.provideHover?r.provideHover(e,t,n,o):o(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return Uo.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};var Bo={};Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.DefinitionFeature=void 0;const Jo=s,Xo=c,Qo=vi,Go=ai;Bo.DefinitionFeature=class extends Qo.TextDocumentLanguageFeature{constructor(e){super(e,Xo.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,Qo.ensure)((0,Qo.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.definitionProvider);n&&this.register({id:Go.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n={provideDefinition:(e,t,n)=>{const i=this._client,o=(e,t,n)=>i.sendRequest(Xo.DefinitionRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDefinitionResult(e,n)),(e=>i.handleFailedRequest(Xo.DefinitionRequest.type,n,e,null))),r=i.middleware;return r.provideDefinition?r.provideDefinition(e,t,n,o):o(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return Jo.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};var Yo={};Object.defineProperty(Yo,"__esModule",{value:!0}),Yo.SignatureHelpFeature=void 0;const Zo=s,er=c,tr=vi,nr=ai;Yo.SignatureHelpFeature=class extends tr.TextDocumentLanguageFeature{constructor(e){super(e,er.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,tr.ensure)((0,tr.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[er.MarkupKind.Markdown,er.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.signatureHelpProvider);n&&this.register({id:nr.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t={provideSignatureHelp:(e,t,n,i)=>{const o=this._client,r=(e,t,n,i)=>o.sendRequest(er.SignatureHelpRequest.type,o.code2ProtocolConverter.asSignatureHelpParams(e,t,n),i).then((e=>i.isCancellationRequested?null:o.protocol2CodeConverter.asSignatureHelp(e,i)),(e=>o.handleFailedRequest(er.SignatureHelpRequest.type,i,e,null))),s=o.middleware;return s.provideSignatureHelp?s.provideSignatureHelp(e,t,i,n,r):r(e,t,i,n)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){const n=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(void 0===e.retriggerCharacters){const i=e.triggerCharacters||[];return Zo.languages.registerSignatureHelpProvider(n,t,...i)}{const i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return Zo.languages.registerSignatureHelpProvider(n,t,i)}}};var ir={};Object.defineProperty(ir,"__esModule",{value:!0}),ir.DocumentHighlightFeature=void 0;const or=s,rr=c,sr=vi,ar=ai;ir.DocumentHighlightFeature=class extends sr.TextDocumentLanguageFeature{constructor(e){super(e,rr.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,sr.ensure)((0,sr.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.documentHighlightProvider);n&&this.register({id:ar.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n={provideDocumentHighlights:(e,t,n)=>{const i=this._client,o=(e,t,n)=>i.sendRequest(rr.DocumentHighlightRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDocumentHighlights(e,n)),(e=>i.handleFailedRequest(rr.DocumentHighlightRequest.type,n,e,null))),r=i.middleware;return r.provideDocumentHighlights?r.provideDocumentHighlights(e,t,n,o):o(e,t,n)}};return[or.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};var cr={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DocumentSymbolFeature=e.SupportedSymbolTags=e.SupportedSymbolKinds=void 0;const t=s,n=c,i=vi,o=ai;e.SupportedSymbolKinds=[n.SymbolKind.File,n.SymbolKind.Module,n.SymbolKind.Namespace,n.SymbolKind.Package,n.SymbolKind.Class,n.SymbolKind.Method,n.SymbolKind.Property,n.SymbolKind.Field,n.SymbolKind.Constructor,n.SymbolKind.Enum,n.SymbolKind.Interface,n.SymbolKind.Function,n.SymbolKind.Variable,n.SymbolKind.Constant,n.SymbolKind.String,n.SymbolKind.Number,n.SymbolKind.Boolean,n.SymbolKind.Array,n.SymbolKind.Object,n.SymbolKind.Key,n.SymbolKind.Null,n.SymbolKind.EnumMember,n.SymbolKind.Struct,n.SymbolKind.Event,n.SymbolKind.Operator,n.SymbolKind.TypeParameter],e.SupportedSymbolTags=[n.SymbolTag.Deprecated];e.DocumentSymbolFeature=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,n.DocumentSymbolRequest.type)}fillClientCapabilities(t){let n=(0,i.ensure)((0,i.ensure)(t,"textDocument"),"documentSymbol");n.dynamicRegistration=!0,n.symbolKind={valueSet:e.SupportedSymbolKinds},n.hierarchicalDocumentSymbolSupport=!0,n.tagSupport={valueSet:e.SupportedSymbolTags},n.labelSupport=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.documentSymbolProvider);n&&this.register({id:o.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const i=e.documentSelector,o={provideDocumentSymbols:(e,t)=>{const i=this._client,o=async(e,t)=>{try{const o=await i.sendRequest(n.DocumentSymbolRequest.type,i.code2ProtocolConverter.asDocumentSymbolParams(e),t);if(t.isCancellationRequested||null==o)return null;if(0===o.length)return[];{const e=o[0];return n.DocumentSymbol.is(e)?await i.protocol2CodeConverter.asDocumentSymbols(o,t):await i.protocol2CodeConverter.asSymbolInformations(o,t)}}catch(o){return i.handleFailedRequest(n.DocumentSymbolRequest.type,t,o,null)}},r=i.middleware;return r.provideDocumentSymbols?r.provideDocumentSymbols(e,t,o):o(e,t)}},r=void 0!==e.label?{label:e.label}:void 0;return[t.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(i),o,r),o]}}}(cr);var ur={};Object.defineProperty(ur,"__esModule",{value:!0}),ur.WorkspaceSymbolFeature=void 0;const lr=s,dr=c,gr=vi,hr=cr,pr=ai;ur.WorkspaceSymbolFeature=class extends gr.WorkspaceFeature{constructor(e){super(e,dr.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,gr.ensure)((0,gr.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:hr.SupportedSymbolKinds},t.tagSupport={valueSet:hr.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:pr.generateUuid(),registerOptions:!0===e.workspaceSymbolProvider?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){const t={provideWorkspaceSymbols:(e,t)=>{const n=this._client,i=(e,t)=>n.sendRequest(dr.WorkspaceSymbolRequest.type,{query:e},t).then((e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asSymbolInformations(e,t)),(e=>n.handleFailedRequest(dr.WorkspaceSymbolRequest.type,t,e,null))),o=n.middleware;return o.provideWorkspaceSymbols?o.provideWorkspaceSymbols(e,t,i):i(e,t)},resolveWorkspaceSymbol:!0===e.resolveProvider?(e,t)=>{const n=this._client,i=(e,t)=>n.sendRequest(dr.WorkspaceSymbolResolveRequest.type,n.code2ProtocolConverter.asWorkspaceSymbol(e),t).then((e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asSymbolInformation(e)),(e=>n.handleFailedRequest(dr.WorkspaceSymbolResolveRequest.type,t,e,null))),o=n.middleware;return o.resolveWorkspaceSymbol?o.resolveWorkspaceSymbol(e,t,i):i(e,t)}:void 0};return[lr.languages.registerWorkspaceSymbolProvider(t),t]}};var mr={};Object.defineProperty(mr,"__esModule",{value:!0}),mr.ReferencesFeature=void 0;const fr=s,vr=c,yr=vi,Cr=ai;mr.ReferencesFeature=class extends yr.TextDocumentLanguageFeature{constructor(e){super(e,vr.ReferencesRequest.type)}fillClientCapabilities(e){(0,yr.ensure)((0,yr.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.referencesProvider);n&&this.register({id:Cr.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n={provideReferences:(e,t,n,i)=>{const o=this._client,r=(e,t,n,i)=>o.sendRequest(vr.ReferencesRequest.type,o.code2ProtocolConverter.asReferenceParams(e,t,n),i).then((e=>i.isCancellationRequested?null:o.protocol2CodeConverter.asReferences(e,i)),(e=>o.handleFailedRequest(vr.ReferencesRequest.type,i,e,null))),s=o.middleware;return s.provideReferences?s.provideReferences(e,t,n,i,r):r(e,t,n,i)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return fr.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.CodeActionFeature=void 0;const Rr=s,br=c,Sr=ai,Tr=vi;Dr.CodeActionFeature=class extends Tr.TextDocumentLanguageFeature{constructor(e){super(e,br.CodeActionRequest.type)}fillClientCapabilities(e){const t=(0,Tr.ensure)((0,Tr.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[br.CodeActionKind.Empty,br.CodeActionKind.QuickFix,br.CodeActionKind.Refactor,br.CodeActionKind.RefactorExtract,br.CodeActionKind.RefactorInline,br.CodeActionKind.RefactorRewrite,br.CodeActionKind.Source,br.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!1}initialize(e,t){const n=this.getRegistrationOptions(t,e.codeActionProvider);n&&this.register({id:Sr.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n={provideCodeActions:(e,t,n,i)=>{const o=this._client,r=async(e,t,n,i)=>{const r={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),range:o.code2ProtocolConverter.asRange(t),context:await o.code2ProtocolConverter.asCodeActionContext(n,i)};return o.sendRequest(br.CodeActionRequest.type,r,i).then((e=>i.isCancellationRequested||null==e?null:o.protocol2CodeConverter.asCodeActionResult(e,i)),(e=>o.handleFailedRequest(br.CodeActionRequest.type,i,e,null)))},s=o.middleware;return s.provideCodeActions?s.provideCodeActions(e,t,n,i,r):r(e,t,n,i)},resolveCodeAction:e.resolveProvider?(e,t)=>{const n=this._client,i=this._client.middleware,o=async(e,t)=>n.sendRequest(br.CodeActionResolveRequest.type,await n.code2ProtocolConverter.asCodeAction(e,t),t).then((i=>t.isCancellationRequested?e:n.protocol2CodeConverter.asCodeAction(i,t)),(i=>n.handleFailedRequest(br.CodeActionResolveRequest.type,t,i,e)));return i.resolveCodeAction?i.resolveCodeAction(e,t,o):o(e,t)}:void 0};return[Rr.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),n]}};var wr={};Object.defineProperty(wr,"__esModule",{value:!0}),wr.CodeLensFeature=void 0;const _r=s,kr=c,Pr=ai,xr=vi;wr.CodeLensFeature=class extends xr.TextDocumentLanguageFeature{constructor(e){super(e,kr.CodeLensRequest.type)}fillClientCapabilities(e){(0,xr.ensure)((0,xr.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,xr.ensure)((0,xr.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(kr.CodeLensRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeCodeLensEmitter.fire()}));const n=this.getRegistrationOptions(t,e.codeLensProvider);n&&this.register({id:Pr.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n=new _r.EventEmitter,i={onDidChangeCodeLenses:n.event,provideCodeLenses:(e,t)=>{const n=this._client,i=(e,t)=>n.sendRequest(kr.CodeLensRequest.type,n.code2ProtocolConverter.asCodeLensParams(e),t).then((e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asCodeLenses(e,t)),(e=>n.handleFailedRequest(kr.CodeLensRequest.type,t,e,null))),o=n.middleware;return o.provideCodeLenses?o.provideCodeLenses(e,t,i):i(e,t)},resolveCodeLens:e.resolveProvider?(e,t)=>{const n=this._client,i=(e,t)=>n.sendRequest(kr.CodeLensResolveRequest.type,n.code2ProtocolConverter.asCodeLens(e),t).then((i=>t.isCancellationRequested?e:n.protocol2CodeConverter.asCodeLens(i)),(i=>n.handleFailedRequest(kr.CodeLensResolveRequest.type,t,i,e))),o=n.middleware;return o.resolveCodeLens?o.resolveCodeLens(e,t,i):i(e,t)}:void 0};return[_r.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:n}]}};var qr={};Object.defineProperty(qr,"__esModule",{value:!0}),qr.DocumentOnTypeFormattingFeature=qr.DocumentRangeFormattingFeature=qr.DocumentFormattingFeature=void 0;const Fr=s,Or=c,Er=ai,Mr=vi;var Nr;!function(e){e.fromConfiguration=function(e){const t=Fr.workspace.getConfiguration("files",e);return{trimTrailingWhitespace:t.get("trimTrailingWhitespace"),trimFinalNewlines:t.get("trimFinalNewlines"),insertFinalNewline:t.get("insertFinalNewline")}}}(Nr||(Nr={}));qr.DocumentFormattingFeature=class extends Mr.TextDocumentLanguageFeature{constructor(e){super(e,Or.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,Mr.ensure)((0,Mr.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.documentFormattingProvider);n&&this.register({id:Er.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n={provideDocumentFormattingEdits:(e,t,n)=>{const i=this._client,o=(e,t,n)=>{const o={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),options:i.code2ProtocolConverter.asFormattingOptions(t,Nr.fromConfiguration(e))};return i.sendRequest(Or.DocumentFormattingRequest.type,o,n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asTextEdits(e,n)),(e=>i.handleFailedRequest(Or.DocumentFormattingRequest.type,n,e,null)))},r=i.middleware;return r.provideDocumentFormattingEdits?r.provideDocumentFormattingEdits(e,t,n,o):o(e,t,n)}};return[Fr.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};qr.DocumentRangeFormattingFeature=class extends Mr.TextDocumentLanguageFeature{constructor(e){super(e,Or.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){(0,Mr.ensure)((0,Mr.ensure)(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);n&&this.register({id:Er.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n={provideDocumentRangeFormattingEdits:(e,t,n,i)=>{const o=this._client,r=(e,t,n,i)=>{const r={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),range:o.code2ProtocolConverter.asRange(t),options:o.code2ProtocolConverter.asFormattingOptions(n,Nr.fromConfiguration(e))};return o.sendRequest(Or.DocumentRangeFormattingRequest.type,r,i).then((e=>i.isCancellationRequested?null:o.protocol2CodeConverter.asTextEdits(e,i)),(e=>o.handleFailedRequest(Or.DocumentRangeFormattingRequest.type,i,e,null)))},s=o.middleware;return s.provideDocumentRangeFormattingEdits?s.provideDocumentRangeFormattingEdits(e,t,n,i,r):r(e,t,n,i)}};return[Fr.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};qr.DocumentOnTypeFormattingFeature=class extends Mr.TextDocumentLanguageFeature{constructor(e){super(e,Or.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,Mr.ensure)((0,Mr.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);n&&this.register({id:Er.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n={provideOnTypeFormattingEdits:(e,t,n,i,o)=>{const r=this._client,s=(e,t,n,i,o)=>{let s={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e),position:r.code2ProtocolConverter.asPosition(t),ch:n,options:r.code2ProtocolConverter.asFormattingOptions(i,Nr.fromConfiguration(e))};return r.sendRequest(Or.DocumentOnTypeFormattingRequest.type,s,o).then((e=>o.isCancellationRequested?null:r.protocol2CodeConverter.asTextEdits(e,o)),(e=>r.handleFailedRequest(Or.DocumentOnTypeFormattingRequest.type,o,e,null)))},a=r.middleware;return a.provideOnTypeFormattingEdits?a.provideOnTypeFormattingEdits(e,t,n,i,o,s):s(e,t,n,i,o)}},i=e.moreTriggerCharacter||[];return[Fr.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n,e.firstTriggerCharacter,...i),n]}};var Ir={};Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.RenameFeature=void 0;const Lr=s,jr=c,Ar=ai,Hr=Qt,Kr=vi;Ir.RenameFeature=class extends Kr.TextDocumentLanguageFeature{constructor(e){super(e,jr.RenameRequest.type)}fillClientCapabilities(e){let t=(0,Kr.ensure)((0,Kr.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=jr.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.renameProvider);n&&(Hr.boolean(e.renameProvider)&&(n.prepareProvider=!1),this.register({id:Ar.generateUuid(),registerOptions:n}))}registerLanguageProvider(e){const t=e.documentSelector,n={provideRenameEdits:(e,t,n,i)=>{const o=this._client,r=(e,t,n,i)=>{let r={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),position:o.code2ProtocolConverter.asPosition(t),newName:n};return o.sendRequest(jr.RenameRequest.type,r,i).then((e=>i.isCancellationRequested?null:o.protocol2CodeConverter.asWorkspaceEdit(e,i)),(e=>o.handleFailedRequest(jr.RenameRequest.type,i,e,null,!1)))},s=o.middleware;return s.provideRenameEdits?s.provideRenameEdits(e,t,n,i,r):r(e,t,n,i)},prepareRename:e.prepareProvider?(e,t,n)=>{const i=this._client,o=(e,t,n)=>{let o={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),position:i.code2ProtocolConverter.asPosition(t)};return i.sendRequest(jr.PrepareRenameRequest.type,o,n).then((e=>n.isCancellationRequested?null:jr.Range.is(e)?i.protocol2CodeConverter.asRange(e):this.isDefaultBehavior(e)?!0===e.defaultBehavior?null:Promise.reject(new Error("The element can't be renamed.")):e&&jr.Range.is(e.range)?{range:i.protocol2CodeConverter.asRange(e.range),placeholder:e.placeholder}:Promise.reject(new Error("The element can't be renamed."))),(e=>{throw"string"==typeof e.message?new Error(e.message):new Error("The element can't be renamed.")}))},r=i.middleware;return r.prepareRename?r.prepareRename(e,t,n,o):o(e,t,n)}:void 0};return[this.registerProvider(t,n),n]}registerProvider(e,t){return Lr.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){const t=e;return t&&Hr.boolean(t.defaultBehavior)}};var Wr={};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.DocumentLinkFeature=void 0;const Ur=s,zr=c,$r=vi,Vr=ai;Wr.DocumentLinkFeature=class extends $r.TextDocumentLanguageFeature{constructor(e){super(e,zr.DocumentLinkRequest.type)}fillClientCapabilities(e){const t=(0,$r.ensure)((0,$r.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){const n=this.getRegistrationOptions(t,e.documentLinkProvider);n&&this.register({id:Vr.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,n={provideDocumentLinks:(e,t)=>{const n=this._client,i=(e,t)=>n.sendRequest(zr.DocumentLinkRequest.type,n.code2ProtocolConverter.asDocumentLinkParams(e),t).then((e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asDocumentLinks(e,t)),(e=>n.handleFailedRequest(zr.DocumentLinkRequest.type,t,e,null))),o=n.middleware;return o.provideDocumentLinks?o.provideDocumentLinks(e,t,i):i(e,t)},resolveDocumentLink:e.resolveProvider?(e,t)=>{const n=this._client;let i=(e,t)=>n.sendRequest(zr.DocumentLinkResolveRequest.type,n.code2ProtocolConverter.asDocumentLink(e),t).then((i=>t.isCancellationRequested?e:n.protocol2CodeConverter.asDocumentLink(i)),(i=>n.handleFailedRequest(zr.DocumentLinkResolveRequest.type,t,i,e)));const o=n.middleware;return o.resolveDocumentLink?o.resolveDocumentLink(e,t,i):i(e,t)}:void 0};return[Ur.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};var Br={};Object.defineProperty(Br,"__esModule",{value:!0}),Br.ExecuteCommandFeature=void 0;const Jr=s,Xr=c,Qr=ai,Gr=vi;Br.ExecuteCommandFeature=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return Xr.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,Gr.ensure)((0,Gr.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:Qr.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){const t=this._client,n=t.middleware,i=(e,n)=>{let i={command:e,arguments:n};return t.sendRequest(Xr.ExecuteCommandRequest.type,i).then(void 0,(e=>t.handleFailedRequest(Xr.ExecuteCommandRequest.type,void 0,e,void 0)))};if(e.registerOptions.commands){const t=[];for(const o of e.registerOptions.commands)t.push(Jr.commands.registerCommand(o,((...e)=>n.executeCommand?n.executeCommand(o,e,i):i(o,e))));this._commands.set(e.id,t)}}unregister(e){let t=this._commands.get(e);t&&t.forEach((e=>e.dispose()))}dispose(){this._commands.forEach((e=>{e.forEach((e=>e.dispose()))})),this._commands.clear()}};var Yr={};Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.FileSystemWatcherFeature=void 0;const Zr=s,es=c,ts=vi;Yr.FileSystemWatcherFeature=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return es.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,ts.ensure)((0,ts.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,ts.ensure)((0,ts.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;const t=[];for(const n of e.registerOptions.watchers){const e=this._client.protocol2CodeConverter.asGlobPattern(n.globPattern);if(void 0===e)continue;let i=!0,o=!0,r=!0;void 0!==n.kind&&null!==n.kind&&(i=0!=(n.kind&es.WatchKind.Create),o=0!=(n.kind&es.WatchKind.Change),r=0!=(n.kind&es.WatchKind.Delete));const s=Zr.workspace.createFileSystemWatcher(e,!i,!o,!r);this.hookListeners(s,i,o,r,t),t.push(s)}this._watchers.set(e.id,t)}registerRaw(e,t){let n=[];for(let i of t)this.hookListeners(i,!0,!0,!0,n);this._watchers.set(e,n)}hookListeners(e,t,n,i,o){t&&e.onDidCreate((e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:es.FileChangeType.Created})),null,o),n&&e.onDidChange((e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:es.FileChangeType.Changed})),null,o),i&&e.onDidDelete((e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:es.FileChangeType.Deleted})),null,o)}unregister(e){let t=this._watchers.get(e);if(t)for(let n of t)n.dispose()}dispose(){this._watchers.forEach((e=>{for(let t of e)t.dispose()})),this._watchers.clear()}};var ns={};Object.defineProperty(ns,"__esModule",{value:!0}),ns.ColorProviderFeature=void 0;const is=s,os=c,rs=vi;ns.ColorProviderFeature=class extends rs.TextDocumentLanguageFeature{constructor(e){super(e,os.DocumentColorRequest.type)}fillClientCapabilities(e){(0,rs.ensure)((0,rs.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.colorProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n={provideColorPresentations:(e,t,n)=>{const i=this._client,o=(e,t,n)=>{const o={color:e,textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(t.document),range:i.code2ProtocolConverter.asRange(t.range)};return i.sendRequest(os.ColorPresentationRequest.type,o,n).then((e=>n.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(e,n)),(e=>i.handleFailedRequest(os.ColorPresentationRequest.type,n,e,null)))},r=i.middleware;return r.provideColorPresentations?r.provideColorPresentations(e,t,n,o):o(e,t,n)},provideDocumentColors:(e,t)=>{const n=this._client,i=(e,t)=>{const i={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e)};return n.sendRequest(os.DocumentColorRequest.type,i,t).then((e=>t.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(e,t)),(e=>n.handleFailedRequest(os.DocumentColorRequest.type,t,e,null)))},o=n.middleware;return o.provideDocumentColors?o.provideDocumentColors(e,t,i):i(e,t)}};return[is.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};var ss={};Object.defineProperty(ss,"__esModule",{value:!0}),ss.ImplementationFeature=void 0;const as=s,cs=c,us=vi;ss.ImplementationFeature=class extends us.TextDocumentLanguageFeature{constructor(e){super(e,cs.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,us.ensure)((0,us.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.implementationProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n={provideImplementation:(e,t,n)=>{const i=this._client,o=(e,t,n)=>i.sendRequest(cs.ImplementationRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDefinitionResult(e,n)),(e=>i.handleFailedRequest(cs.ImplementationRequest.type,n,e,null))),r=i.middleware;return r.provideImplementation?r.provideImplementation(e,t,n,o):o(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return as.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};var ls={};Object.defineProperty(ls,"__esModule",{value:!0}),ls.TypeDefinitionFeature=void 0;const ds=s,gs=c,hs=vi;ls.TypeDefinitionFeature=class extends hs.TextDocumentLanguageFeature{constructor(e){super(e,gs.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,hs.ensure)((0,hs.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,hs.ensure)((0,hs.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.typeDefinitionProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n={provideTypeDefinition:(e,t,n)=>{const i=this._client,o=(e,t,n)=>i.sendRequest(gs.TypeDefinitionRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDefinitionResult(e,n)),(e=>i.handleFailedRequest(gs.TypeDefinitionRequest.type,n,e,null))),r=i.middleware;return r.provideTypeDefinition?r.provideTypeDefinition(e,t,n,o):o(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return ds.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};var ps={};Object.defineProperty(ps,"__esModule",{value:!0}),ps.WorkspaceFoldersFeature=ps.arrayDiff=void 0;const ms=ai,fs=s,vs=c;function ys(e,t){if(null!=e)return e[t]}function Cs(e,t){return e.filter((e=>t.indexOf(e)<0))}ps.arrayDiff=Cs;ps.WorkspaceFoldersFeature=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return vs.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){const t=fs.workspace.workspaceFolders;this.initializeWithFolders(t),e.workspaceFolders=void 0===t?null:t.map((e=>this.asProtocol(e)))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){const t=this._client;t.onRequest(vs.WorkspaceFoldersRequest.type,(e=>{const n=()=>{const e=fs.workspace.workspaceFolders;if(void 0===e)return null;return e.map((e=>this.asProtocol(e)))},i=t.middleware.workspace;return i&&i.workspaceFolders?i.workspaceFolders(e,n):n()}));const n=ys(ys(ys(e,"workspace"),"workspaceFolders"),"changeNotifications");let i;"string"==typeof n?i=n:!0===n&&(i=ms.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){const n=Cs(this._initialFolders,e),i=Cs(e,this._initialFolders);(i.length>0||n.length>0)&&(t=this.doSendEvent(i,n))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));void 0!==t&&t.catch((e=>{this._client.error(`Sending notification ${vs.DidChangeWorkspaceFoldersNotification.type.method} failed`,e)}))}doSendEvent(e,t){let n={event:{added:e.map((e=>this.asProtocol(e))),removed:t.map((e=>this.asProtocol(e)))}};return this._client.sendNotification(vs.DidChangeWorkspaceFoldersNotification.type,n)}register(e){let t=e.id,n=this._client,i=fs.workspace.onDidChangeWorkspaceFolders((e=>{let t=e=>this.doSendEvent(e.added,e.removed),i=n.middleware.workspace;(i&&i.didChangeWorkspaceFolders?i.didChangeWorkspaceFolders(e,t):t(e)).catch((e=>{this._client.error(`Sending notification ${vs.DidChangeWorkspaceFoldersNotification.type.method} failed`,e)}))}));this._listeners.set(t,i),this.sendInitialEvent(fs.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);void 0!==t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return void 0===e?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};var Ds={};Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.FoldingRangeFeature=void 0;const Rs=s,bs=c,Ss=vi;Ds.FoldingRangeFeature=class extends Ss.TextDocumentLanguageFeature{constructor(e){super(e,bs.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,Ss.ensure)((0,Ss.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[bs.FoldingRangeKind.Comment,bs.FoldingRangeKind.Imports,bs.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1}}initialize(e,t){let[n,i]=this.getRegistration(t,e.foldingRangeProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n={provideFoldingRanges:(e,t,n)=>{const i=this._client,o=(e,t,n)=>{const o={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(bs.FoldingRangeRequest.type,o,n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asFoldingRanges(e,n)),(e=>i.handleFailedRequest(bs.FoldingRangeRequest.type,n,e,null)))},r=i.middleware;return r.provideFoldingRanges?r.provideFoldingRanges(e,t,n,o):o(e,0,n)}};return[Rs.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};var Ts={};Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.DeclarationFeature=void 0;const ws=s,_s=c,ks=vi;Ts.DeclarationFeature=class extends ks.TextDocumentLanguageFeature{constructor(e){super(e,_s.DeclarationRequest.type)}fillClientCapabilities(e){const t=(0,ks.ensure)((0,ks.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const[n,i]=this.getRegistration(t,e.declarationProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n={provideDeclaration:(e,t,n)=>{const i=this._client,o=(e,t,n)=>i.sendRequest(_s.DeclarationRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDeclarationResult(e,n)),(e=>i.handleFailedRequest(_s.DeclarationRequest.type,n,e,null))),r=i.middleware;return r.provideDeclaration?r.provideDeclaration(e,t,n,o):o(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return ws.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};var Ps={};Object.defineProperty(Ps,"__esModule",{value:!0}),Ps.SelectionRangeFeature=void 0;const xs=s,qs=c,Fs=vi;Ps.SelectionRangeFeature=class extends Fs.TextDocumentLanguageFeature{constructor(e){super(e,qs.SelectionRangeRequest.type)}fillClientCapabilities(e){(0,Fs.ensure)((0,Fs.ensure)(e,"textDocument"),"selectionRange").dynamicRegistration=!0}initialize(e,t){const[n,i]=this.getRegistration(t,e.selectionRangeProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n={provideSelectionRanges:(e,t,n)=>{const i=this._client,o=async(e,t,n)=>{const o={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),positions:await i.code2ProtocolConverter.asPositions(t,n)};return i.sendRequest(qs.SelectionRangeRequest.type,o,n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asSelectionRanges(e,n)),(e=>i.handleFailedRequest(qs.SelectionRangeRequest.type,n,e,null)))},r=i.middleware;return r.provideSelectionRanges?r.provideSelectionRanges(e,t,n,o):o(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return xs.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};var Os={};Object.defineProperty(Os,"__esModule",{value:!0}),Os.ProgressFeature=void 0;const Es=c,Ms=hi;Os.ProgressFeature=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:Es.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){var t,n;(t=e,n="window",void 0===t[n]&&(t[n]=Object.create(null)),t[n]).workDoneProgress=!0}initialize(){const e=this._client,t=e=>{this.activeParts.delete(e)};e.onRequest(Es.WorkDoneProgressCreateRequest.type,(e=>{this.activeParts.add(new Ms.ProgressPart(this._client,e.token,t))}))}dispose(){for(const e of this.activeParts)e.done();this.activeParts.clear()}};var Ns={};Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.CallHierarchyFeature=void 0;const Is=s,Ls=c,js=vi;class As{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,n){const i=this.client,o=this.middleware,r=(e,t,n)=>{const o=i.code2ProtocolConverter.asTextDocumentPositionParams(e,t);return i.sendRequest(Ls.CallHierarchyPrepareRequest.type,o,n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(e,n)),(e=>i.handleFailedRequest(Ls.CallHierarchyPrepareRequest.type,n,e,null)))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,n,r):r(e,t,n)}provideCallHierarchyIncomingCalls(e,t){const n=this.client,i=this.middleware,o=(e,t)=>{const i={item:n.code2ProtocolConverter.asCallHierarchyItem(e)};return n.sendRequest(Ls.CallHierarchyIncomingCallsRequest.type,i,t).then((e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asCallHierarchyIncomingCalls(e,t)),(e=>n.handleFailedRequest(Ls.CallHierarchyIncomingCallsRequest.type,t,e,null)))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){const n=this.client,i=this.middleware,o=(e,t)=>{const i={item:n.code2ProtocolConverter.asCallHierarchyItem(e)};return n.sendRequest(Ls.CallHierarchyOutgoingCallsRequest.type,i,t).then((e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asCallHierarchyOutgoingCalls(e,t)),(e=>n.handleFailedRequest(Ls.CallHierarchyOutgoingCallsRequest.type,t,e,null)))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}}Ns.CallHierarchyFeature=class extends js.TextDocumentLanguageFeature{constructor(e){super(e,Ls.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){(0,js.ensure)((0,js.ensure)(e,"textDocument"),"callHierarchy").dynamicRegistration=!0}initialize(e,t){const[n,i]=this.getRegistration(t,e.callHierarchyProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=this._client,n=new As(t);return[Is.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),n),n]}};var Hs={};Object.defineProperty(Hs,"__esModule",{value:!0}),Hs.SemanticTokensFeature=void 0;const Ks=s,Ws=c,Us=vi,zs=Qt;Hs.SemanticTokensFeature=class extends Us.TextDocumentLanguageFeature{constructor(e){super(e,Ws.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){const t=(0,Us.ensure)((0,Us.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[Ws.SemanticTokenTypes.namespace,Ws.SemanticTokenTypes.type,Ws.SemanticTokenTypes.class,Ws.SemanticTokenTypes.enum,Ws.SemanticTokenTypes.interface,Ws.SemanticTokenTypes.struct,Ws.SemanticTokenTypes.typeParameter,Ws.SemanticTokenTypes.parameter,Ws.SemanticTokenTypes.variable,Ws.SemanticTokenTypes.property,Ws.SemanticTokenTypes.enumMember,Ws.SemanticTokenTypes.event,Ws.SemanticTokenTypes.function,Ws.SemanticTokenTypes.method,Ws.SemanticTokenTypes.macro,Ws.SemanticTokenTypes.keyword,Ws.SemanticTokenTypes.modifier,Ws.SemanticTokenTypes.comment,Ws.SemanticTokenTypes.string,Ws.SemanticTokenTypes.number,Ws.SemanticTokenTypes.regexp,Ws.SemanticTokenTypes.operator,Ws.SemanticTokenTypes.decorator],t.tokenModifiers=[Ws.SemanticTokenModifiers.declaration,Ws.SemanticTokenModifiers.definition,Ws.SemanticTokenModifiers.readonly,Ws.SemanticTokenModifiers.static,Ws.SemanticTokenModifiers.deprecated,Ws.SemanticTokenModifiers.abstract,Ws.SemanticTokenModifiers.async,Ws.SemanticTokenModifiers.modification,Ws.SemanticTokenModifiers.documentation,Ws.SemanticTokenModifiers.defaultLibrary],t.formats=[Ws.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,Us.ensure)((0,Us.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ws.SemanticTokensRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeSemanticTokensEmitter.fire()}));const[n,i]=this.getRegistration(t,e.semanticTokensProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n=zs.boolean(e.full)?e.full:void 0!==e.full,i=void 0!==e.full&&"boolean"!=typeof e.full&&!0===e.full.delta,o=new Ks.EventEmitter,r=n?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(e,t)=>{const n=this._client,i=n.middleware,o=(e,t)=>{const i={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e)};return n.sendRequest(Ws.SemanticTokensRequest.type,i,t).then((e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asSemanticTokens(e,t)),(e=>n.handleFailedRequest(Ws.SemanticTokensRequest.type,t,e,null)))};return i.provideDocumentSemanticTokens?i.provideDocumentSemanticTokens(e,t,o):o(e,t)},provideDocumentSemanticTokensEdits:i?(e,t,n)=>{const i=this._client,o=i.middleware,r=(e,t,n)=>{const o={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),previousResultId:t};return i.sendRequest(Ws.SemanticTokensDeltaRequest.type,o,n).then((async e=>n.isCancellationRequested?null:Ws.SemanticTokens.is(e)?await i.protocol2CodeConverter.asSemanticTokens(e,n):await i.protocol2CodeConverter.asSemanticTokensEdits(e,n)),(e=>i.handleFailedRequest(Ws.SemanticTokensDeltaRequest.type,n,e,null)))};return o.provideDocumentSemanticTokensEdits?o.provideDocumentSemanticTokensEdits(e,t,n,r):r(e,t,n)}:void 0}:void 0,s=!0===e.range?{provideDocumentRangeSemanticTokens:(e,t,n)=>{const i=this._client,o=i.middleware,r=(e,t,n)=>{const o={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),range:i.code2ProtocolConverter.asRange(t)};return i.sendRequest(Ws.SemanticTokensRangeRequest.type,o,n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asSemanticTokens(e,n)),(e=>i.handleFailedRequest(Ws.SemanticTokensRangeRequest.type,n,e,null)))};return o.provideDocumentRangeSemanticTokens?o.provideDocumentRangeSemanticTokens(e,t,n,r):r(e,t,n)}}:void 0,a=[],c=this._client,u=c.protocol2CodeConverter.asSemanticTokensLegend(e.legend),l=c.protocol2CodeConverter.asDocumentSelector(t);return void 0!==r&&a.push(Ks.languages.registerDocumentSemanticTokensProvider(l,r,u)),void 0!==s&&a.push(Ks.languages.registerDocumentRangeSemanticTokensProvider(l,s,u)),[new Ks.Disposable((()=>a.forEach((e=>e.dispose())))),{range:s,full:r,onDidChangeSemanticTokensEmitter:o}]}};var $s={};Object.defineProperty($s,"__esModule",{value:!0}),$s.WillDeleteFilesFeature=$s.WillRenameFilesFeature=$s.WillCreateFilesFeature=$s.DidDeleteFilesFeature=$s.DidRenameFilesFeature=$s.DidCreateFilesFeature=void 0;const Vs=s,Bs=Hi,Js=c,Xs=ai;function Qs(e,t){return void 0===e[t]&&(e[t]={}),e[t]}function Gs(e,t,n){e[t]=n}class Ys{constructor(e,t,n,i,o){this._client=e,this._event=t,this._registrationType=n,this._clientCapability=i,this._serverCapability=o,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){const t=Qs(Qs(e,"workspace"),"fileOperations");Gs(t,"dynamicRegistration",!0),Gs(t,this._clientCapability,!0)}initialize(e){const t=e.workspace?.fileOperations,n=void 0!==t?(i=t,o=this._serverCapability,i[o]):void 0;var i,o;if(void 0!==n?.filters)try{this.register({id:Xs.generateUuid(),registerOptions:{filters:n.filters}})}catch(r){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${r}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));const t=e.registerOptions.filters.map((e=>{const t=new Bs.Minimatch(e.pattern.glob,Ys.asMinimatchOptions(e.pattern.options));if(!t.makeRe())throw new Error(`Invalid pattern ${e.pattern.glob}!`);return{scheme:e.scheme,matcher:t,kind:e.pattern.matches}}));this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),0===this._filters.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return Ys.getFileType(e)}async filter(e,t){const n=await Promise.all(e.files.map((async e=>{const n=t(e),i=n.fsPath.replace(/\\/g,"/");for(const t of this._filters.values())for(const e of t)if(void 0===e.scheme||e.scheme===n.scheme)if(e.matcher.match(i)){if(void 0===e.kind)return!0;const t=await this.getFileType(n);if(void 0===t)return this._client.error(`Failed to determine file type for ${n.toString()}.`),!0;if(t===Vs.FileType.File&&e.kind===Js.FileOperationPatternKind.file||t===Vs.FileType.Directory&&e.kind===Js.FileOperationPatternKind.folder)return!0}else if(e.kind===Js.FileOperationPatternKind.folder){if(await Ys.getFileType(n)===Vs.FileType.Directory&&e.matcher.match(`${i}/`))return!0}return!1}))),i=e.files.filter(((e,t)=>n[t]));return{...e,files:i}}static async getFileType(e){try{return(await Vs.workspace.fs.stat(e)).type}catch(t){return}}static asMinimatchOptions(e){if(void 0!==e)return!0===e.ignoreCase?{nocase:!0}:void 0}}class Zs extends Ys{constructor(e,t,n,i,o,r,s){super(e,t,n,i,o),this._notificationType=n,this._accessUri=r,this._createParams=s}async send(e){const t=await this.filter(e,this._accessUri);if(t.files.length){const e=async e=>this._client.sendNotification(this._notificationType,this._createParams(e));return this.doSend(t,e)}}}class ea extends Zs{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){const t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);const n=await Ys.getFileType(e);return n&&this._fsPathFileTypes.set(t,n),n}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),0===this.filterSize()&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}dispose(){super.dispose(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}}$s.DidCreateFilesFeature=class extends Zs{constructor(e){super(e,Vs.workspace.onDidCreateFiles,Js.DidCreateFilesNotification.type,"didCreate","didCreate",(e=>e),e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){const n=this._client.middleware.workspace;return n?.didCreateFiles?n.didCreateFiles(e,t):t(e)}};$s.DidRenameFilesFeature=class extends ea{constructor(e){super(e,Vs.workspace.onDidRenameFiles,Js.DidRenameFilesNotification.type,"didRename","didRename",(e=>e.oldUri),e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=Vs.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,(e=>e.oldUri)))}doSend(e,t){this.clearFileTypeCache();const n=this._client.middleware.workspace;return n?.didRenameFiles?n.didRenameFiles(e,t):t(e)}};$s.DidDeleteFilesFeature=class extends ea{constructor(e){super(e,Vs.workspace.onDidDeleteFiles,Js.DidDeleteFilesNotification.type,"didDelete","didDelete",(e=>e),e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=Vs.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,(e=>e)))}doSend(e,t){this.clearFileTypeCache();const n=this._client.middleware.workspace;return n?.didDeleteFiles?n.didDeleteFiles(e,t):t(e)}};class ta extends Ys{constructor(e,t,n,i,o,r,s){super(e,t,n,i,o),this._requestType=n,this._accessUri=r,this._createParams=s}async send(e){const t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){const t=await this.filter(e,this._accessUri);if(t.files.length){const e=e=>this._client.sendRequest(this._requestType,this._createParams(e),e.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,e)}}}$s.WillCreateFilesFeature=class extends ta{constructor(e){super(e,Vs.workspace.onWillCreateFiles,Js.WillCreateFilesRequest.type,"willCreate","willCreate",(e=>e),e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){const n=this._client.middleware.workspace;return n?.willCreateFiles?n.willCreateFiles(e,t):t(e)}};$s.WillRenameFilesFeature=class extends ta{constructor(e){super(e,Vs.workspace.onWillRenameFiles,Js.WillRenameFilesRequest.type,"willRename","willRename",(e=>e.oldUri),e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){const n=this._client.middleware.workspace;return n?.willRenameFiles?n.willRenameFiles(e,t):t(e)}};$s.WillDeleteFilesFeature=class extends ta{constructor(e){super(e,Vs.workspace.onWillDeleteFiles,Js.WillDeleteFilesRequest.type,"willDelete","willDelete",(e=>e),e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){const n=this._client.middleware.workspace;return n?.willDeleteFiles?n.willDeleteFiles(e,t):t(e)}};var na={};Object.defineProperty(na,"__esModule",{value:!0}),na.LinkedEditingFeature=void 0;const ia=s,oa=c,ra=vi;na.LinkedEditingFeature=class extends ra.TextDocumentLanguageFeature{constructor(e){super(e,oa.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){(0,ra.ensure)((0,ra.ensure)(e,"textDocument"),"linkedEditingRange").dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.linkedEditingRangeProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n={provideLinkedEditingRanges:(e,t,n)=>{const i=this._client,o=(e,t,n)=>i.sendRequest(oa.LinkedEditingRangeRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asLinkedEditingRanges(e,n)),(e=>i.handleFailedRequest(oa.LinkedEditingRangeRequest.type,n,e,null))),r=i.middleware;return r.provideLinkedEditingRange?r.provideLinkedEditingRange(e,t,n,o):o(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return ia.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};var sa={};Object.defineProperty(sa,"__esModule",{value:!0}),sa.TypeHierarchyFeature=void 0;const aa=s,ca=c,ua=vi;class la{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,n){const i=this.client,o=this.middleware,r=(e,t,n)=>{const o=i.code2ProtocolConverter.asTextDocumentPositionParams(e,t);return i.sendRequest(ca.TypeHierarchyPrepareRequest.type,o,n).then((e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(e,n)),(e=>i.handleFailedRequest(ca.TypeHierarchyPrepareRequest.type,n,e,null)))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,t,n,r):r(e,t,n)}provideTypeHierarchySupertypes(e,t){const n=this.client,i=this.middleware,o=(e,t)=>{const i={item:n.code2ProtocolConverter.asTypeHierarchyItem(e)};return n.sendRequest(ca.TypeHierarchySupertypesRequest.type,i,t).then((e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asTypeHierarchyItems(e,t)),(e=>n.handleFailedRequest(ca.TypeHierarchySupertypesRequest.type,t,e,null)))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,o):o(e,t)}provideTypeHierarchySubtypes(e,t){const n=this.client,i=this.middleware,o=(e,t)=>{const i={item:n.code2ProtocolConverter.asTypeHierarchyItem(e)};return n.sendRequest(ca.TypeHierarchySubtypesRequest.type,i,t).then((e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asTypeHierarchyItems(e,t)),(e=>n.handleFailedRequest(ca.TypeHierarchySubtypesRequest.type,t,e,null)))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,o):o(e,t)}}sa.TypeHierarchyFeature=class extends ua.TextDocumentLanguageFeature{constructor(e){super(e,ca.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){(0,ua.ensure)((0,ua.ensure)(e,"textDocument"),"typeHierarchy").dynamicRegistration=!0}initialize(e,t){const[n,i]=this.getRegistration(t,e.typeHierarchyProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=this._client,n=new la(t);return[aa.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),n),n]}};var da={};Object.defineProperty(da,"__esModule",{value:!0}),da.InlineValueFeature=void 0;const ga=s,ha=c,pa=vi;da.InlineValueFeature=class extends pa.TextDocumentLanguageFeature{constructor(e){super(e,ha.InlineValueRequest.type)}fillClientCapabilities(e){(0,pa.ensure)((0,pa.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,pa.ensure)((0,pa.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(ha.InlineValueRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeInlineValues.fire()}));const[n,i]=this.getRegistration(t,e.inlineValueProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n=new ga.EventEmitter,i={onDidChangeInlineValues:n.event,provideInlineValues:(e,t,n,i)=>{const o=this._client,r=(e,t,n,i)=>{const r={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),range:o.code2ProtocolConverter.asRange(t),context:o.code2ProtocolConverter.asInlineValueContext(n)};return o.sendRequest(ha.InlineValueRequest.type,r,i).then((e=>i.isCancellationRequested?null:o.protocol2CodeConverter.asInlineValues(e,i)),(e=>o.handleFailedRequest(ha.InlineValueRequest.type,i,e,null)))},s=o.middleware;return s.provideInlineValues?s.provideInlineValues(e,t,n,i,r):r(e,t,n,i)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:n}]}registerProvider(e,t){return ga.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};var ma={};Object.defineProperty(ma,"__esModule",{value:!0}),ma.InlayHintsFeature=void 0;const fa=s,va=c,ya=vi;ma.InlayHintsFeature=class extends ya.TextDocumentLanguageFeature{constructor(e){super(e,va.InlayHintRequest.type)}fillClientCapabilities(e){const t=(0,ya.ensure)((0,ya.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,ya.ensure)((0,ya.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(va.InlayHintRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeInlayHints.fire()}));const[n,i]=this.getRegistration(t,e.inlayHintProvider);n&&i&&this.register({id:n,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,n=new fa.EventEmitter,i={onDidChangeInlayHints:n.event,provideInlayHints:(e,t,n)=>{const i=this._client,o=async(e,t,n)=>{const o={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),range:i.code2ProtocolConverter.asRange(t)};try{const e=await i.sendRequest(va.InlayHintRequest.type,o,n);return n.isCancellationRequested?null:i.protocol2CodeConverter.asInlayHints(e,n)}catch(r){return i.handleFailedRequest(va.InlayHintRequest.type,n,r,null)}},r=i.middleware;return r.provideInlayHints?r.provideInlayHints(e,t,n,o):o(e,t,n)}};return i.resolveInlayHint=!0===e.resolveProvider?(e,t)=>{const n=this._client,i=async(e,t)=>{try{const i=await n.sendRequest(va.InlayHintResolveRequest.type,n.code2ProtocolConverter.asInlayHint(e),t);if(t.isCancellationRequested)return null;const o=n.protocol2CodeConverter.asInlayHint(i,t);return t.isCancellationRequested?null:o}catch(i){return n.handleFailedRequest(va.InlayHintResolveRequest.type,t,i,null)}},o=n.middleware;return o.resolveInlayHint?o.resolveInlayHint(e,t,i):i(e,t)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:n}]}registerProvider(e,t){return fa.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProposedFeatures=e.BaseLanguageClient=e.MessageTransports=e.SuspendMode=e.State=e.CloseAction=e.ErrorAction=e.RevealOutputChannelOn=void 0;const t=s,n=c,i=Xt,o=$n,r=Qt,a=tn,u=ai,l=hi,d=vi,g=yi,h=io,p=yo,m=wo,f=Io,v=Wo,y=Bo,C=Yo,D=ir,R=cr,b=ur,S=mr,T=Dr,w=wr,_=qr,k=Ir,P=Wr,x=Br,q=Yr,F=ns,O=ss,E=ls,M=ps,N=Ds,I=Ts,L=Ps,j=Os,A=Ns,H=Hs,K=$s,W=na,U=sa,z=da,$=ma;var V,B,J,X,Q,G,Y;!function(e){e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Never=4]="Never"}(V=e.RevealOutputChannelOn||(e.RevealOutputChannelOn={})),function(e){e[e.Continue=1]="Continue",e[e.Shutdown=2]="Shutdown"}(B=e.ErrorAction||(e.ErrorAction={})),function(e){e[e.DoNotRestart=1]="DoNotRestart",e[e.Restart=2]="Restart"}(J=e.CloseAction||(e.CloseAction={})),function(e){e[e.Stopped=1]="Stopped",e[e.Starting=3]="Starting",e[e.Running=2]="Running"}(X=e.State||(e.State={})),(Q=e.SuspendMode||(e.SuspendMode={})).off="off",Q.on="on";class Z{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,n){return n&&n<=3?{action:B.Continue}:{action:B.Shutdown}}closed(){if(this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount)return{action:J.Restart};return this.restarts[this.restarts.length-1]-this.restarts[0]<=18e4?{action:J.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:J.Restart})}}!function(e){e.Initial="initial",e.Starting="starting",e.StartFailed="startFailed",e.Running="running",e.Stopping="stopping",e.Stopped="stopped"}(G||(G={})),(e.MessageTransports||(e.MessageTransports={})).is=function(e){return e&&n.MessageReader.is(e.reader)&&n.MessageWriter.is(e.writer)};class ee{constructor(e,t,s){this._traceFormat=n.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new a.Semaphore(1),this._id=e,this._name=t;const c={isTrusted:!1,supportHtml:!1};void 0!==(s=s||{}).markdown&&(c.isTrusted=!0===s.markdown.isTrusted,c.supportHtml=!0===s.markdown.supportHtml),this._clientOptions={documentSelector:s.documentSelector??[],synchronize:s.synchronize??{},diagnosticCollectionName:s.diagnosticCollectionName,outputChannelName:s.outputChannelName??this._name,revealOutputChannelOn:s.revealOutputChannelOn??V.Error,stdioEncoding:s.stdioEncoding??"utf8",initializationOptions:s.initializationOptions,initializationFailedHandler:s.initializationFailedHandler,progressOnInitialization:!!s.progressOnInitialization,errorHandler:s.errorHandler??this.createDefaultErrorHandler(s.connectionOptions?.maxRestartCount),middleware:s.middleware??{},uriConverters:s.uriConverters,workspaceFolder:s.workspaceFolder,connectionOptions:s.connectionOptions,markdown:c,diagnosticPullOptions:s.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:s.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=G.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,s.outputChannel?(this._outputChannel=s.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=s.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new a.Semaphore(1),this._pendingChangeDelayer=new a.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new a.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new n.Emitter,this._stateChangeEmitter=new n.Emitter,this._trace=n.Trace.Off,this._tracer={log:(e,t)=>{r.string(e)?this.logTrace(e,t):this.logObjectTrace(e)}},this._c2p=i.createConverter(s.uriConverters?s.uriConverters.code2Protocol:void 0),this._p2c=o.createConverter(s.uriConverters?s.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=t.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let n=this.getPublicState();n!==t&&this._stateChangeEmitter.fire({oldState:t,newState:n})}getPublicState(){switch(this.$state){case G.Starting:return X.Starting;case G.Running:return X.Running;default:return X.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===G.StartFailed||this.$state===G.Stopping||this.$state===G.Stopped)return Promise.reject(new n.ResponseError(n.ErrorCodes.ConnectionInactive,"Client is not running"));const i=await this.$start();return this._didChangeTextDocumentFeature.syncKind===n.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(i),i.sendRequest(e,...t)}onRequest(e,t){const n="string"==typeof e?e:e.method;this._requestHandlers.set(n,t);const i=this.activeConnection();let o;return void 0!==i?(this._requestDisposables.set(n,i.onRequest(e,t)),o={dispose:()=>{const e=this._requestDisposables.get(n);void 0!==e&&(e.dispose(),this._requestDisposables.delete(n))}}):(this._pendingRequestHandlers.set(n,t),o={dispose:()=>{this._pendingRequestHandlers.delete(n);const e=this._requestDisposables.get(n);void 0!==e&&(e.dispose(),this._requestDisposables.delete(n))}}),{dispose:()=>{this._requestHandlers.delete(n),o.dispose()}}}async sendNotification(e,t){if(this.$state===G.StartFailed||this.$state===G.Stopping||this.$state===G.Stopped)return Promise.reject(new n.ResponseError(n.ErrorCodes.ConnectionInactive,"Client is not running"));const i=this._didChangeTextDocumentFeature.syncKind===n.TextDocumentSyncKind.Full;let o;i&&"string"!=typeof e&&e.method===n.DidOpenTextDocumentNotification.method&&(o=t?.textDocument.uri,this._pendingOpenNotifications.add(o));const r=await this.$start();return i&&await this.sendPendingFullTextDocumentChanges(r),void 0!==o&&this._pendingOpenNotifications.delete(o),r.sendNotification(e,t)}onNotification(e,t){const n="string"==typeof e?e:e.method;this._notificationHandlers.set(n,t);const i=this.activeConnection();let o;return void 0!==i?(this._notificationDisposables.set(n,i.onNotification(e,t)),o={dispose:()=>{const e=this._notificationDisposables.get(n);void 0!==e&&(e.dispose(),this._notificationDisposables.delete(n))}}):(this._pendingNotificationHandlers.set(n,t),o={dispose:()=>{this._pendingNotificationHandlers.delete(n);const e=this._notificationDisposables.get(n);void 0!==e&&(e.dispose(),this._notificationDisposables.delete(n))}}),{dispose:()=>{this._notificationHandlers.delete(n),o.dispose()}}}async sendProgress(e,t,i){if(this.$state===G.StartFailed||this.$state===G.Stopping||this.$state===G.Stopped)return Promise.reject(new n.ResponseError(n.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,i)}catch(o){throw this.error(`Sending progress for token ${t} failed.`,o),o}}onProgress(e,t,i){this._progressHandlers.set(t,{type:e,handler:i});const o=this.activeConnection();let r;const s=this._clientOptions.middleware?.handleWorkDoneProgress,a=n.WorkDoneProgress.is(e)&&void 0!==s?e=>{s(t,e,(()=>i(e)))}:i;return void 0!==o?(this._progressDisposables.set(t,o.onProgress(e,t,a)),r={dispose:()=>{const e=this._progressDisposables.get(t);void 0!==e&&(e.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:i}),r={dispose:()=>{this._pendingProgressHandlers.delete(t);const e=this._progressDisposables.get(t);void 0!==e&&(e.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),r.dispose()}}}createDefaultErrorHandler(e){if(void 0!==e&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new Z(this,e??4)}async setTrace(e){this._trace=e;const t=this.activeConnection();void 0!==t&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof n.ResponseError){const t=e;return`  Message: ${t.message}\n  Code: ${t.code} ${t.data?"\n"+t.data.toString():""}`}return e instanceof Error?r.string(e.stack)?e.stack:e.message:r.string(e)?e:e.toString()}info(e,t,i=!0){this.outputChannel.appendLine(`[Info  - ${(new Date).toLocaleTimeString()}] ${e}`),null!=t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=V.Info&&this.showNotificationMessage(n.MessageType.Info,e)}warn(e,t,i=!0){this.outputChannel.appendLine(`[Warn  - ${(new Date).toLocaleTimeString()}] ${e}`),null!=t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=V.Warn&&this.showNotificationMessage(n.MessageType.Warning,e)}error(e,t,i=!0){this.outputChannel.appendLine(`[Error - ${(new Date).toLocaleTimeString()}] ${e}`),null!=t&&this.outputChannel.appendLine(this.data2String(t)),("force"===i||i&&this._clientOptions.revealOutputChannelOn<=V.Error)&&this.showNotificationMessage(n.MessageType.Error,e)}showNotificationMessage(e,i){i=i??"A request has failed. See the output for more information.";(e===n.MessageType.Error?t.window.showErrorMessage:e===n.MessageType.Warning?t.window.showWarningMessage:t.window.showInformationMessage)(i,"Go to output").then((e=>{void 0!==e&&this.outputChannel.show(!0)}))}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${(new Date).toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${(new Date).toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===G.Initial||this.$state===G.Stopping||this.$state===G.Stopped}needsStop(){return this.$state===G.Starting||this.$state===G.Running}activeConnection(){return this.$state===G.Running&&void 0!==this._connection?this._connection:void 0}isRunning(){return this.$state===G.Running}async start(){if("disposing"===this._disposed||"disposed"===this._disposed)throw new Error("Client got disposed and can't be restarted.");if(this.$state===G.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(void 0!==this._onStart)return this._onStart;const[e,i,o]=this.createOnStartPromise();this._onStart=e,void 0===this._diagnostics&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?t.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):t.languages.createDiagnosticCollection());for(const[t,n]of this._notificationHandlers)this._pendingNotificationHandlers.has(t)||this._pendingNotificationHandlers.set(t,n);for(const[t,n]of this._requestHandlers)this._pendingRequestHandlers.has(t)||this._pendingRequestHandlers.set(t,n);for(const[t,n]of this._progressHandlers)this._pendingProgressHandlers.has(t)||this._pendingProgressHandlers.set(t,n);this.$state=G.Starting;try{const e=await this.createConnection();e.onNotification(n.LogMessageNotification.type,(e=>{switch(e.type){case n.MessageType.Error:this.error(e.message,void 0,!1);break;case n.MessageType.Warning:this.warn(e.message,void 0,!1);break;case n.MessageType.Info:this.info(e.message,void 0,!1);break;default:this.outputChannel.appendLine(e.message)}})),e.onNotification(n.ShowMessageNotification.type,(e=>{switch(e.type){case n.MessageType.Error:t.window.showErrorMessage(e.message);break;case n.MessageType.Warning:t.window.showWarningMessage(e.message);break;case n.MessageType.Info:default:t.window.showInformationMessage(e.message)}})),e.onRequest(n.ShowMessageRequest.type,(e=>{let i;switch(e.type){case n.MessageType.Error:i=t.window.showErrorMessage;break;case n.MessageType.Warning:i=t.window.showWarningMessage;break;case n.MessageType.Info:default:i=t.window.showInformationMessage}let o=e.actions||[];return i(e.message,...o)})),e.onNotification(n.TelemetryEventNotification.type,(e=>{this._telemetryEmitter.fire(e)})),e.onRequest(n.ShowDocumentRequest.type,(async e=>{const n=async e=>{const n=this.protocol2CodeConverter.asUri(e.uri);try{if(!0===e.external){return{success:await t.env.openExternal(n)}}{const i={};return void 0!==e.selection&&(i.selection=this.protocol2CodeConverter.asRange(e.selection)),void 0===e.takeFocus||!1===e.takeFocus?i.preserveFocus=!0:!0===e.takeFocus&&(i.preserveFocus=!1),await t.window.showTextDocument(n,i),{success:!0}}}catch(i){return{success:!1}}},i=this._clientOptions.middleware.window?.showDocument;return void 0!==i?i(e,n):n(e)})),e.listen(),await this.initialize(e),i()}catch(r){this.$state=G.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,r,"force"),o(r)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise(((n,i)=>{e=n,t=i})),e,t]}async initialize(e){this.refreshTrace(e,!1);const i=this._clientOptions.initializationOptions,[o,s]=void 0!==this._clientOptions.workspaceFolder?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],a={processId:null,clientInfo:{name:t.env.appName,version:t.version},locale:this.getLocale(),rootPath:o||null,rootUri:o?this._c2p.asUri(t.Uri.file(o)):null,capabilities:this.computeClientCapabilities(),initializationOptions:r.func(i)?i():i,trace:n.Trace.toString(this._trace),workspaceFolders:s};if(this.fillInitializeParams(a),!this._clientOptions.progressOnInitialization)return this.doInitialize(e,a);{const t=u.generateUuid(),n=new l.ProgressPart(e,t);a.workDoneToken=t;try{const t=await this.doInitialize(e,a);return n.done(),t}catch(c){throw n.cancel(),c}}}async doInitialize(e,i){try{const t=await e.initialize(i);if(void 0!==t.capabilities.positionEncoding&&t.capabilities.positionEncoding!==n.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${t.capabilities.positionEncoding}) received from server ${this.name}`);let o;this._initializeResult=t,this.$state=G.Running,r.number(t.capabilities.textDocumentSync)?o=t.capabilities.textDocumentSync===n.TextDocumentSyncKind.None?{openClose:!1,change:n.TextDocumentSyncKind.None,save:void 0}:{openClose:!0,change:t.capabilities.textDocumentSync,save:{includeText:!1}}:void 0!==t.capabilities.textDocumentSync&&null!==t.capabilities.textDocumentSync&&(o=t.capabilities.textDocumentSync),this._capabilities=Object.assign({},t.capabilities,{resolvedTextDocumentSync:o}),e.onNotification(n.PublishDiagnosticsNotification.type,(e=>this.handleDiagnostics(e))),e.onRequest(n.RegistrationRequest.type,(e=>this.handleRegistrationRequest(e))),e.onRequest("client/registerFeature",(e=>this.handleRegistrationRequest(e))),e.onRequest(n.UnregistrationRequest.type,(e=>this.handleUnregistrationRequest(e))),e.onRequest("client/unregisterFeature",(e=>this.handleUnregistrationRequest(e))),e.onRequest(n.ApplyWorkspaceEditRequest.type,(e=>this.handleApplyWorkspaceEdit(e)));for(const[n,i]of this._pendingNotificationHandlers)this._notificationDisposables.set(n,e.onNotification(n,i));this._pendingNotificationHandlers.clear();for(const[n,i]of this._pendingRequestHandlers)this._requestDisposables.set(n,e.onRequest(n,i));this._pendingRequestHandlers.clear();for(const[n,i]of this._pendingProgressHandlers)this._progressDisposables.set(n,e.onProgress(i.type,n,i.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(n.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),t}catch(o){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(o)?this.initialize(e):this.stop():o instanceof n.ResponseError&&o.data&&o.data.retry?t.window.showErrorMessage(o.message,{title:"Retry",id:"retry"}).then((t=>{t&&"retry"===t.id?this.initialize(e):this.stop()})):(o&&o.message&&t.window.showErrorMessage(o.message),this.error("Server initialization failed.",o),this.stop()),o}}_clientGetRootPath(){let e=t.workspace.workspaceFolders;if(!e||0===e.length)return;let n=e[0];return"file"===n.uri.scheme?n.uri.fsPath:void 0}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===G.Stopped||this.$state===G.Initial)return;if(this.$state===G.Stopping){if(void 0!==this._onStop)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}const i=this.activeConnection();if(void 0===i||this.$state!==G.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=G.Stopping,this.cleanUp(e);const o=new Promise((e=>{(0,n.RAL)().timer.setTimeout(e,t)})),r=(async e=>(await e.shutdown(),await e.exit(),e))(i);return this._onStop=Promise.race([o,r]).then((e=>{if(void 0===e)throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out");e.end(),e.dispose()}),(e=>{throw this.error("Stopping server failed",e,!1),e})).finally((()=>{this.$state=G.Stopped,"stop"===e&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()}))}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();const t=this._listeners.splice(0,this._listeners.length);for(const n of t)n.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(const n of Array.from(this._features.entries()).map((e=>e[1])).reverse())n.dispose();"stop"===e&&void 0!==this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0),void 0!==this._idleInterval&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){void 0!==this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){const t=this;async function i(e){return t._fileEvents.push(e),t._fileEventDelayer.trigger((async()=>{await t.sendNotification(n.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]}))}const o=this.clientOptions.middleware?.workspace;(o?.didChangeWatchedFile?o.didChangeWatchedFile(e,i):i(e)).catch((e=>{t.error("Notify file events failed.",e)}))}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock((async()=>{try{const t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(0===t.length)return;for(const i of t){const t=this.code2ProtocolConverter.asChangeTextDocumentParams(i);await e.sendNotification(n.DidChangeTextDocumentNotification.type,t),this._didChangeTextDocumentFeature.notificationSent(i,n.DidChangeTextDocumentNotification.type,t)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}}))}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger((async()=>{const e=this.activeConnection();void 0!==e?await this.sendPendingFullTextDocumentChanges(e):this.triggerPendingChangeDelivery()})).catch((e=>this.error("Delivering pending changes failed",e,!1)))}handleDiagnostics(e){if(!this._diagnostics)return;const t=e.uri;"busy"===this._diagnosticQueueState.state&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,n.RAL)().timer.setImmediate((()=>{this.workDiagnosticQueue()}))}workDiagnosticQueue(){if("busy"===this._diagnosticQueueState.state)return;const e=this._diagnosticQueue.entries().next();if(!0===e.done)return;const[n,i]=e.value;this._diagnosticQueue.delete(n);const o=new t.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:n,tokenSource:o},this._p2c.asDiagnostics(i,o.token).then((e=>{if(!o.token.isCancellationRequested){const t=this._p2c.asUri(n),i=this.clientOptions.middleware;i.handleDiagnostics?i.handleDiagnostics(t,e,((e,t)=>this.setDiagnostics(e,t))):this.setDiagnostics(t,e)}})).finally((()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()}))}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return t.env.language}async $start(){if(this.$state===G.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();const e=this.activeConnection();if(void 0===e)throw new Error("Starting server failed");return e}async createConnection(){const e=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=function(e,t,i,o,s){const a=new te,c=(0,n.createProtocolConnection)(e,t,a,s);c.onError((e=>{i(e[0],e[1],e[2])})),c.onClose(o);const u={listen:()=>c.listen(),sendRequest:c.sendRequest,onRequest:c.onRequest,hasPendingResponse:c.hasPendingResponse,sendNotification:c.sendNotification,onNotification:c.onNotification,onProgress:c.onProgress,sendProgress:c.sendProgress,trace:(e,t,i)=>{const o={sendNotification:!1,traceFormat:n.TraceFormat.Text};return void 0===i?c.trace(e,t,o):(r.boolean(i),c.trace(e,t,i))},initialize:e=>c.sendRequest(n.InitializeRequest.type,e),shutdown:()=>c.sendRequest(n.ShutdownRequest.type,void 0),exit:()=>c.sendNotification(n.ExitNotification.type),end:()=>c.end(),dispose:()=>c.dispose()};return u}(e.reader,e.writer,((e,t,n)=>{this.handleConnectionError(e,t,n).catch((e=>this.error("Handling connection error failed",e)))}),(()=>{this.handleConnectionClosed().catch((e=>this.error("Handling connection close failed",e)))}),this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===G.Stopped)return;try{void 0!==this._connection&&this._connection.dispose()}catch(t){}let e={action:J.DoNotRestart};if(this.$state!==G.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch(t){}this._connection=void 0,e.action===J.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,!0!==e.handled&&"force"),this.cleanUp("stop"),this.$state===G.Starting?this.$state=G.StartFailed:this.$state=G.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===J.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=G.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch((e=>this.error("Restarting server failed",e,"force"))))}async handleConnectionError(e,t,n){const i=await this._clientOptions.errorHandler.error(e,t,n);i.action===B.Shutdown&&(this.error(i.message??`Client ${this._name}: connection to server is erroring. Shutting down server.`,void 0,!0!==i.handled&&"force"),this.stop().catch((e=>{this.error("Stopping server failed",e,!1)})))}hookConfigurationChanged(e){this._listeners.push(t.workspace.onDidChangeConfiguration((()=>{this.refreshTrace(e,!0)})))}refreshTrace(e,i=!1){const o=t.workspace.getConfiguration(this._id);let r=n.Trace.Off,s=n.TraceFormat.Text;if(o){const e=o.get("trace.server","off");"string"==typeof e?r=n.Trace.fromString(e):(r=n.Trace.fromString(o.get("trace.server.verbosity","off")),s=n.TraceFormat.fromString(o.get("trace.server.format","text")))}this._trace=r,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:i,traceFormat:this._traceFormat}).catch((e=>{this.error("Updating trace failed with error",e,!1)}))}hookFileEvents(e){let t,i=this._clientOptions.synchronize.fileEvents;i&&(t=r.array(i)?i:[i],t&&this._dynamicFeatures.get(n.DidChangeWatchedFilesNotification.type.method).registerRaw(u.generateUuid(),t))}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),d.DynamicFeature.is(e)){const t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){const t=this.getFeature(n.NotebookDocumentSyncRegistrationType.method);return void 0!==t&&t instanceof h.NotebookDocumentSyncFeature&&t.handles(e)}registerBuiltinFeatures(){const e=new Map;this.registerFeature(new p.ConfigurationFeature(this)),this.registerFeature(new m.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new m.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded((()=>{this.triggerPendingChangeDelivery()})),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new m.WillSaveFeature(this)),this.registerFeature(new m.WillSaveWaitUntilFeature(this)),this.registerFeature(new m.DidSaveTextDocumentFeature(this)),this.registerFeature(new m.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new q.FileSystemWatcherFeature(this,(e=>this.notifyFileEvent(e)))),this.registerFeature(new f.CompletionItemFeature(this)),this.registerFeature(new v.HoverFeature(this)),this.registerFeature(new C.SignatureHelpFeature(this)),this.registerFeature(new y.DefinitionFeature(this)),this.registerFeature(new S.ReferencesFeature(this)),this.registerFeature(new D.DocumentHighlightFeature(this)),this.registerFeature(new R.DocumentSymbolFeature(this)),this.registerFeature(new b.WorkspaceSymbolFeature(this)),this.registerFeature(new T.CodeActionFeature(this)),this.registerFeature(new w.CodeLensFeature(this)),this.registerFeature(new _.DocumentFormattingFeature(this)),this.registerFeature(new _.DocumentRangeFormattingFeature(this)),this.registerFeature(new _.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new k.RenameFeature(this)),this.registerFeature(new P.DocumentLinkFeature(this)),this.registerFeature(new x.ExecuteCommandFeature(this)),this.registerFeature(new p.SyncConfigurationFeature(this)),this.registerFeature(new E.TypeDefinitionFeature(this)),this.registerFeature(new O.ImplementationFeature(this)),this.registerFeature(new F.ColorProviderFeature(this)),void 0===this.clientOptions.workspaceFolder&&this.registerFeature(new M.WorkspaceFoldersFeature(this)),this.registerFeature(new N.FoldingRangeFeature(this)),this.registerFeature(new I.DeclarationFeature(this)),this.registerFeature(new L.SelectionRangeFeature(this)),this.registerFeature(new j.ProgressFeature(this)),this.registerFeature(new A.CallHierarchyFeature(this)),this.registerFeature(new H.SemanticTokensFeature(this)),this.registerFeature(new W.LinkedEditingFeature(this)),this.registerFeature(new K.DidCreateFilesFeature(this)),this.registerFeature(new K.DidRenameFilesFeature(this)),this.registerFeature(new K.DidDeleteFilesFeature(this)),this.registerFeature(new K.WillCreateFilesFeature(this)),this.registerFeature(new K.WillRenameFilesFeature(this)),this.registerFeature(new K.WillDeleteFilesFeature(this)),this.registerFeature(new U.TypeHierarchyFeature(this)),this.registerFeature(new z.InlineValueFeature(this)),this.registerFeature(new $.InlayHintsFeature(this)),this.registerFeature(new g.DiagnosticFeature(this)),this.registerFeature(new h.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Y.createAll(this))}fillInitializeParams(e){for(let t of this._features)r.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){const e={};(0,d.ensure)(e,"workspace").applyEdit=!0;const t=(0,d.ensure)((0,d.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[n.ResourceOperationKind.Create,n.ResourceOperationKind.Rename,n.ResourceOperationKind.Delete],t.failureHandling=n.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};const i=(0,d.ensure)((0,d.ensure)(e,"textDocument"),"publishDiagnostics");i.relatedInformation=!0,i.versionSupport=!1,i.tagSupport={valueSet:[n.DiagnosticTag.Unnecessary,n.DiagnosticTag.Deprecated]},i.codeDescriptionSupport=!0,i.dataSupport=!0;const o=(0,d.ensure)(e,"window");(0,d.ensure)(o,"showMessage").messageActionItem={additionalPropertiesSupport:!0};(0,d.ensure)(o,"showDocument").support=!0;const r=(0,d.ensure)(e,"general");r.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(ee.RequestsToCancelOnContentModified)},r.regularExpressions={engine:"ECMAScript",version:"ES2020"},r.markdown={parser:"marked",version:"1.1.0"},r.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(r.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let n of this._features)n.fillClientCapabilities(e);return e}initializeFeatures(e){const t=this._clientOptions.documentSelector;for(const n of this._features)r.func(n.preInitialize)&&n.preInitialize(this._capabilities,t);for(const n of this._features)n.initialize(this._capabilities,t)}async handleRegistrationRequest(e){if(this.isRunning())for(const n of e.registrations){const e=this._dynamicFeatures.get(n.method);if(void 0===e)return Promise.reject(new Error(`No feature implementation for ${n.method} found. Registration failed.`));const i=n.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;const o={id:n.id,registerOptions:i};try{e.register(o)}catch(t){return Promise.reject(t)}}else for(const n of e.registrations)this._ignoredRegistrations.add(n.id)}async handleUnregistrationRequest(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;const e=this._dynamicFeatures.get(t.method);if(!e)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));e.unregister(t.id)}}async handleApplyWorkspaceEdit(e){const i=e.edit,o=await this.workspaceEditLock.lock((()=>this._p2c.asWorkspaceEdit(i))),s=new Map;t.workspace.textDocuments.forEach((e=>s.set(e.uri.toString(),e)));let a=!1;if(i.documentChanges)for(const t of i.documentChanges)if(n.TextDocumentEdit.is(t)&&t.textDocument.version&&t.textDocument.version>=0){const e=this._p2c.asUri(t.textDocument.uri).toString(),n=s.get(e);if(n&&n.version!==t.textDocument.version){a=!0;break}}return a?Promise.resolve({applied:!1}):r.asPromise(t.workspace.applyEdit(o).then((e=>({applied:e}))))}handleFailedRequest(e,i,o,r,s=!0){if(o instanceof n.ResponseError){if(o.code===n.ErrorCodes.PendingResponseRejected||o.code===n.ErrorCodes.ConnectionInactive)return r;if(o.code===n.LSPErrorCodes.RequestCancelled||o.code===n.LSPErrorCodes.ServerCancelled){if(void 0!==i&&i.isCancellationRequested)return r;throw void 0!==o.data?new d.LSPCancellationError(o.data):new t.CancellationError}if(o.code===n.LSPErrorCodes.ContentModified){if(ee.RequestsToCancelOnContentModified.has(e.method)||ee.CancellableResolveCalls.has(e.method))throw new t.CancellationError;return r}}throw this.error(`Request ${e.method} failed.`,o,s),o}}e.BaseLanguageClient=ee,ee.RequestsToCancelOnContentModified=new Set([n.SemanticTokensRequest.method,n.SemanticTokensRangeRequest.method,n.SemanticTokensDeltaRequest.method]),ee.CancellableResolveCalls=new Set([n.CompletionResolveRequest.method,n.CodeLensResolveRequest.method,n.CodeActionResolveRequest.method,n.InlayHintResolveRequest.method,n.DocumentLinkResolveRequest.method,n.WorkspaceSymbolResolveRequest.method]);class te{error(e){(0,n.RAL)().console.error(e)}warn(e){(0,n.RAL)().console.warn(e)}info(e){(0,n.RAL)().console.info(e)}log(e){(0,n.RAL)().console.log(e)}}!function(e){e.createAll=function(e){return[]}}(Y=e.ProposedFeatures||(e.ProposedFeatures={}))}(r);class Ca extends r.BaseLanguageClient{connectionProvider;constructor({id:e,name:t,clientOptions:n,connectionProvider:i}){super(e||t.toLowerCase(),t,n),this.connectionProvider=i}createMessageTransports(e){return this.connectionProvider.get(e)}getLocale(){return super.getLocale()||"en-US"}}var Da={},Ra={};!function(e){var t=n&&n.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),i=n&&n.__exportStar||function(e,n){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||t(n,e,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.DiagnosticPullMode=e.vsdiag=void 0,i(c,e),i(vi,e);var o=yi;Object.defineProperty(e,"vsdiag",{enumerable:!0,get:function(){return o.vsdiag}}),Object.defineProperty(e,"DiagnosticPullMode",{enumerable:!0,get:function(){return o.DiagnosticPullMode}}),i(r,e)}(Ra);var ba=c;!function(e){var t=n&&n.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),i=n&&n.__exportStar||function(e,n){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||t(n,e,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageClient=void 0;const o=Ra,r=ba;i(ba,e),i(Ra,e);e.LanguageClient=class extends o.BaseLanguageClient{constructor(e,t,n,i){super(e,t,n),this.worker=i}createMessageTransports(e){const t=new r.BrowserMessageReader(this.worker),n=new r.BrowserMessageWriter(this.worker);return Promise.resolve({reader:t,writer:n})}}}(Da);class Sa extends F.AbstractMessageReader{socket;state="initial";callback;events=[];constructor(e){super(),this.socket=e,this.socket.onMessage((e=>this.readMessage(e))),this.socket.onError((e=>this.fireError(e))),this.socket.onClose(((e,t)=>{if(1e3!==e){const n={name:""+e,message:`Error during socket reconnect: code = ${e}, reason = ${t}`};this.fireError(n)}this.fireClose()}))}listen(e){if("initial"===this.state)for(this.state="listening",this.callback=e;0!==this.events.length;){const e=this.events.pop();e.message?this.readMessage(e.message):e.error?this.fireError(e.error):this.fireClose()}return{dispose:()=>{this.callback===e&&(this.callback=void 0)}}}readMessage(e){if("initial"===this.state)this.events.splice(0,0,{message:e});else if("listening"===this.state)try{const t=JSON.parse(e);this.callback(t)}catch(t){const e={name:"400",message:`Error during message parsing, reason = ${"object"==typeof t?t.message:"unknown"}`};this.fireError(e)}}fireError(e){"initial"===this.state?this.events.splice(0,0,{error:e}):"listening"===this.state&&super.fireError(e)}fireClose(){"initial"===this.state?this.events.splice(0,0,{}):"listening"===this.state&&super.fireClose(),this.state="closed"}}class Ta extends M.AbstractMessageWriter{socket;errorCount=0;constructor(e){super(),this.socket=e}end(){}async write(e){try{const t=JSON.stringify(e);this.socket.send(t)}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}}console.log("Here: stex.ts");const wa=e=>new Ca({name:"sTeX Language Client",clientOptions:{documentSelector:["latex","tex"],errorHandler:{error:()=>({action:Da.ErrorAction.Continue}),closed:()=>({action:Da.CloseAction.DoNotRestart})},synchronize:{}},connectionProvider:{get:()=>Promise.resolve(e)}}),_a=(e,t,n,i={},o="https:"===location.protocol)=>{const r=new URL(`${o?"wss":"ws"}://${e}:${t}${n}`);for(let[s,a]of Object.entries(i))a instanceof Array&&(a=a.join(",")),a&&r.searchParams.set(s,a);return r.toString()},ka=async e=>{const t=new WebSocket(e);return t.onopen=()=>{const e=function(e){return{send:t=>e.send(t),onMessage:t=>{e.onmessage=e=>t(e.data)},onError:t=>{e.onerror=e=>{"message"in e&&t(e.message)}},onClose:t=>{e.onclose=e=>t(e.code,e.reason)},dispose:()=>e.close()}}(t),n=new Sa(e),i=new Ta(e),o=wa({reader:n,writer:i});o.start(),n.onClose((()=>o.stop())),o.sendNotification(new Da.ProtocolNotificationType("sTeX/setMathHub"),{mathhub:"/home/jazzpirate/work/MathHub",remote:"https://stexmmt.mathhub.info/:sTeX"}).then((()=>{o.sendRequest(new Da.ProtocolRequestType0("sTeX/getMathHubContent"))}))},t};await i({name:"stexide",displayName:"sTeX",publisher:"kwarc",version:"1.1.3",engines:{vscode:"*"},activationEvents:["*"],"editor.semanticHighlighting.enabled":!0,contributes:{semanticTokenTypes:[{id:"stex-module",superType:"namespace",description:"An sTeX Module"},{id:"stex-symdecl",superType:"keyword",description:"An sTeX symbol or notation declaration"},{id:"stex-constant",superType:"string",description:"An sTeX Symbol"},{id:"stex-variable",superType:"variable",description:"An sTeX Variable"},{id:"stex-file",superType:"file",description:"An sTeX File reference"}],semanticTokenModifiers:[{id:"stex-deprecatedmodule",description:"This module is deprecated"}],configurationDefaults:{"editor.semanticTokenColorCustomizations":{rules:{"stex-module":{fontStyle:"italic bold underline"},"stex-constant":{fontStyle:"underline"},"stex-symdecl":{fontStyle:"italic bold underline"},"stex-variable":{foreground:"#858282",fontStyle:"italic underline"},"stex-file":{fontStyle:"italic underline"}}}}}},o.LocalWebWorker);ka(_a("localhost",5008,""));export{wa as createLanguageClient,_a as createUrl,ka as createWebSocketAndStartClient};
